{
    "$schema": "http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#",
    "contentVersion": "1.0.0.0",
    "parameters": {
        "factoryName": {
            "type": "string",
            "metadata": "Data Factory name",
            "defaultValue": ""
        },
        "FOLinkedService_servicePrincipalKey": {
            "type": "secureString",
            "metadata": "Secure string for 'servicePrincipalKey' of 'FOLinkedService'"
        },
        "AzureBlobStorage_connectionString": {
            "type": "secureString",
            "metadata": "Secure string for 'connectionString' of 'AzureBlobStorage'"
        },
        "DynamicsCrmLinkedService_password": {
            "type": "secureString",
            "metadata": "Secure string for 'password' of 'DynamicsCrmLinkedService'"
        },
        "FOLinkedService_properties_typeProperties_url": {
            "type": "string",
            "defaultValue": ""
        },
        "FOLinkedService_properties_typeProperties_tenant": {
            "type": "string",
            "defaultValue": ""
        },
        "FOLinkedService_properties_typeProperties_aadResourceId": {
            "type": "string",
            "defaultValue": ""
        },
        "FOLinkedService_properties_typeProperties_servicePrincipalId": {
            "type": "string",
            "defaultValue": ""
        },
        "DynamicsCrmLinkedService_properties_typeProperties_username": {
            "type": "string",
            "defaultValue": ""
        }
    },
    "variables": {
        "factoryId": "[concat('Microsoft.DataFactory/factories/', parameters('factoryName'))]"
    },
    "resources": [
        {
            "name": "[concat(parameters('factoryName'), '/FOLinkedService')]",
            "type": "Microsoft.DataFactory/factories/linkedServices",
            "apiVersion": "2018-06-01",
            "properties": {
                "description": "FO linked service to connect FO instance ",
                "annotations": [],
                "type": "DynamicsAX",
                "typeProperties": {
                    "url": "[parameters('FOLinkedService_properties_typeProperties_url')]",
                    "tenant": "[parameters('FOLinkedService_properties_typeProperties_tenant')]",
                    "aadResourceId": "[parameters('FOLinkedService_properties_typeProperties_aadResourceId')]",
                    "servicePrincipalId": "[parameters('FOLinkedService_properties_typeProperties_servicePrincipalId')]",
                    "servicePrincipalKey": {
                        "type": "SecureString",
                        "value": "[parameters('FOLinkedService_servicePrincipalKey')]"
                    }
                }
            },
            "dependsOn": []
        },
        {
            "name": "[concat(parameters('factoryName'), '/AzureBlobStorage')]",
            "type": "Microsoft.DataFactory/factories/linkedServices",
            "apiVersion": "2018-06-01",
            "properties": {
                "description": "Azure blob storage for storing FO and CDS data in csv files formats",
                "annotations": [],
                "type": "AzureBlobStorage",
                "typeProperties": {
                    "connectionString": "[parameters('AzureBlobStorage_connectionString')]"
                }
            },
            "dependsOn": []
        },
        {
            "name": "[concat(parameters('factoryName'), '/DynamicsCrmLinkedService')]",
            "type": "Microsoft.DataFactory/factories/linkedServices",
            "apiVersion": "2018-06-01",
            "properties": {
                "description": "Linked services to connect with CRM instance to fetch entities data",
                "annotations": [],
                "type": "DynamicsCrm",
                "typeProperties": {
                    "deploymentType": "Online",
                    "serviceUri": "",
                    "authenticationType": "Office365",
                    "username": "[parameters('DynamicsCrmLinkedService_properties_typeProperties_username')]",
                    "password": {
                        "type": "SecureString",
                        "value": "[parameters('DynamicsCrmLinkedService_password')]"
                    }
                }
            },
            "dependsOn": []
        },
        {
            "name": "[concat(parameters('factoryName'), '/focdsintegrationruntime')]",
            "type": "Microsoft.DataFactory/factories/integrationRuntimes",
            "apiVersion": "2018-06-01",
            "properties": {
                "type": "Managed",
                "typeProperties": {
                    "computeProperties": {
                        "location": "AutoResolve",
                        "dataFlowProperties": {
                            "computeType": "General",
                            "coreCount": 8,
                            "timeToLive": 0
                        }
                    }
                }
            },
            "dependsOn": []
        },
        {
            "name": "[concat(parameters('factoryName'), '/FOConnection')]",
            "type": "Microsoft.DataFactory/factories/datasets",
            "apiVersion": "2018-06-01",
            "properties": {
                "description": "FO connection",
                "linkedServiceName": {
                    "referenceName": "FOLinkedService",
                    "type": "LinkedServiceReference"
                },
                "parameters": {
                    "entitypath": {
                        "type": "string"
                    }
                },
                "annotations": [],
                "type": "DynamicsAXResource",
                "schema": [],
                "typeProperties": {
                    "path": {
                        "value": "@dataset().entitypath",
                        "type": "Expression"
                    },
                    "retrieveEnumValuesAsString": true
                }
            },
            "dependsOn": [
                "[concat(variables('factoryId'), '/linkedServices/FOLinkedService')]"
            ]
        },
        {
            "name": "[concat(parameters('factoryName'), '/DelimitedTextFiles')]",
            "type": "Microsoft.DataFactory/factories/datasets",
            "apiVersion": "2018-06-01",
            "properties": {
                "description": "Comma delimited csv files",
                "linkedServiceName": {
                    "referenceName": "AzureBlobStorage",
                    "type": "LinkedServiceReference"
                },
                "parameters": {
                    "filename": {
                        "type": "string"
                    },
                    "foldername": {
                        "type": "string"
                    },
                    "container": {
                        "type": "String"
                    }
                },
                "annotations": [],
                "type": "DelimitedText",
                "typeProperties": {
                    "location": {
                        "type": "AzureBlobStorageLocation",
                        "fileName": {
                            "value": "@dataset().filename",
                            "type": "Expression"
                        },
                        "folderPath": {
                            "value": "@dataset().foldername",
                            "type": "Expression"
                        },
                        "container": {
                            "value": "@dataset().container",
                            "type": "Expression"
                        }
                    },
                    "columnDelimiter": ",",
                    "escapeChar": "\\",
                    "firstRowAsHeader": true,
                    "quoteChar": "\""
                },
                "schema": []
            },
            "dependsOn": [
                "[concat(variables('factoryId'), '/linkedServices/AzureBlobStorage')]"
            ]
        },
        {
            "name": "[concat(parameters('factoryName'), '/DynamicsCrmConnection')]",
            "type": "Microsoft.DataFactory/factories/datasets",
            "apiVersion": "2018-06-01",
            "properties": {
                "description": "Dynamics CRM connection to connect with CRM instances",
                "linkedServiceName": {
                    "referenceName": "DynamicsCrmLinkedService",
                    "type": "LinkedServiceReference"
                },
                "parameters": {
                    "entityname": {
                        "type": "string"
                    }
                },
                "annotations": [],
                "type": "DynamicsCrmEntity",
                "schema": [],
                "typeProperties": {
                    "entityName": {
                        "value": "@dataset().entityname",
                        "type": "Expression"
                    }
                }
            },
            "dependsOn": [
                "[concat(variables('factoryId'), '/linkedServices/DynamicsCrmLinkedService')]"
            ]
        },
        {
            "name": "[concat(parameters('factoryName'), '/DelimitedTextSink')]",
            "type": "Microsoft.DataFactory/factories/datasets",
            "apiVersion": "2018-06-01",
            "properties": {
                "linkedServiceName": {
                    "referenceName": "AzureBlobStorage",
                    "type": "LinkedServiceReference"
                },
                "annotations": [],
                "type": "DelimitedText",
                "typeProperties": {
                    "location": {
                        "type": "AzureBlobStorageLocation",
                        "folderPath": "datasanity",
                        "container": "partybootstrapping"
                    },
                    "columnDelimiter": ",",
                    "escapeChar": "\\",
                    "quoteChar": "\""
                },
                "schema": []
            },
            "dependsOn": [
                "[concat(variables('factoryId'), '/linkedServices/AzureBlobStorage')]"
            ]
        },
        {
            "name": "[concat(parameters('factoryName'), '/DelimitedTextOutput')]",
            "type": "Microsoft.DataFactory/factories/datasets",
            "apiVersion": "2018-06-01",
            "properties": {
                "linkedServiceName": {
                    "referenceName": "AzureBlobStorage",
                    "type": "LinkedServiceReference"
                },
                "annotations": [],
                "type": "DelimitedText",
                "typeProperties": {
                    "location": {
                        "type": "AzureBlobStorageLocation",
                        "folderPath": "output",
                        "container": "partybootstrapping"
                    },
                    "columnDelimiter": ",",
                    "escapeChar": "\\",
                    "firstRowAsHeader": true,
                    "quoteChar": "\""
                },
                "schema": [
                    {
                        "type": "String"
                    },
                    {
                        "type": "String"
                    },
                    {
                        "type": "String"
                    },
                    {
                        "type": "String"
                    },
                    {
                        "type": "String"
                    },
                    {
                        "type": "String"
                    },
                    {
                        "type": "String"
                    },
                    {
                        "type": "String"
                    },
                    {
                        "type": "String"
                    },
                    {
                        "type": "String"
                    },
                    {
                        "type": "String"
                    },
                    {
                        "type": "String"
                    },
                    {
                        "type": "String"
                    },
                    {
                        "type": "String"
                    },
                    {
                        "type": "String"
                    },
                    {
                        "type": "String"
                    },
                    {
                        "type": "String"
                    },
                    {
                        "type": "String"
                    },
                    {
                        "type": "String"
                    },
                    {
                        "type": "String"
                    },
                    {
                        "type": "String"
                    },
                    {
                        "type": "String"
                    },
                    {
                        "type": "String"
                    },
                    {
                        "type": "String"
                    },
                    {
                        "type": "String"
                    },
                    {
                        "type": "String"
                    },
                    {
                        "type": "String"
                    },
                    {
                        "type": "String"
                    },
                    {
                        "type": "String"
                    },
                    {
                        "type": "String"
                    },
                    {
                        "type": "String"
                    }
                ]
            },
            "dependsOn": [
                "[concat(variables('factoryId'), '/linkedServices/AzureBlobStorage')]"
            ]
        },
        {
            "name": "[concat(parameters('factoryName'), '/Party')]",
            "type": "Microsoft.DataFactory/factories/pipelines",
            "apiVersion": "2018-06-01",
            "properties": {
                "description": "ADF template for party and contact for party data bootstrapping",
                "activities": [
                    {
                        "name": "7-4-Retrieve party from FO",
                        "description": "Retrieve party data from FO",
                        "type": "Copy",
                        "dependsOn": [],
                        "policy": {
                            "timeout": "7.00:00:00",
                            "retry": 0,
                            "retryIntervalInSeconds": 30,
                            "secureOutput": false,
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "source": {
                                "type": "DynamicsAXSource",
                                "httpRequestTimeout": "00:05:00"
                            },
                            "sink": {
                                "type": "DelimitedTextSink",
                                "storeSettings": {
                                    "type": "AzureBlobStorageWriteSettings"
                                },
                                "formatSettings": {
                                    "type": "DelimitedTextWriteSettings",
                                    "quoteAllText": true,
                                    "fileExtension": ".csv"
                                }
                            },
                            "enableStaging": false,
                            "translator": {
                                "type": "TabularTranslator",
                                "mappings": [
                                    {
                                        "source": {
                                            "name": "PartyNumber",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "PartyNumber",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "PersonPersonalSuffix",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "PersonPersonalSuffix",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "PersonPhoneticLastName",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "PersonPhoneticLastName",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "PersonAnniversaryMonth",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "PersonAnniversaryMonth",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "PersonLastName",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "PersonLastName",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "PartyType",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "PartyType",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "PersonPersonalTitle",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "PersonPersonalTitle",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "PersonInitials",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "PersonInitials",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "PersonGender",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "PersonGender",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "PersonLastNamePrefix",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "PersonLastNamePrefix",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "PersonBirthDay",
                                            "type": "Int32"
                                        },
                                        "sink": {
                                            "name": "PersonBirthDay",
                                            "type": "Int32"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "LanguageId",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "LanguageId",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "OrganizationPhoneticName",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "OrganizationPhoneticName",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "PersonAnniversaryYear",
                                            "type": "Int32"
                                        },
                                        "sink": {
                                            "name": "PersonAnniversaryYear",
                                            "type": "Int32"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "PersonAnniversaryDay",
                                            "type": "Int32"
                                        },
                                        "sink": {
                                            "name": "PersonAnniversaryDay",
                                            "type": "Int32"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "PersonMaritalStatus",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "PersonMaritalStatus",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "PersonPhoneticMiddleName",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "PersonPhoneticMiddleName",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "PersonChildrenNames",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "PersonChildrenNames",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "PersonBirthYear",
                                            "type": "Int32"
                                        },
                                        "sink": {
                                            "name": "PersonBirthYear",
                                            "type": "Int32"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "PersonMiddleName",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "PersonMiddleName",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "OrganizationNumber",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "OrganizationNumber",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "PersonProfessionalSuffix",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "PersonProfessionalSuffix",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "OrganizationABCCode",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "OrganizationABCCode",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "AddressBooks",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "AddressBooks",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "PersonFirstName",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "PersonFirstName",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "KnownAs",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "KnownAs",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "OrganizationNumOfEmployees",
                                            "type": "Int32"
                                        },
                                        "sink": {
                                            "name": "OrganizationNumOfEmployees",
                                            "type": "Int32"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "PersonPhoneticFirstName",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "PersonPhoneticFirstName",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "PersonBirthMonth",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "PersonBirthMonth",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "PersonProfessionalTitle",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "PersonProfessionalTitle",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "NameAlias",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "NameAlias",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "OrganizationName",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "OrganizationName",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "PersonHobbies",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "PersonHobbies",
                                            "type": "String"
                                        }
                                    }
                                ]
                            }
                        },
                        "inputs": [
                            {
                                "referenceName": "FOConnection",
                                "type": "DatasetReference",
                                "parameters": {
                                    "entitypath": "CDSParties"
                                }
                            }
                        ],
                        "outputs": [
                            {
                                "referenceName": "DelimitedTextFiles",
                                "type": "DatasetReference",
                                "parameters": {
                                    "filename": "FOParty.csv",
                                    "foldername": "input",
                                    "container": "partybootstrapping"
                                }
                            }
                        ]
                    },
                    {
                        "name": "7-1-Retrieve customers from FO based on company filter",
                        "description": "Retrieve customer data from FO for DW enabled companies",
                        "type": "Copy",
                        "dependsOn": [
                            {
                                "activity": "6-Create a consolidated company filter",
                                "dependencyConditions": [
                                    "Succeeded"
                                ]
                            }
                        ],
                        "policy": {
                            "timeout": "7.00:00:00",
                            "retry": 0,
                            "retryIntervalInSeconds": 30,
                            "secureOutput": false,
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "source": {
                                "type": "DynamicsAXSource",
                                "query": {
                                    "value": "@concat('$select=dataAreaId,CustomerAccount,PartyNumber&' , variables('filter'))",
                                    "type": "Expression"
                                },
                                "httpRequestTimeout": "00:50:00"
                            },
                            "sink": {
                                "type": "DelimitedTextSink",
                                "storeSettings": {
                                    "type": "AzureBlobStorageWriteSettings"
                                },
                                "formatSettings": {
                                    "type": "DelimitedTextWriteSettings",
                                    "quoteAllText": true,
                                    "fileExtension": ".txt"
                                }
                            },
                            "enableStaging": false,
                            "translator": {
                                "type": "TabularTranslator",
                                "mappings": [
                                    {
                                        "source": {
                                            "name": "dataAreaId",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "dataAreaId",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "CustomerAccount",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "CustomerAccount",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "PartyNumber",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "PartyNumber",
                                            "type": "String"
                                        }
                                    }
                                ]
                            }
                        },
                        "inputs": [
                            {
                                "referenceName": "FOConnection",
                                "type": "DatasetReference",
                                "parameters": {
                                    "entitypath": "CustomersV3"
                                }
                            }
                        ],
                        "outputs": [
                            {
                                "referenceName": "DelimitedTextFiles",
                                "type": "DatasetReference",
                                "parameters": {
                                    "filename": "FOAllCustomers.csv",
                                    "foldername": "input",
                                    "container": "partybootstrapping"
                                }
                            }
                        ]
                    },
                    {
                        "name": "7-2-Retrieve vendors from FO based on company filter",
                        "description": "Retrieve vendor data from FO for DW enabled companies",
                        "type": "Copy",
                        "dependsOn": [
                            {
                                "activity": "6-Create a consolidated company filter",
                                "dependencyConditions": [
                                    "Succeeded"
                                ]
                            }
                        ],
                        "policy": {
                            "timeout": "7.00:00:00",
                            "retry": 0,
                            "retryIntervalInSeconds": 30,
                            "secureOutput": false,
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "source": {
                                "type": "DynamicsAXSource",
                                "query": {
                                    "value": "@concat('$select=dataAreaId,VendorAccountNumber,VendorPartyNumber&' , variables('filter'))",
                                    "type": "Expression"
                                },
                                "httpRequestTimeout": "00:05:00"
                            },
                            "sink": {
                                "type": "DelimitedTextSink",
                                "storeSettings": {
                                    "type": "AzureBlobStorageWriteSettings"
                                },
                                "formatSettings": {
                                    "type": "DelimitedTextWriteSettings",
                                    "quoteAllText": true,
                                    "fileExtension": ".txt"
                                }
                            },
                            "enableStaging": false,
                            "translator": {
                                "type": "TabularTranslator",
                                "mappings": [
                                    {
                                        "source": {
                                            "name": "dataAreaId",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "dataAreaId",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "VendorAccountNumber"
                                        },
                                        "sink": {
                                            "name": "VendorAccountNumber",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "VendorPartyNumber"
                                        },
                                        "sink": {
                                            "name": "VendorPartyNumber",
                                            "type": "String"
                                        }
                                    }
                                ]
                            }
                        },
                        "inputs": [
                            {
                                "referenceName": "FOConnection",
                                "type": "DatasetReference",
                                "parameters": {
                                    "entitypath": "VendorsV2"
                                }
                            }
                        ],
                        "outputs": [
                            {
                                "referenceName": "DelimitedTextFiles",
                                "type": "DatasetReference",
                                "parameters": {
                                    "filename": "FOAllVendor.csv",
                                    "foldername": "input",
                                    "container": "partybootstrapping"
                                }
                            }
                        ]
                    },
                    {
                        "name": "7-5-Retrieve account from Dataverse",
                        "description": "Retrieve account from Dataverse",
                        "type": "Copy",
                        "dependsOn": [],
                        "policy": {
                            "timeout": "7.00:00:00",
                            "retry": 0,
                            "retryIntervalInSeconds": 30,
                            "secureOutput": false,
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "source": {
                                "type": "DynamicsCrmSource",
                                "query": "<fetch version=\"1.0\" output-format=\"xml-platform\" mapping=\"logical\" distinct=\"false\">\n  <entity name=\"account\" >\n    <attribute name=\"name\" />\n    <attribute name=\"msdyn_company\" />\n    <attribute name=\"accountnumber\" />\n    <attribute name=\"msdyn_companyname\" />\n    <attribute name=\"accountid\" />\n    <attribute name=\"msdyn_language\" />\n    <attribute name=\"customertypecode\" />\n    <attribute name=\"msdyn_namealias\" />\n    <attribute name=\"msdyn_vendorknownasname\" />\n    <attribute name=\"msdyn_organizationabccode\" />\n    <attribute name=\"msdyn_organizationphoneticname\" />\n    <attribute name=\"msdyn_organizationnumber\" />\n    <attribute name=\"msdyn_partynumber\" />\n    <attribute name=\"numberofemployees\" />\n    <attribute name=\"msdyn_mappedvendoraccount\" />\n    <attribute name=\"msdyn_vendorcreatedbyworkflow\" />\n    <link-entity name=\"cdm_company\" from=\"cdm_companyid\" to=\"msdyn_company\" >\n      <attribute name=\"cdm_companycode\" />\n    </link-entity>\n  </entity>\n</fetch>"
                            },
                            "sink": {
                                "type": "DelimitedTextSink",
                                "storeSettings": {
                                    "type": "AzureBlobStorageWriteSettings"
                                },
                                "formatSettings": {
                                    "type": "DelimitedTextWriteSettings",
                                    "quoteAllText": true,
                                    "fileExtension": ".txt"
                                }
                            },
                            "enableStaging": false,
                            "translator": {
                                "type": "TabularTranslator",
                                "mappings": [
                                    {
                                        "source": {
                                            "name": "msdyn_company",
                                            "type": "Guid"
                                        },
                                        "sink": {
                                            "name": "msdyn_company",
                                            "type": "Guid"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "accountid",
                                            "type": "Guid"
                                        },
                                        "sink": {
                                            "name": "accountid",
                                            "type": "Guid"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "cdm_company1.cdm_companycode",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "cdm_company1.cdm_companycode",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "msdyn_language",
                                            "type": "Int32"
                                        },
                                        "sink": {
                                            "name": "msdyn_language",
                                            "type": "Int32"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "accountnumber",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "accountnumber",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "name",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "name",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "msdyn_vendorcreatedbyworkflow",
                                            "type": "Boolean"
                                        },
                                        "sink": {
                                            "name": "msdyn_vendorcreatedbyworkflow",
                                            "type": "Boolean"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "msdyn_partynumber",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "msdyn_partynumber",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "msdyn_organizationnumber",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "msdyn_organizationnumber",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "customertypecode",
                                            "type": "Int32"
                                        },
                                        "sink": {
                                            "name": "customertypecode",
                                            "type": "Int32"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "numberofemployees",
                                            "type": "Int32"
                                        },
                                        "sink": {
                                            "name": "numberofemployees",
                                            "type": "Int32"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "msdyn_namealias",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "msdyn_namealias",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "msdyn_organizationphoneticname",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "msdyn_organizationphoneticname",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "msdyn_organizationabccode",
                                            "type": "Int32"
                                        },
                                        "sink": {
                                            "name": "msdyn_organizationabccode",
                                            "type": "Int32"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "msdyn_mappedvendoraccount",
                                            "type": "Guid"
                                        },
                                        "sink": {
                                            "name": "msdyn_mappedvendoraccount",
                                            "type": "Guid"
                                        }
                                    }
                                ]
                            }
                        },
                        "inputs": [
                            {
                                "referenceName": "DynamicsCrmConnection",
                                "type": "DatasetReference",
                                "parameters": {
                                    "entityname": "account"
                                }
                            }
                        ],
                        "outputs": [
                            {
                                "referenceName": "DelimitedTextFiles",
                                "type": "DatasetReference",
                                "parameters": {
                                    "filename": "CDSAllAccount.csv",
                                    "foldername": "input",
                                    "container": "partybootstrapping"
                                }
                            }
                        ]
                    },
                    {
                        "name": "7-6-Retrieve contact from Dataverse",
                        "description": "Retrieve contact from Dataverse",
                        "type": "Copy",
                        "dependsOn": [],
                        "policy": {
                            "timeout": "7.00:00:00",
                            "retry": 0,
                            "retryIntervalInSeconds": 30,
                            "secureOutput": false,
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "source": {
                                "type": "DynamicsCrmSource",
                                "query": "<fetch version=\"1.0\" output-format=\"xml-platform\" mapping=\"logical\" distinct=\"false\">\n  <entity name=\"contact\">\n    <attribute name=\"familystatuscode\" />\n    <attribute name=\"msdyn_anniversarymonth\" />\n    <attribute name=\"msdyn_contacthasnocompany\" />\n    <attribute name=\"msdyn_birthyear\" />\n    <attribute name=\"msdyn_initials\" />\n    <attribute name=\"msdyn_hobbies\" />\n    <attribute name=\"msdyn_phoneticlastname\" />\n    <attribute name=\"msdyn_birthday\" />\n    <attribute name=\"middlename\" />\n    <attribute name=\"msdyn_phoneticfirstname\" />\n    <attribute name=\"gendercode\" />\n    <attribute name=\"msdyn_anniversaryyear\" />\n    <attribute name=\"msdyn_anniversaryday\" />\n    <attribute name=\"msdyn_lastnameprefix\" />\n    <attribute name=\"contactid\" />\n    <attribute name=\"suffix\" />\n    <attribute name=\"msdyn_contactforvendor\" />\n    <attribute name=\"msdyn_language\" />\n    <attribute name=\"childrensnames\" />\n    <attribute name=\"jobtitle\" />\n    <attribute name=\"msdyn_phoneticmiddlename\" />\n    <attribute name=\"nickname\" />\n    <attribute name=\"msdyn_contactfor\" />\n    <attribute name=\"firstname\" />\n    <attribute name=\"msdyn_namealias\" />\n    <attribute name=\"msdyn_birthmonth\" />\n    <attribute name=\"lastname\" />\n    <attribute name=\"msdyn_company\" />\n    <attribute name=\"msdyn_sellable\" />\n    <attribute name=\"msdyn_linkedvendoraccount\" />\n    <attribute name=\"msdyn_partynumber\" />\n    <attribute name=\"msdyn_isvendor\" />\n    <attribute name=\"msdyn_contactpersonid\" />\n    <attribute name=\"msdyn_accountnumber\" />\n    <order attribute=\"nickname\" descending=\"false\" />\n    <link-entity name=\"cdm_company\" from=\"cdm_companyid\" to=\"msdyn_company\" >\n      <attribute name=\"cdm_companycode\" />\n    </link-entity>\n  </entity>\n</fetch>"
                            },
                            "sink": {
                                "type": "DelimitedTextSink",
                                "storeSettings": {
                                    "type": "AzureBlobStorageWriteSettings"
                                },
                                "formatSettings": {
                                    "type": "DelimitedTextWriteSettings",
                                    "quoteAllText": true,
                                    "fileExtension": ".txt"
                                }
                            },
                            "enableStaging": false,
                            "translator": {
                                "type": "TabularTranslator",
                                "mappings": [
                                    {
                                        "source": {
                                            "name": "contactid",
                                            "type": "Guid"
                                        },
                                        "sink": {
                                            "name": "contactid",
                                            "type": "Guid"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "msdyn_language",
                                            "type": "Int32"
                                        },
                                        "sink": {
                                            "name": "msdyn_language",
                                            "type": "Int32"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "msdyn_company",
                                            "type": "Guid"
                                        },
                                        "sink": {
                                            "name": "msdyn_company",
                                            "type": "Guid"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "msdyn_isvendor",
                                            "type": "Boolean"
                                        },
                                        "sink": {
                                            "name": "msdyn_isvendor",
                                            "type": "Boolean"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "msdyn_sellable",
                                            "type": "Boolean"
                                        },
                                        "sink": {
                                            "name": "msdyn_sellable",
                                            "type": "Boolean"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "cdm_company1.cdm_companycode",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "cdm_company1.cdm_companycode",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "msdyn_partynumber",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "msdyn_partynumber",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "firstname",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "firstname",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "msdyn_contactforvendor",
                                            "type": "Boolean"
                                        },
                                        "sink": {
                                            "name": "msdyn_contactforvendor",
                                            "type": "Boolean"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "lastname",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "lastname",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "msdyn_contactpersonid",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "msdyn_contactpersonid",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "msdyn_birthmonth",
                                            "type": "Int32"
                                        },
                                        "sink": {
                                            "name": "msdyn_birthmonth",
                                            "type": "Int32"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "msdyn_anniversarymonth",
                                            "type": "Int32"
                                        },
                                        "sink": {
                                            "name": "msdyn_anniversarymonth",
                                            "type": "Int32"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "msdyn_birthyear",
                                            "type": "Int32"
                                        },
                                        "sink": {
                                            "name": "msdyn_birthyear",
                                            "type": "Int32"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "msdyn_anniversaryyear",
                                            "type": "Int32"
                                        },
                                        "sink": {
                                            "name": "msdyn_anniversaryyear",
                                            "type": "Int32"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "msdyn_phoneticlastname",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "msdyn_phoneticlastname",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "msdyn_namealias",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "msdyn_namealias",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "msdyn_anniversaryday",
                                            "type": "Int32"
                                        },
                                        "sink": {
                                            "name": "msdyn_anniversaryday",
                                            "type": "Int32"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "suffix",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "suffix",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "msdyn_birthday",
                                            "type": "Int32"
                                        },
                                        "sink": {
                                            "name": "msdyn_birthday",
                                            "type": "Int32"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "familystatuscode",
                                            "type": "Int32"
                                        },
                                        "sink": {
                                            "name": "familystatuscode",
                                            "type": "Int32"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "nickname",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "nickname",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "jobtitle",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "jobtitle",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "msdyn_linkedvendoraccount",
                                            "type": "Guid"
                                        },
                                        "sink": {
                                            "name": "msdyn_linkedvendoraccount",
                                            "type": "Guid"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "msdyn_lastnameprefix",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "msdyn_lastnameprefix",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "msdyn_phoneticfirstname",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "msdyn_phoneticfirstname",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "msdyn_phoneticmiddlename",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "msdyn_phoneticmiddlename",
                                            "type": "String"
                                        }
                                    }
                                ]
                            }
                        },
                        "inputs": [
                            {
                                "referenceName": "DynamicsCrmConnection",
                                "type": "DatasetReference",
                                "parameters": {
                                    "entityname": "contact"
                                }
                            }
                        ],
                        "outputs": [
                            {
                                "referenceName": "DelimitedTextFiles",
                                "type": "DatasetReference",
                                "parameters": {
                                    "filename": "CDSAllContact.csv",
                                    "foldername": "input",
                                    "container": "partybootstrapping"
                                }
                            }
                        ]
                    },
                    {
                        "name": "7-7-Retrieve vendors from Dataverse",
                        "description": "Retrieve vendors from Dataverse",
                        "type": "Copy",
                        "dependsOn": [],
                        "policy": {
                            "timeout": "7.00:00:00",
                            "retry": 0,
                            "retryIntervalInSeconds": 30,
                            "secureOutput": false,
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "source": {
                                "type": "DynamicsCrmSource",
                                "query": "<fetch version=\"1.0\" output-format=\"xml-platform\" mapping=\"logical\" distinct=\"false\">\n  <entity name=\"msdyn_vendor\">\n    <attribute name=\"msdyn_vendoraccountnumber\" />\n    <attribute name=\"msdyn_childrennames\" />\n    <attribute name=\"msdyn_vendorknownasname\" />\n    <attribute name=\"msdyn_numberofemployees\" />\n    <attribute name=\"msdyn_currencycode\" />\n    <attribute name=\"msdyn_initials\" />\n    <attribute name=\"msdyn_anniversarymonth\" />\n    <attribute name=\"msdyn_vendorpartynumber\" />\n    <attribute name=\"msdyn_birthmonth\" />\n    <attribute name=\"msdyn_phoneticmiddlename\" />\n    <attribute name=\"msdyn_hobbies\" />\n    <attribute name=\"msdyn_personanniversaryday\" />\n    <attribute name=\"msdyn_vendorpersoncreatedbyworkflowname\" />\n    <attribute name=\"msdyn_phoneticlastname\" />\n    <attribute name=\"msdyn_vendorpersoncreatedbyworkflow\" />\n    <attribute name=\"msdyn_anniversaryyear\" />\n    <attribute name=\"msdyn_lastnameprefix\" />\n    <attribute name=\"msdyn_professionatitle\" />\n    <attribute name=\"msdyn_gendercode\" />\n    <attribute name=\"msdyn_language\" />\n    <attribute name=\"msdyn_organizationnumber\" />\n    <attribute name=\"msdyn_linkedvendorincontactsentity\" />\n    <attribute name=\"msdyn_phoneticfirstname\" />\n    <attribute name=\"msdyn_maritalstatuscode\" />\n    <attribute name=\"msdyn_birthyear\" />\n    <attribute name=\"msdyn_birthday\" />\n    <attribute name=\"msdyn_lastname\" />\n    <attribute name=\"msdyn_middlename\" />\n    <attribute name=\"msdyn_isperson\" />\n    <attribute name=\"msdyn_name\" />\n    <attribute name=\"msdyn_vendorid\" />\n    <attribute name=\"msdyn_namealias\" />\n    <attribute name=\"msdyn_linkedvendorinaccountsentity\" />\n    <attribute name=\"msdyn_professionalsuffix\" />\n    <attribute name=\"msdyn_company\" />\n    <attribute name=\"msdyn_firstname\" />\n    <order attribute=\"msdyn_company\" descending=\"false\" />\n    <order attribute=\"msdyn_vendoraccountnumber\" descending=\"false\" />\n    <link-entity name=\"cdm_company\" from=\"cdm_companyid\" to=\"msdyn_company\" >\n      <attribute name=\"cdm_companycode\" />\n    </link-entity>\n  </entity>\n</fetch>\n"
                            },
                            "sink": {
                                "type": "DelimitedTextSink",
                                "storeSettings": {
                                    "type": "AzureBlobStorageWriteSettings"
                                },
                                "formatSettings": {
                                    "type": "DelimitedTextWriteSettings",
                                    "quoteAllText": true,
                                    "fileExtension": ".txt"
                                }
                            },
                            "enableStaging": false,
                            "translator": {
                                "type": "TabularTranslator",
                                "mappings": [
                                    {
                                        "source": {
                                            "name": "msdyn_company",
                                            "type": "Guid"
                                        },
                                        "sink": {
                                            "name": "msdyn_company",
                                            "type": "Guid"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "msdyn_vendoraccountnumber",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "msdyn_vendoraccountnumber",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "msdyn_language",
                                            "type": "Int32"
                                        },
                                        "sink": {
                                            "name": "msdyn_language",
                                            "type": "Int32"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "msdyn_name",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "msdyn_name",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "msdyn_currencycode",
                                            "type": "Guid"
                                        },
                                        "sink": {
                                            "name": "msdyn_currencycode",
                                            "type": "Guid"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "msdyn_numberofemployees",
                                            "type": "Int32"
                                        },
                                        "sink": {
                                            "name": "msdyn_numberofemployees",
                                            "type": "Int32"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "msdyn_vendorid",
                                            "type": "Guid"
                                        },
                                        "sink": {
                                            "name": "msdyn_vendorid",
                                            "type": "Guid"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "cdm_company1.cdm_companycode",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "cdm_company1.cdm_companycode",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "msdyn_isperson",
                                            "type": "Boolean"
                                        },
                                        "sink": {
                                            "name": "msdyn_isperson",
                                            "type": "Boolean"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "msdyn_namealias",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "msdyn_namealias",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "msdyn_vendorpersoncreatedbyworkflow",
                                            "type": "Boolean"
                                        },
                                        "sink": {
                                            "name": "msdyn_vendorpersoncreatedbyworkflow",
                                            "type": "Boolean"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "msdyn_vendorpartynumber",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "msdyn_vendorpartynumber",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "msdyn_organizationnumber",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "msdyn_organizationnumber",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "msdyn_vendorknownasname",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "msdyn_vendorknownasname",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "msdyn_linkedvendorinaccountsentity",
                                            "type": "Guid"
                                        },
                                        "sink": {
                                            "name": "msdyn_linkedvendorinaccountsentity",
                                            "type": "Guid"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "msdyn_hobbies",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "msdyn_hobbies",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "msdyn_middlename",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "msdyn_middlename",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "msdyn_professionalsuffix",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "msdyn_professionalsuffix",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "msdyn_initials",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "msdyn_initials",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "msdyn_lastnameprefix",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "msdyn_lastnameprefix",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "msdyn_personanniversaryday",
                                            "type": "Int32"
                                        },
                                        "sink": {
                                            "name": "msdyn_personanniversaryday",
                                            "type": "Int32"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "msdyn_phoneticmiddlename",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "msdyn_phoneticmiddlename",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "msdyn_childrennames",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "msdyn_childrennames",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "msdyn_birthday",
                                            "type": "Int32"
                                        },
                                        "sink": {
                                            "name": "msdyn_birthday",
                                            "type": "Int32"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "msdyn_professionatitle",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "msdyn_professionatitle",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "msdyn_gendercode",
                                            "type": "Int32"
                                        },
                                        "sink": {
                                            "name": "msdyn_gendercode",
                                            "type": "Int32"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "msdyn_birthyear",
                                            "type": "Int32"
                                        },
                                        "sink": {
                                            "name": "msdyn_birthyear",
                                            "type": "Int32"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "msdyn_anniversarymonth",
                                            "type": "Int32"
                                        },
                                        "sink": {
                                            "name": "msdyn_anniversarymonth",
                                            "type": "Int32"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "msdyn_anniversaryyear",
                                            "type": "Int32"
                                        },
                                        "sink": {
                                            "name": "msdyn_anniversaryyear",
                                            "type": "Int32"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "msdyn_phoneticfirstname",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "msdyn_phoneticfirstname",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "msdyn_phoneticlastname",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "msdyn_phoneticlastname",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "msdyn_maritalstatuscode",
                                            "type": "Int32"
                                        },
                                        "sink": {
                                            "name": "msdyn_maritalstatuscode",
                                            "type": "Int32"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "msdyn_firstname",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "msdyn_firstname",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "msdyn_birthmonth",
                                            "type": "Int32"
                                        },
                                        "sink": {
                                            "name": "msdyn_birthmonth",
                                            "type": "Int32"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "msdyn_lastname",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "msdyn_lastname",
                                            "type": "String"
                                        }
                                    }
                                ]
                            }
                        },
                        "inputs": [
                            {
                                "referenceName": "DynamicsCrmConnection",
                                "type": "DatasetReference",
                                "parameters": {
                                    "entityname": "msdyn_vendor"
                                }
                            }
                        ],
                        "outputs": [
                            {
                                "referenceName": "DelimitedTextFiles",
                                "type": "DatasetReference",
                                "parameters": {
                                    "filename": "CDSAllVendor.csv",
                                    "foldername": "input",
                                    "container": "partybootstrapping"
                                }
                            }
                        ]
                    },
                    {
                        "name": "8-Compare PartyNumber between FO and Dataverse",
                        "description": "Data sanity check before proceeding further in template",
                        "type": "ExecuteDataFlow",
                        "dependsOn": [
                            {
                                "activity": "7-1-Retrieve customers from FO based on company filter",
                                "dependencyConditions": [
                                    "Succeeded"
                                ]
                            },
                            {
                                "activity": "7-5-Retrieve account from Dataverse",
                                "dependencyConditions": [
                                    "Succeeded"
                                ]
                            },
                            {
                                "activity": "7-4-Retrieve party from FO",
                                "dependencyConditions": [
                                    "Succeeded"
                                ]
                            },
                            {
                                "activity": "7-2-Retrieve vendors from FO based on company filter",
                                "dependencyConditions": [
                                    "Succeeded"
                                ]
                            },
                            {
                                "activity": "7-7-Retrieve vendors from Dataverse",
                                "dependencyConditions": [
                                    "Succeeded"
                                ]
                            },
                            {
                                "activity": "7-6-Retrieve contact from Dataverse",
                                "dependencyConditions": [
                                    "Succeeded"
                                ]
                            },
                            {
                                "activity": "7-8-Create blank csv file to hold new parties for FO",
                                "dependencyConditions": [
                                    "Succeeded"
                                ]
                            },
                            {
                                "activity": "7-9-Retrieve language and PartyType from Dataverse",
                                "dependencyConditions": [
                                    "Succeeded"
                                ]
                            },
                            {
                                "activity": "7-3-Retrieve contacts from FO based on company filter",
                                "dependencyConditions": [
                                    "Succeeded"
                                ]
                            }
                        ],
                        "policy": {
                            "timeout": "7.00:00:00",
                            "retry": 0,
                            "retryIntervalInSeconds": 30,
                            "secureOutput": false,
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "dataflow": {
                                "referenceName": "DataSanityFlowCheck",
                                "type": "DataFlowReference",
                                "parameters": {},
                                "datasetParameters": {
                                    "FOCustomer": {
                                        "filename": "FOAllCustomers.csv",
                                        "foldername": "input",
                                        "container": "partybootstrapping"
                                    },
                                    "CDSAccount": {
                                        "filename": "CDSAllAccount.csv",
                                        "foldername": "input",
                                        "container": "partybootstrapping"
                                    },
                                    "FOVendor": {
                                        "filename": "FOAllVendor.csv",
                                        "foldername": "input",
                                        "container": "partybootstrapping"
                                    },
                                    "CDSVendor": {
                                        "filename": "CDSAllVendor.csv",
                                        "foldername": "input",
                                        "container": "partybootstrapping"
                                    },
                                    "FOContact": {
                                        "filename": "FOAllContactPerson.csv",
                                        "foldername": "input",
                                        "container": "partybootstrapping"
                                    },
                                    "CDSContact": {
                                        "filename": "CDSAllContact.csv",
                                        "foldername": "input",
                                        "container": "partybootstrapping"
                                    },
                                    "FOCDSCustomerPartyNumber": {},
                                    "FOCDSVendorPartyNumber": {},
                                    "FOCDSContactPartyNumber": {}
                                }
                            },
                            "staging": {},
                            "compute": {
                                "coreCount": 8,
                                "computeType": "General"
                            },
                            "traceLevel": "Fine"
                        }
                    },
                    {
                        "name": "9-Check PartyNumber validation results",
                        "description": "validate if data sanity folder contains any file ",
                        "type": "Validation",
                        "dependsOn": [
                            {
                                "activity": "8-Compare PartyNumber between FO and Dataverse",
                                "dependencyConditions": [
                                    "Succeeded"
                                ]
                            }
                        ],
                        "userProperties": [],
                        "typeProperties": {
                            "dataset": {
                                "referenceName": "DelimitedTextSink",
                                "type": "DatasetReference",
                                "parameters": {}
                            },
                            "timeout": "7.00:00:00",
                            "sleep": 10
                        }
                    },
                    {
                        "name": "10-Create 2 csv files with party data - FO n Dataverse",
                        "description": "Prepare party data to create them in CDS and FO",
                        "type": "ExecuteDataFlow",
                        "dependsOn": [
                            {
                                "activity": "9-Check PartyNumber validation results",
                                "dependencyConditions": [
                                    "Succeeded"
                                ]
                            }
                        ],
                        "policy": {
                            "timeout": "7.00:00:00",
                            "retry": 0,
                            "retryIntervalInSeconds": 30,
                            "secureOutput": false,
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "dataflow": {
                                "referenceName": "PartyDataStagging",
                                "type": "DataFlowReference",
                                "parameters": {},
                                "datasetParameters": {
                                    "FOAllCustomer": {
                                        "filename": "FOAllCustomers.csv",
                                        "foldername": "input",
                                        "container": "partybootstrapping"
                                    },
                                    "CDSAllAccount": {
                                        "filename": "CDSAllAccount.csv",
                                        "foldername": "input",
                                        "container": "partybootstrapping"
                                    },
                                    "FOParty": {
                                        "filename": "FOParty.csv",
                                        "foldername": "input",
                                        "container": "partybootstrapping"
                                    },
                                    "CDSOptionset": {
                                        "filename": "CDSOptionset.csv",
                                        "foldername": "input",
                                        "container": "partybootstrapping"
                                    },
                                    "CDSAllContact": {
                                        "filename": "CDSAllContact.csv",
                                        "foldername": "input",
                                        "container": "partybootstrapping"
                                    },
                                    "FOAllContact": {
                                        "filename": "FOAllContactPerson.csv",
                                        "foldername": "input",
                                        "container": "partybootstrapping"
                                    },
                                    "FOAllVendor": {
                                        "filename": "FOAllVendor.csv",
                                        "foldername": "input",
                                        "container": "partybootstrapping"
                                    },
                                    "CDSAllVendor": {
                                        "filename": "CDSAllVendor.csv",
                                        "foldername": "input",
                                        "container": "partybootstrapping"
                                    },
                                    "FONewParty": {
                                        "filename": "FONewParty.csv",
                                        "foldername": "input",
                                        "container": "partybootstrapping"
                                    },
                                    "FOCDSParty": {},
                                    "FONewPartyFile": {}
                                }
                            },
                            "staging": {},
                            "compute": {
                                "coreCount": 8,
                                "computeType": "General"
                            },
                            "traceLevel": "Fine"
                        }
                    },
                    {
                        "name": "11-Import new parties into Dataverse",
                        "description": "Create party in CDS ",
                        "type": "Copy",
                        "dependsOn": [
                            {
                                "activity": "10-Create 2 csv files with party data - FO n Dataverse",
                                "dependencyConditions": [
                                    "Succeeded"
                                ]
                            }
                        ],
                        "policy": {
                            "timeout": "7.00:00:00",
                            "retry": 0,
                            "retryIntervalInSeconds": 30,
                            "secureOutput": false,
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "source": {
                                "type": "DelimitedTextSource",
                                "storeSettings": {
                                    "type": "AzureBlobStorageReadSettings",
                                    "recursive": true,
                                    "enablePartitionDiscovery": false
                                },
                                "formatSettings": {
                                    "type": "DelimitedTextReadSettings"
                                }
                            },
                            "sink": {
                                "type": "DynamicsCrmSink",
                                "writeBatchSize": 10,
                                "writeBehavior": "upsert",
                                "ignoreNullValues": false,
                                "alternateKeyName": "msdyn_partykey"
                            },
                            "enableStaging": false,
                            "enableSkipIncompatibleRow": true,
                            "logSettings": {
                                "enableCopyActivityLog": true,
                                "copyActivityLogSettings": {
                                    "logLevel": "Warning",
                                    "enableReliableLogging": false
                                },
                                "logLocationSettings": {
                                    "linkedServiceName": {
                                        "referenceName": "AzureBlobStorage",
                                        "type": "LinkedServiceReference"
                                    },
                                    "path": "partybootstrapping"
                                }
                            },
                            "translator": {
                                "type": "TabularTranslator",
                                "mappings": [
                                    {
                                        "source": {
                                            "name": "PartyNumber",
                                            "type": "String",
                                            "physicalType": "String"
                                        },
                                        "sink": {
                                            "name": "msdyn_partynumber",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "PersonAnniversaryDay",
                                            "type": "String",
                                            "physicalType": "String"
                                        },
                                        "sink": {
                                            "name": "msdyn_anniversaryday",
                                            "type": "Int32"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "PersonInitials",
                                            "type": "String",
                                            "physicalType": "String"
                                        },
                                        "sink": {
                                            "name": "msdyn_initials",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "OrganizationName",
                                            "type": "String",
                                            "physicalType": "String"
                                        },
                                        "sink": {
                                            "name": "msdyn_organizationname",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "PersonPhoneticFirstName",
                                            "type": "String",
                                            "physicalType": "String"
                                        },
                                        "sink": {
                                            "name": "msdyn_phoneticfirstname",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "PersonChildrenNames",
                                            "type": "String",
                                            "physicalType": "String"
                                        },
                                        "sink": {
                                            "name": "msdyn_childrennames",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "PersonBirthDay",
                                            "type": "String",
                                            "physicalType": "String"
                                        },
                                        "sink": {
                                            "name": "msdyn_birthday",
                                            "type": "Int32"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "PersonHobbies",
                                            "type": "String",
                                            "physicalType": "String"
                                        },
                                        "sink": {
                                            "name": "msdyn_hobbies",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "PersonProfessionalSuffix",
                                            "type": "String",
                                            "physicalType": "String"
                                        },
                                        "sink": {
                                            "name": "msdyn_professionalsuffix",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "NameAlias",
                                            "type": "String",
                                            "physicalType": "String"
                                        },
                                        "sink": {
                                            "name": "msdyn_namealias",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "PartyType",
                                            "type": "String",
                                            "physicalType": "String"
                                        },
                                        "sink": {
                                            "name": "msdyn_partytype",
                                            "type": "Int32"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "LanguageId",
                                            "type": "String",
                                            "physicalType": "String"
                                        },
                                        "sink": {
                                            "name": "msdyn_language",
                                            "type": "Int32"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "OrganizationPhoneticName",
                                            "type": "String",
                                            "physicalType": "String"
                                        },
                                        "sink": {
                                            "name": "msdyn_organizationphoneticname",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "PersonAnniversaryYear",
                                            "type": "String",
                                            "physicalType": "String"
                                        },
                                        "sink": {
                                            "name": "msdyn_anniversaryyear",
                                            "type": "Int32"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "OrganizationNumber",
                                            "type": "String",
                                            "physicalType": "String"
                                        },
                                        "sink": {
                                            "name": "msdyn_organizationnumber",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "PersonFirstName",
                                            "type": "String",
                                            "physicalType": "String"
                                        },
                                        "sink": {
                                            "name": "msdyn_firstname",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "PersonMiddleName",
                                            "type": "String",
                                            "physicalType": "String"
                                        },
                                        "sink": {
                                            "name": "msdyn_middlename",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "PersonLastName",
                                            "type": "String",
                                            "physicalType": "String"
                                        },
                                        "sink": {
                                            "name": "msdyn_lastname",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "PersonLastNamePrefix",
                                            "type": "String",
                                            "physicalType": "String"
                                        },
                                        "sink": {
                                            "name": "msdyn_lastnameprefix",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "OrganizationNumOfEmployees",
                                            "type": "String",
                                            "physicalType": "String"
                                        },
                                        "sink": {
                                            "name": "msdyn_numberofemployees",
                                            "type": "Int32"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "PersonBirthYear",
                                            "type": "String",
                                            "physicalType": "String"
                                        },
                                        "sink": {
                                            "name": "msdyn_birthyear",
                                            "type": "Int32"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "PersonPhoneticLastName",
                                            "type": "String",
                                            "physicalType": "String"
                                        },
                                        "sink": {
                                            "name": "msdyn_phoneticlastname",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "PersonProfessionalTitle",
                                            "type": "String",
                                            "physicalType": "String"
                                        },
                                        "sink": {
                                            "name": "msdyn_professionaltitle",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "PersonGender",
                                            "type": "String",
                                            "physicalType": "String"
                                        },
                                        "sink": {
                                            "name": "msdyn_gender",
                                            "type": "Int32"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "PersonMaritalStatus",
                                            "type": "String",
                                            "physicalType": "String"
                                        },
                                        "sink": {
                                            "name": "msdyn_maritalstatus",
                                            "type": "Int32"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "OrganizationABCCode",
                                            "type": "String",
                                            "physicalType": "String"
                                        },
                                        "sink": {
                                            "name": "msdyn_organizationabccode",
                                            "type": "Int32"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "PersonBirthMonth",
                                            "type": "String",
                                            "physicalType": "String"
                                        },
                                        "sink": {
                                            "name": "msdyn_birthmonth",
                                            "type": "Int32"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "PersonAnniversaryMonth",
                                            "type": "String",
                                            "physicalType": "String"
                                        },
                                        "sink": {
                                            "name": "msdyn_anniversarymonth",
                                            "type": "Int32"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "PersonPhoneticMiddleName",
                                            "type": "String",
                                            "physicalType": "String"
                                        },
                                        "sink": {
                                            "name": "msdyn_phoneticmiddlename",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "KnownAs",
                                            "type": "String",
                                            "physicalType": "String"
                                        },
                                        "sink": {
                                            "name": "msdyn_nickname",
                                            "type": "String"
                                        }
                                    }
                                ],
                                "typeConversion": true,
                                "typeConversionSettings": {
                                    "allowDataTruncation": true,
                                    "treatBooleanAsNumber": false
                                }
                            }
                        },
                        "inputs": [
                            {
                                "referenceName": "DelimitedTextFiles",
                                "type": "DatasetReference",
                                "parameters": {
                                    "filename": "FOCDSParty.csv",
                                    "foldername": "output",
                                    "container": "partybootstrapping"
                                }
                            }
                        ],
                        "outputs": [
                            {
                                "referenceName": "DynamicsCrmConnection",
                                "type": "DatasetReference",
                                "parameters": {
                                    "entityname": "msdyn_party"
                                }
                            }
                        ]
                    },
                    {
                        "name": "13-Associate party Guid with Account n Contact n Vendor",
                        "description": "Link party with account, contact and vendor entities",
                        "type": "ExecuteDataFlow",
                        "dependsOn": [
                            {
                                "activity": "12-Retrieve newly created party Guid from Dataverse",
                                "dependencyConditions": [
                                    "Succeeded"
                                ]
                            }
                        ],
                        "policy": {
                            "timeout": "7.00:00:00",
                            "retry": 0,
                            "retryIntervalInSeconds": 30,
                            "secureOutput": false,
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "dataflow": {
                                "referenceName": "LinkParty",
                                "type": "DataFlowReference",
                                "parameters": {},
                                "datasetParameters": {
                                    "CDSParty": {
                                        "filename": "CDSParty.csv",
                                        "foldername": "input",
                                        "container": "partybootstrapping"
                                    },
                                    "CDSAllAccount": {
                                        "filename": "CDSAllAccount.csv",
                                        "foldername": "input",
                                        "container": "partybootstrapping"
                                    },
                                    "CDSAllContact": {
                                        "filename": "CDSAllContact.csv",
                                        "foldername": "input",
                                        "container": "partybootstrapping"
                                    },
                                    "CDSAllVendor": {
                                        "filename": "CDSAllVendor.csv",
                                        "foldername": "input",
                                        "container": "partybootstrapping"
                                    },
                                    "AccountParty": {},
                                    "ContactParty": {},
                                    "VendorParty": {}
                                }
                            },
                            "staging": {},
                            "compute": {
                                "coreCount": 8,
                                "computeType": "General"
                            },
                            "traceLevel": "Fine"
                        }
                    },
                    {
                        "name": "12-Retrieve newly created party Guid from Dataverse",
                        "description": "Copy newly created party records from CDS",
                        "type": "Copy",
                        "dependsOn": [
                            {
                                "activity": "11-Import new parties into Dataverse",
                                "dependencyConditions": [
                                    "Succeeded"
                                ]
                            }
                        ],
                        "policy": {
                            "timeout": "7.00:00:00",
                            "retry": 0,
                            "retryIntervalInSeconds": 30,
                            "secureOutput": false,
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "source": {
                                "type": "DynamicsCrmSource",
                                "query": "<fetch version=\"1.0\" output-format=\"xml-platform\" mapping=\"logical\" distinct=\"false\">\n  <entity name=\"msdyn_party\" >\n    <attribute name=\"msdyn_partyid\" />\n    <attribute name=\"msdyn_partytype\" />\n    <attribute name=\"msdyn_partynumber\" />\n  </entity>\n</fetch>"
                            },
                            "sink": {
                                "type": "DelimitedTextSink",
                                "storeSettings": {
                                    "type": "AzureBlobStorageWriteSettings"
                                },
                                "formatSettings": {
                                    "type": "DelimitedTextWriteSettings",
                                    "quoteAllText": true,
                                    "fileExtension": ".txt"
                                }
                            },
                            "enableStaging": false
                        },
                        "inputs": [
                            {
                                "referenceName": "DynamicsCrmConnection",
                                "type": "DatasetReference",
                                "parameters": {
                                    "entityname": "msdyn_parties"
                                }
                            }
                        ],
                        "outputs": [
                            {
                                "referenceName": "DelimitedTextFiles",
                                "type": "DatasetReference",
                                "parameters": {
                                    "filename": "CDSParty.csv",
                                    "foldername": "input",
                                    "container": "partybootstrapping"
                                }
                            }
                        ]
                    },
                    {
                        "name": "15-1-Create csv file with ContactForParty for Accounts",
                        "type": "ExecuteDataFlow",
                        "dependsOn": [
                            {
                                "activity": "14-1-Import Account with partyid into Dataverse",
                                "dependencyConditions": [
                                    "Succeeded"
                                ]
                            }
                        ],
                        "policy": {
                            "timeout": "7.00:00:00",
                            "retry": 0,
                            "retryIntervalInSeconds": 30,
                            "secureOutput": false,
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "dataflow": {
                                "referenceName": "ContactForParty",
                                "type": "DataFlowReference",
                                "parameters": {},
                                "datasetParameters": {
                                    "AccountParty": {
                                        "filename": "AccountParty.csv",
                                        "foldername": "output",
                                        "container": "partybootstrapping"
                                    },
                                    "CDSAllContact": {
                                        "filename": "CDSAllContact.csv",
                                        "foldername": "input",
                                        "container": "partybootstrapping"
                                    },
                                    "CDSParty": {
                                        "filename": "CDSParty.csv",
                                        "foldername": "input",
                                        "container": "partybootstrapping"
                                    },
                                    "CDSAllCompany": {
                                        "filename": "CDSAllCompany.csv",
                                        "foldername": "input",
                                        "container": "partybootstrapping"
                                    },
                                    "FOAllContactPerson": {
                                        "filename": "FOAllContactPerson.csv",
                                        "foldername": "input",
                                        "container": "partybootstrapping"
                                    },
                                    "ContactForPartyAccount": {}
                                }
                            },
                            "staging": {},
                            "compute": {
                                "coreCount": 8,
                                "computeType": "General"
                            },
                            "traceLevel": "Fine"
                        }
                    },
                    {
                        "name": "1-Retrieve all companies from Dataverse",
                        "description": "Copy company entity data from CRM",
                        "type": "Copy",
                        "dependsOn": [],
                        "policy": {
                            "timeout": "7.00:00:00",
                            "retry": 0,
                            "retryIntervalInSeconds": 30,
                            "secureOutput": false,
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "source": {
                                "type": "DynamicsCrmSource",
                                "query": "<fetch version=\"1.0\" output-format=\"xml-platform\" mapping=\"logical\" distinct=\"false\">\n  <entity name=\"cdm_company\">\n    <attribute name=\"cdm_name\" />\n    <attribute name=\"cdm_companyid\" />\n    <attribute name=\"cdm_companycode\" />\n    <attribute name=\"cdm_isenabledfordualwrite\" />\n  </entity>\n</fetch>\n"
                            },
                            "sink": {
                                "type": "DelimitedTextSink",
                                "storeSettings": {
                                    "type": "AzureBlobStorageWriteSettings"
                                },
                                "formatSettings": {
                                    "type": "DelimitedTextWriteSettings",
                                    "quoteAllText": true,
                                    "fileExtension": ".txt"
                                }
                            },
                            "enableStaging": false,
                            "translator": {
                                "type": "TabularTranslator",
                                "mappings": [
                                    {
                                        "source": {
                                            "name": "cdm_name",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "cdm_name",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "cdm_companyid",
                                            "type": "Guid"
                                        },
                                        "sink": {
                                            "name": "cdm_companyid",
                                            "type": "Guid"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "cdm_companycode",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "cdm_companycode",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "cdm_isenabledfordualwrite",
                                            "type": "Boolean"
                                        },
                                        "sink": {
                                            "name": "cdm_isenabledfordualwrite",
                                            "type": "Boolean"
                                        }
                                    }
                                ]
                            }
                        },
                        "inputs": [
                            {
                                "referenceName": "DynamicsCrmConnection",
                                "type": "DatasetReference",
                                "parameters": {
                                    "entityname": "cdm_company"
                                }
                            }
                        ],
                        "outputs": [
                            {
                                "referenceName": "DelimitedTextFiles",
                                "type": "DatasetReference",
                                "parameters": {
                                    "filename": "CDSAllCompany.csv",
                                    "foldername": "input",
                                    "container": "partybootstrapping"
                                }
                            }
                        ]
                    },
                    {
                        "name": "2-Identify the DW enabled companies",
                        "type": "ExecuteDataFlow",
                        "dependsOn": [
                            {
                                "activity": "1-Retrieve all companies from Dataverse",
                                "dependencyConditions": [
                                    "Succeeded"
                                ]
                            }
                        ],
                        "policy": {
                            "timeout": "7.00:00:00",
                            "retry": 0,
                            "retryIntervalInSeconds": 30,
                            "secureOutput": false,
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "dataflow": {
                                "referenceName": "DWCompanies",
                                "type": "DataFlowReference",
                                "parameters": {},
                                "datasetParameters": {
                                    "CDSAllCompany": {
                                        "filename": "CDSAllCompany.csv",
                                        "foldername": "input",
                                        "container": "partybootstrapping"
                                    },
                                    "sink1": {}
                                }
                            },
                            "staging": {},
                            "compute": {
                                "coreCount": 8,
                                "computeType": "General"
                            },
                            "traceLevel": "Fine"
                        }
                    },
                    {
                        "name": "5-Transform company name to DataAreaId",
                        "description": "Set company for filter condition",
                        "type": "SetVariable",
                        "dependsOn": [
                            {
                                "activity": "4-For each company",
                                "dependencyConditions": [
                                    "Succeeded"
                                ]
                            }
                        ],
                        "userProperties": [],
                        "typeProperties": {
                            "variableName": "CompanyName",
                            "value": {
                                "value": "@join(variables('Companies'), ' or ')",
                                "type": "Expression"
                            }
                        }
                    },
                    {
                        "name": "6-Create a consolidated company filter",
                        "description": "Set company filter clause",
                        "type": "SetVariable",
                        "dependsOn": [
                            {
                                "activity": "5-Transform company name to DataAreaId",
                                "dependencyConditions": [
                                    "Succeeded"
                                ]
                            }
                        ],
                        "userProperties": [],
                        "typeProperties": {
                            "variableName": "filter",
                            "value": {
                                "value": "@concat('$filter=',variables('CompanyName'),'&cross-company=true')",
                                "type": "Expression"
                            }
                        }
                    },
                    {
                        "name": "3-Read all DW enabled companies",
                        "type": "Lookup",
                        "dependsOn": [
                            {
                                "activity": "2-Identify the DW enabled companies",
                                "dependencyConditions": [
                                    "Succeeded"
                                ]
                            }
                        ],
                        "policy": {
                            "timeout": "7.00:00:00",
                            "retry": 0,
                            "retryIntervalInSeconds": 30,
                            "secureOutput": false,
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "source": {
                                "type": "DelimitedTextSource",
                                "storeSettings": {
                                    "type": "AzureBlobStorageReadSettings",
                                    "recursive": true,
                                    "enablePartitionDiscovery": false
                                },
                                "formatSettings": {
                                    "type": "DelimitedTextReadSettings"
                                }
                            },
                            "dataset": {
                                "referenceName": "DelimitedTextFiles",
                                "type": "DatasetReference",
                                "parameters": {
                                    "filename": "DWEnabledCompany.csv",
                                    "foldername": "output",
                                    "container": "partybootstrapping"
                                }
                            },
                            "firstRowOnly": false
                        }
                    },
                    {
                        "name": "4-For each company",
                        "description": "Iterate each company and join them to generate filter clause",
                        "type": "ForEach",
                        "dependsOn": [
                            {
                                "activity": "3-Read all DW enabled companies",
                                "dependencyConditions": [
                                    "Succeeded"
                                ]
                            }
                        ],
                        "userProperties": [],
                        "typeProperties": {
                            "items": {
                                "value": "@activity('3-Read all DW enabled companies').output.value",
                                "type": "Expression"
                            },
                            "isSequential": true,
                            "activities": [
                                {
                                    "name": "Append variable1",
                                    "type": "AppendVariable",
                                    "dependsOn": [],
                                    "userProperties": [],
                                    "typeProperties": {
                                        "variableName": "Companies",
                                        "value": {
                                            "value": "@item().cdm_companycode",
                                            "type": "Expression"
                                        }
                                    }
                                }
                            ]
                        }
                    },
                    {
                        "name": "18-Import ContactForParty into Dataverse",
                        "type": "Copy",
                        "dependsOn": [
                            {
                                "activity": "17-Merge ContactForParty csv files into one csv file",
                                "dependencyConditions": [
                                    "Succeeded"
                                ]
                            }
                        ],
                        "policy": {
                            "timeout": "7.00:00:00",
                            "retry": 0,
                            "retryIntervalInSeconds": 30,
                            "secureOutput": false,
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "source": {
                                "type": "DelimitedTextSource",
                                "storeSettings": {
                                    "type": "AzureBlobStorageReadSettings",
                                    "recursive": true,
                                    "enablePartitionDiscovery": false
                                },
                                "formatSettings": {
                                    "type": "DelimitedTextReadSettings"
                                }
                            },
                            "sink": {
                                "type": "DynamicsCrmSink",
                                "writeBatchSize": 10,
                                "writeBehavior": "upsert",
                                "ignoreNullValues": false,
                                "alternateKeyName": "msdyn_contactforpartyuniquekey"
                            },
                            "enableStaging": false,
                            "enableSkipIncompatibleRow": true,
                            "logSettings": {
                                "enableCopyActivityLog": true,
                                "copyActivityLogSettings": {
                                    "logLevel": "Warning",
                                    "enableReliableLogging": false
                                },
                                "logLocationSettings": {
                                    "linkedServiceName": {
                                        "referenceName": "AzureBlobStorage",
                                        "type": "LinkedServiceReference"
                                    },
                                    "path": "partybootstrapping"
                                }
                            },
                            "translator": {
                                "type": "TabularTranslator",
                                "mappings": [
                                    {
                                        "source": {
                                            "name": "msdyn_contactid",
                                            "type": "String",
                                            "physicalType": "String"
                                        },
                                        "sink": {
                                            "name": "msdyn_contactid",
                                            "type": "Guid"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "msdyn_contactpartyid",
                                            "type": "String",
                                            "physicalType": "String"
                                        },
                                        "sink": {
                                            "name": "msdyn_contactpartyid",
                                            "type": "Guid"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "msdyn_associatedaccountid",
                                            "type": "String",
                                            "physicalType": "String"
                                        },
                                        "sink": {
                                            "name": "msdyn_associatedaccountid",
                                            "type": "Guid"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "msdyn_associatedpartyid",
                                            "type": "String",
                                            "physicalType": "String"
                                        },
                                        "sink": {
                                            "name": "msdyn_associatedpartyid",
                                            "type": "Guid"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "msdyn_associatedcompanyid",
                                            "type": "String",
                                            "physicalType": "String"
                                        },
                                        "sink": {
                                            "name": "msdyn_associatedcompanyid",
                                            "type": "Guid"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "msdyn_employmentprofession",
                                            "type": "String",
                                            "physicalType": "String"
                                        },
                                        "sink": {
                                            "name": "msdyn_employmentprofession",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "msdyn_decisionmakingrole",
                                            "type": "String",
                                            "physicalType": "String"
                                        },
                                        "sink": {
                                            "name": "msdyn_decisionmakingrole",
                                            "type": "Guid"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "msdyn_notes",
                                            "type": "String",
                                            "physicalType": "String"
                                        },
                                        "sink": {
                                            "name": "msdyn_notes",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "msdyn_spousename",
                                            "type": "String",
                                            "physicalType": "String"
                                        },
                                        "sink": {
                                            "name": "msdyn_spousename",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "msdyn_contactforpartynumber",
                                            "type": "String",
                                            "physicalType": "String"
                                        },
                                        "sink": {
                                            "name": "msdyn_contactforpartynumber",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "msdyn_employmentdepartment",
                                            "type": "String",
                                            "physicalType": "String"
                                        },
                                        "sink": {
                                            "name": "msdyn_employmentdepartment",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "msdyn_primarysalutationphrase",
                                            "type": "String",
                                            "physicalType": "String"
                                        },
                                        "sink": {
                                            "name": "msdyn_primarysalutationphrase",
                                            "type": "Guid"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "msdyn_assistantname",
                                            "type": "String",
                                            "physicalType": "String"
                                        },
                                        "sink": {
                                            "name": "msdyn_assistantname",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "msdyn_assistantphonenumber",
                                            "type": "String",
                                            "physicalType": "String"
                                        },
                                        "sink": {
                                            "name": "msdyn_assistantphonenumber",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "msdyn_availablefromtime",
                                            "type": "String",
                                            "physicalType": "String"
                                        },
                                        "sink": {
                                            "name": "msdyn_availablefromtime",
                                            "type": "Int32"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "msdyn_availabletotime",
                                            "type": "String",
                                            "physicalType": "String"
                                        },
                                        "sink": {
                                            "name": "msdyn_availabletotime",
                                            "type": "Int32"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "msdyn_employmentcomputernetworkname",
                                            "type": "String",
                                            "physicalType": "String"
                                        },
                                        "sink": {
                                            "name": "msdyn_employmentcomputernetworkname",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "msdyn_employmentjobfunctionname",
                                            "type": "String",
                                            "physicalType": "String"
                                        },
                                        "sink": {
                                            "name": "msdyn_employmentjobfunctionname",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "msdyn_governmentidentificationnumber",
                                            "type": "String",
                                            "physicalType": "String"
                                        },
                                        "sink": {
                                            "name": "msdyn_governmentidentificationnumber",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "msdyn_identitycardnumber",
                                            "type": "String",
                                            "physicalType": "String"
                                        },
                                        "sink": {
                                            "name": "msdyn_identitycardnumber",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "msdyn_loyaltylevelphrase",
                                            "type": "String",
                                            "physicalType": "String"
                                        },
                                        "sink": {
                                            "name": "msdyn_loyaltylevelphrase",
                                            "type": "Guid"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "msdyn_microsoftoutlookcategories",
                                            "type": "String",
                                            "physicalType": "String"
                                        },
                                        "sink": {
                                            "name": "msdyn_microsoftoutlookcategories",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "msdyn_mileagedistance",
                                            "type": "String",
                                            "physicalType": "String"
                                        },
                                        "sink": {
                                            "name": "msdyn_mileagedistance",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "msdyn_organizationidentificationnumber",
                                            "type": "String",
                                            "physicalType": "String"
                                        },
                                        "sink": {
                                            "name": "msdyn_organizationidentificationnumber",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "msdyn_personalcharactertypecode",
                                            "type": "String",
                                            "physicalType": "String"
                                        },
                                        "sink": {
                                            "name": "msdyn_personalcharactertypecode",
                                            "type": "Guid"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "msdyn_employmentofficelocation",
                                            "type": "String",
                                            "physicalType": "String"
                                        },
                                        "sink": {
                                            "name": "msdyn_employmentofficelocation",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "msdyn_primarycomplimentaryclosingphrase",
                                            "type": "String",
                                            "physicalType": "String"
                                        },
                                        "sink": {
                                            "name": "msdyn_primarycomplimentaryclosingphrase",
                                            "type": "Guid"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "msdyn_associatedvendorid",
                                            "type": "String",
                                            "physicalType": "String"
                                        },
                                        "sink": {
                                            "name": "msdyn_associatedvendorid",
                                            "type": "Guid"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "msdyn_associatedcontactid",
                                            "type": "String",
                                            "physicalType": "String"
                                        },
                                        "sink": {
                                            "name": "msdyn_associatedcontactid",
                                            "type": "Guid"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "msdyn_isvip",
                                            "type": "String",
                                            "physicalType": "String"
                                        },
                                        "sink": {
                                            "name": "msdyn_isvip",
                                            "type": "Boolean"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "msdyn_isreceivingdirectmail",
                                            "type": "String",
                                            "physicalType": "String"
                                        },
                                        "sink": {
                                            "name": "msdyn_isreceivingdirectmail",
                                            "type": "Boolean"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "msdyn_contactactivitysensitivitylevel",
                                            "type": "String",
                                            "physicalType": "String"
                                        },
                                        "sink": {
                                            "name": "msdyn_contactactivitysensitivitylevel",
                                            "type": "Int32"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "msdyn_hasrequestedinternetaccess",
                                            "type": "String",
                                            "physicalType": "String"
                                        },
                                        "sink": {
                                            "name": "msdyn_hasrequestedinternetaccess",
                                            "type": "Boolean"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "msdyn_parentcontactforpartyid",
                                            "type": "String",
                                            "physicalType": "String"
                                        },
                                        "sink": {
                                            "name": "msdyn_parentcontactforpartyid",
                                            "type": "Guid"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "msdyn_employeeresponsible",
                                            "type": "String",
                                            "physicalType": "String"
                                        },
                                        "sink": {
                                            "name": "msdyn_employeeresponsible",
                                            "type": "Guid"
                                        }
                                    }
                                ],
                                "typeConversion": true,
                                "typeConversionSettings": {
                                    "allowDataTruncation": true,
                                    "treatBooleanAsNumber": false
                                }
                            }
                        },
                        "inputs": [
                            {
                                "referenceName": "DelimitedTextFiles",
                                "type": "DatasetReference",
                                "parameters": {
                                    "filename": "CDSContactForParty.csv",
                                    "foldername": "output",
                                    "container": "partybootstrapping"
                                }
                            }
                        ],
                        "outputs": [
                            {
                                "referenceName": "DynamicsCrmConnection",
                                "type": "DatasetReference",
                                "parameters": {
                                    "entityname": "msdyn_contactforparty"
                                }
                            }
                        ]
                    },
                    {
                        "name": "7-8-Create blank csv file to hold new parties for FO",
                        "description": "Blank file to create party schema",
                        "type": "Copy",
                        "dependsOn": [],
                        "policy": {
                            "timeout": "7.00:00:00",
                            "retry": 0,
                            "retryIntervalInSeconds": 30,
                            "secureOutput": false,
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "source": {
                                "type": "DynamicsAXSource",
                                "query": "$filter=1 eq 2",
                                "httpRequestTimeout": "00:05:00"
                            },
                            "sink": {
                                "type": "DelimitedTextSink",
                                "storeSettings": {
                                    "type": "AzureBlobStorageWriteSettings"
                                },
                                "formatSettings": {
                                    "type": "DelimitedTextWriteSettings",
                                    "quoteAllText": true,
                                    "fileExtension": ".csv"
                                }
                            },
                            "enableStaging": false,
                            "translator": {
                                "type": "TabularTranslator",
                                "mappings": [
                                    {
                                        "source": {
                                            "name": "PartyNumber",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "PartyNumber",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "PersonPersonalSuffix",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "PersonPersonalSuffix",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "PersonPhoneticLastName",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "PersonPhoneticLastName",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "PersonAnniversaryMonth",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "PersonAnniversaryMonth",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "PersonLastName",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "PersonLastName",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "PartyType",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "PartyType",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "PersonPersonalTitle",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "PersonPersonalTitle",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "PersonInitials",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "PersonInitials",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "PersonGender",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "PersonGender",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "PersonLastNamePrefix",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "PersonLastNamePrefix",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "PersonBirthDay",
                                            "type": "Int32"
                                        },
                                        "sink": {
                                            "name": "PersonBirthDay",
                                            "type": "Int32"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "LanguageId",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "LanguageId",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "OrganizationPhoneticName",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "OrganizationPhoneticName",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "PersonAnniversaryYear",
                                            "type": "Int32"
                                        },
                                        "sink": {
                                            "name": "PersonAnniversaryYear",
                                            "type": "Int32"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "PersonAnniversaryDay",
                                            "type": "Int32"
                                        },
                                        "sink": {
                                            "name": "PersonAnniversaryDay",
                                            "type": "Int32"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "PersonMaritalStatus",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "PersonMaritalStatus",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "PersonPhoneticMiddleName",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "PersonPhoneticMiddleName",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "PersonChildrenNames",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "PersonChildrenNames",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "PersonBirthYear",
                                            "type": "Int32"
                                        },
                                        "sink": {
                                            "name": "PersonBirthYear",
                                            "type": "Int32"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "PersonMiddleName",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "PersonMiddleName",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "OrganizationNumber",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "OrganizationNumber",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "PersonProfessionalSuffix",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "PersonProfessionalSuffix",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "OrganizationABCCode",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "OrganizationABCCode",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "AddressBooks",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "AddressBooks",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "PersonFirstName",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "PersonFirstName",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "KnownAs",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "KnownAs",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "OrganizationNumOfEmployees",
                                            "type": "Int32"
                                        },
                                        "sink": {
                                            "name": "OrganizationNumOfEmployees",
                                            "type": "Int32"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "PersonPhoneticFirstName",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "PersonPhoneticFirstName",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "PersonBirthMonth",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "PersonBirthMonth",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "PersonProfessionalTitle",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "PersonProfessionalTitle",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "NameAlias",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "NameAlias",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "OrganizationName",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "OrganizationName",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "PersonHobbies",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "PersonHobbies",
                                            "type": "String"
                                        }
                                    }
                                ]
                            }
                        },
                        "inputs": [
                            {
                                "referenceName": "FOConnection",
                                "type": "DatasetReference",
                                "parameters": {
                                    "entitypath": "CDSParties"
                                }
                            }
                        ],
                        "outputs": [
                            {
                                "referenceName": "DelimitedTextFiles",
                                "type": "DatasetReference",
                                "parameters": {
                                    "filename": "FONewParty.csv",
                                    "foldername": "input",
                                    "container": "partybootstrapping"
                                }
                            }
                        ]
                    },
                    {
                        "name": "14-1-Import Account with partyid into Dataverse",
                        "type": "Copy",
                        "dependsOn": [
                            {
                                "activity": "13-Associate party Guid with Account n Contact n Vendor",
                                "dependencyConditions": [
                                    "Succeeded"
                                ]
                            }
                        ],
                        "policy": {
                            "timeout": "7.00:00:00",
                            "retry": 2,
                            "retryIntervalInSeconds": 60,
                            "secureOutput": false,
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "source": {
                                "type": "DelimitedTextSource",
                                "storeSettings": {
                                    "type": "AzureBlobStorageReadSettings",
                                    "recursive": true
                                },
                                "formatSettings": {
                                    "type": "DelimitedTextReadSettings"
                                }
                            },
                            "sink": {
                                "type": "DynamicsCrmSink",
                                "writeBatchSize": 10,
                                "writeBehavior": "upsert",
                                "ignoreNullValues": true,
                                "alternateKeyName": "msdyn_accountentitykey"
                            },
                            "enableStaging": false,
                            "enableSkipIncompatibleRow": true,
                            "logSettings": {
                                "enableCopyActivityLog": true,
                                "copyActivityLogSettings": {
                                    "logLevel": "Warning",
                                    "enableReliableLogging": false
                                },
                                "logLocationSettings": {
                                    "linkedServiceName": {
                                        "referenceName": "AzureBlobStorage",
                                        "type": "LinkedServiceReference"
                                    },
                                    "path": "partybootstrapping"
                                }
                            },
                            "translator": {
                                "type": "TabularTranslator",
                                "mappings": [
                                    {
                                        "source": {
                                            "name": "accountid",
                                            "type": "Guid"
                                        },
                                        "sink": {
                                            "name": "accountid",
                                            "type": "Guid"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "msdyn_partyid",
                                            "type": "Guid"
                                        },
                                        "sink": {
                                            "name": "msdyn_partyid",
                                            "type": "Guid"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "msdyn_company",
                                            "type": "Guid"
                                        },
                                        "sink": {
                                            "name": "msdyn_company",
                                            "type": "Guid"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "accountnumber",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "accountnumber",
                                            "type": "String"
                                        }
                                    }
                                ]
                            }
                        },
                        "inputs": [
                            {
                                "referenceName": "DelimitedTextFiles",
                                "type": "DatasetReference",
                                "parameters": {
                                    "filename": "AccountParty.csv",
                                    "foldername": "output",
                                    "container": "partybootstrapping"
                                }
                            }
                        ],
                        "outputs": [
                            {
                                "referenceName": "DynamicsCrmConnection",
                                "type": "DatasetReference",
                                "parameters": {
                                    "entityname": "account"
                                }
                            }
                        ]
                    },
                    {
                        "name": "14-2-Import Contact with partyid into Dataverse",
                        "type": "Copy",
                        "dependsOn": [
                            {
                                "activity": "13-Associate party Guid with Account n Contact n Vendor",
                                "dependencyConditions": [
                                    "Succeeded"
                                ]
                            }
                        ],
                        "policy": {
                            "timeout": "7.00:00:00",
                            "retry": 2,
                            "retryIntervalInSeconds": 60,
                            "secureOutput": false,
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "source": {
                                "type": "DelimitedTextSource",
                                "storeSettings": {
                                    "type": "AzureBlobStorageReadSettings",
                                    "recursive": true
                                },
                                "formatSettings": {
                                    "type": "DelimitedTextReadSettings"
                                }
                            },
                            "sink": {
                                "type": "DynamicsCrmSink",
                                "writeBatchSize": 10,
                                "writeBehavior": "upsert",
                                "ignoreNullValues": true,
                                "alternateKeyName": "msdyn_contactkey"
                            },
                            "enableStaging": false,
                            "enableSkipIncompatibleRow": true,
                            "logSettings": {
                                "enableCopyActivityLog": true,
                                "copyActivityLogSettings": {
                                    "logLevel": "Warning",
                                    "enableReliableLogging": false
                                },
                                "logLocationSettings": {
                                    "linkedServiceName": {
                                        "referenceName": "AzureBlobStorage",
                                        "type": "LinkedServiceReference"
                                    },
                                    "path": "partybootstrapping"
                                }
                            },
                            "translator": {
                                "type": "TabularTranslator",
                                "mappings": [
                                    {
                                        "source": {
                                            "name": "contactid",
                                            "type": "Guid"
                                        },
                                        "sink": {
                                            "name": "contactid",
                                            "type": "Guid"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "msdyn_partyid",
                                            "type": "Guid"
                                        },
                                        "sink": {
                                            "name": "msdyn_partyid",
                                            "type": "Guid"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "msdyn_contactpersonid",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "msdyn_contactpersonid",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "msdyn_company",
                                            "type": "Guid"
                                        },
                                        "sink": {
                                            "name": "msdyn_company",
                                            "type": "Guid"
                                        }
                                    }
                                ]
                            }
                        },
                        "inputs": [
                            {
                                "referenceName": "DelimitedTextFiles",
                                "type": "DatasetReference",
                                "parameters": {
                                    "filename": "ContactParty.csv",
                                    "foldername": "output",
                                    "container": "partybootstrapping"
                                }
                            }
                        ],
                        "outputs": [
                            {
                                "referenceName": "DynamicsCrmConnection",
                                "type": "DatasetReference",
                                "parameters": {
                                    "entityname": "contact"
                                }
                            }
                        ]
                    },
                    {
                        "name": "14-3-Import Vendor with partyid into Dataverse",
                        "type": "Copy",
                        "dependsOn": [
                            {
                                "activity": "13-Associate party Guid with Account n Contact n Vendor",
                                "dependencyConditions": [
                                    "Succeeded"
                                ]
                            }
                        ],
                        "policy": {
                            "timeout": "7.00:00:00",
                            "retry": 2,
                            "retryIntervalInSeconds": 60,
                            "secureOutput": false,
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "source": {
                                "type": "DelimitedTextSource",
                                "storeSettings": {
                                    "type": "AzureBlobStorageReadSettings",
                                    "recursive": true
                                },
                                "formatSettings": {
                                    "type": "DelimitedTextReadSettings"
                                }
                            },
                            "sink": {
                                "type": "DynamicsCrmSink",
                                "writeBatchSize": 10,
                                "writeBehavior": "upsert",
                                "ignoreNullValues": true,
                                "alternateKeyName": "msdyn_vendorentitykey"
                            },
                            "enableStaging": false,
                            "enableSkipIncompatibleRow": true,
                            "logSettings": {
                                "enableCopyActivityLog": true,
                                "copyActivityLogSettings": {
                                    "logLevel": "Warning",
                                    "enableReliableLogging": false
                                },
                                "logLocationSettings": {
                                    "linkedServiceName": {
                                        "referenceName": "AzureBlobStorage",
                                        "type": "LinkedServiceReference"
                                    },
                                    "path": "partybootstrapping"
                                }
                            },
                            "translator": {
                                "type": "TabularTranslator",
                                "mappings": [
                                    {
                                        "source": {
                                            "name": "msdyn_vendorid",
                                            "type": "Guid"
                                        },
                                        "sink": {
                                            "name": "msdyn_vendorid",
                                            "type": "Guid"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "msdyn_partyid",
                                            "type": "Guid"
                                        },
                                        "sink": {
                                            "name": "msdyn_partyid",
                                            "type": "Guid"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "msdyn_company",
                                            "type": "Guid"
                                        },
                                        "sink": {
                                            "name": "msdyn_company",
                                            "type": "Guid"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "msdyn_vendoraccountnumber",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "msdyn_vendoraccountnumber",
                                            "type": "String"
                                        }
                                    }
                                ]
                            }
                        },
                        "inputs": [
                            {
                                "referenceName": "DelimitedTextFiles",
                                "type": "DatasetReference",
                                "parameters": {
                                    "filename": "VendorParty.csv",
                                    "foldername": "output",
                                    "container": "partybootstrapping"
                                }
                            }
                        ],
                        "outputs": [
                            {
                                "referenceName": "DynamicsCrmConnection",
                                "type": "DatasetReference",
                                "parameters": {
                                    "entityname": "msdyn_vendor"
                                }
                            }
                        ]
                    },
                    {
                        "name": "7-9-Retrieve language and PartyType from Dataverse",
                        "description": "Retrieve language and party type option set from Dataverse",
                        "type": "Copy",
                        "dependsOn": [],
                        "policy": {
                            "timeout": "7.00:00:00",
                            "retry": 0,
                            "retryIntervalInSeconds": 30,
                            "secureOutput": false,
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "source": {
                                "type": "DynamicsCrmSource",
                                "query": "<fetch version=\"1.0\" output-format=\"xml-platform\" mapping=\"logical\" distinct=\"true\">\n  <entity name=\"stringmap\" >\n    <attribute name=\"attributevalue\" />\n    <attribute name=\"value\" />\n    <attribute name=\"attributename\" />\n    <filter type=\"or\">\n      <condition attribute=\"attributename\" operator=\"eq\" value=\"msdyn_language\" />\n      <condition attribute=\"attributename\" operator=\"eq\" value=\"msdyn_partytype\" />\n    </filter>\n  </entity>\n</fetch>"
                            },
                            "sink": {
                                "type": "DelimitedTextSink",
                                "storeSettings": {
                                    "type": "AzureBlobStorageWriteSettings"
                                },
                                "formatSettings": {
                                    "type": "DelimitedTextWriteSettings",
                                    "quoteAllText": true,
                                    "fileExtension": ".txt"
                                }
                            },
                            "enableStaging": false,
                            "translator": {
                                "type": "TabularTranslator",
                                "mappings": [
                                    {
                                        "source": {
                                            "name": "attributevalue",
                                            "type": "Int32"
                                        },
                                        "sink": {
                                            "name": "attributevalue",
                                            "type": "Int32"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "value",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "value",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "attributename",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "attributename",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "stringmapid",
                                            "type": "Guid"
                                        },
                                        "sink": {
                                            "name": "stringmapid",
                                            "type": "Guid"
                                        }
                                    }
                                ]
                            }
                        },
                        "inputs": [
                            {
                                "referenceName": "DynamicsCrmConnection",
                                "type": "DatasetReference",
                                "parameters": {
                                    "entityname": "stringmap"
                                }
                            }
                        ],
                        "outputs": [
                            {
                                "referenceName": "DelimitedTextFiles",
                                "type": "DatasetReference",
                                "parameters": {
                                    "filename": "CDSOptionset.csv",
                                    "foldername": "input",
                                    "container": "partybootstrapping"
                                }
                            }
                        ]
                    },
                    {
                        "name": "7-3-Retrieve contacts from FO based on company filter",
                        "description": "Retrieve contact person data from FO for DW enabled companies",
                        "type": "Copy",
                        "dependsOn": [
                            {
                                "activity": "6-Create a consolidated company filter",
                                "dependencyConditions": [
                                    "Succeeded"
                                ]
                            }
                        ],
                        "policy": {
                            "timeout": "7.00:00:00",
                            "retry": 0,
                            "retryIntervalInSeconds": 30,
                            "secureOutput": false,
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "source": {
                                "type": "DynamicsAXSource",
                                "query": {
                                    "value": "@concat('$select=dataAreaId,ContactPersonPartyNumber,ContactPersonId,AssociatedPartyNumber,EmploymentProfession,DecisionMakingRoleCode,Notes,SpouseName,EmploymentDepartment,PrimarySalutationPhrase,AssistantName,AssistantPhoneNumber,AvailableFromTime,AvailableToTime,EmploymentComputerNetworkName,EmploymentJobFunctionName,EmploymentOfficeLocation,GovernmentIdentificationNumber,IdentityCardNumber,LoyaltyLevelPhrase,MicrosoftOutlookCategories,MileageDistance,OrganizationIdentificationNumber,PersonalCharacterTypeCode,PrimaryComplimentaryClosingPhrase,EmploymentJobTitle,ContactPersonResponsiblePersonnelNumber,IsReceivingDirectMail,IsVIP,ContactActivitySensitivityLevel,HasRequestedInternetAccess,ManagerContactPersonId&' , variables('filter'))",
                                    "type": "Expression"
                                },
                                "httpRequestTimeout": "00:05:00"
                            },
                            "sink": {
                                "type": "DelimitedTextSink",
                                "storeSettings": {
                                    "type": "AzureBlobStorageWriteSettings"
                                },
                                "formatSettings": {
                                    "type": "DelimitedTextWriteSettings",
                                    "quoteAllText": true,
                                    "fileExtension": ".txt"
                                }
                            },
                            "enableStaging": false,
                            "translator": {
                                "type": "TabularTranslator",
                                "mappings": [
                                    {
                                        "source": {
                                            "name": "dataAreaId",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "dataAreaId",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "ContactPersonId",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "ContactPersonId",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "EmploymentOfficeLocation",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "EmploymentOfficeLocation",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "PrimarySalutationPhrase",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "PrimarySalutationPhrase",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "SpouseName",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "SpouseName",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "IsVIP",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "IsVIP",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "OrganizationIdentificationNumber",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "OrganizationIdentificationNumber",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "AssistantPhoneNumber",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "AssistantPhoneNumber",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "Notes",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "Notes",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "AvailableToTime",
                                            "type": "Int32"
                                        },
                                        "sink": {
                                            "name": "AvailableToTime",
                                            "type": "Int32"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "IsReceivingDirectMail",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "IsReceivingDirectMail",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "EmploymentJobFunctionName",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "EmploymentJobFunctionName",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "GovernmentIdentificationNumber",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "GovernmentIdentificationNumber",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "EmploymentDepartment",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "EmploymentDepartment",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "MileageDistance",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "MileageDistance",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "ContactPersonResponsiblePersonnelNumber",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "ContactPersonResponsiblePersonnelNumber",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "MicrosoftOutlookCategories",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "MicrosoftOutlookCategories",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "AssociatedPartyNumber",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "AssociatedPartyNumber",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "AvailableFromTime",
                                            "type": "Int32"
                                        },
                                        "sink": {
                                            "name": "AvailableFromTime",
                                            "type": "Int32"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "EmploymentComputerNetworkName",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "EmploymentComputerNetworkName",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "LoyaltyLevelPhrase",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "LoyaltyLevelPhrase",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "EmploymentJobTitle",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "EmploymentJobTitle",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "ContactActivitySensitivityLevel",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "ContactActivitySensitivityLevel",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "HasRequestedInternetAccess",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "HasRequestedInternetAccess",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "ManagerContactPersonId",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "ManagerContactPersonId",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "IdentityCardNumber",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "IdentityCardNumber",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "AssistantName",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "AssistantName",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "ContactPersonPartyNumber",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "ContactPersonPartyNumber",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "EmploymentProfession",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "EmploymentProfession",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "PrimaryComplimentaryClosingPhrase",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "PrimaryComplimentaryClosingPhrase",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "PersonalCharacterTypeCode",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "PersonalCharacterTypeCode",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "DecisionMakingRoleCode",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "DecisionMakingRoleCode",
                                            "type": "String"
                                        }
                                    }
                                ]
                            }
                        },
                        "inputs": [
                            {
                                "referenceName": "FOConnection",
                                "type": "DatasetReference",
                                "parameters": {
                                    "entitypath": "ContactPersons"
                                }
                            }
                        ],
                        "outputs": [
                            {
                                "referenceName": "DelimitedTextFiles",
                                "type": "DatasetReference",
                                "parameters": {
                                    "filename": "FOAllContactPerson.csv",
                                    "foldername": "input",
                                    "container": "partybootstrapping"
                                }
                            }
                        ]
                    },
                    {
                        "name": "17-Merge ContactForParty csv files into one csv file",
                        "type": "ExecuteDataFlow",
                        "dependsOn": [
                            {
                                "activity": "15-1-Create csv file with ContactForParty for Accounts",
                                "dependencyConditions": [
                                    "Succeeded"
                                ]
                            },
                            {
                                "activity": "15-3-Create csv file with ContactForParty for Vendors",
                                "dependencyConditions": [
                                    "Succeeded"
                                ]
                            },
                            {
                                "activity": "15-2-Create csv file with ContactForParty for Contacts",
                                "dependencyConditions": [
                                    "Succeeded"
                                ]
                            },
                            {
                                "activity": "16-2-Retrieve Character Type from Dataverse_copy1",
                                "dependencyConditions": [
                                    "Succeeded"
                                ]
                            },
                            {
                                "activity": "16-3-Retrieve Complimentary Closing from Dataverse",
                                "dependencyConditions": [
                                    "Succeeded"
                                ]
                            },
                            {
                                "activity": "16-4-Retrieve loyalty level from Dataverse",
                                "dependencyConditions": [
                                    "Succeeded"
                                ]
                            },
                            {
                                "activity": "16-1-Retrieve salutation from Dataverse",
                                "dependencyConditions": [
                                    "Succeeded"
                                ]
                            },
                            {
                                "activity": "16-5-Retrieve Sales Contact Person Title from Datavers",
                                "dependencyConditions": [
                                    "Succeeded"
                                ]
                            },
                            {
                                "activity": "16-6-Retrieve Decision Making Role from Datavers_copy1",
                                "dependencyConditions": [
                                    "Succeeded"
                                ]
                            },
                            {
                                "activity": "16-7-Retrieve worker from Datavers",
                                "dependencyConditions": [
                                    "Succeeded"
                                ]
                            }
                        ],
                        "policy": {
                            "timeout": "7.00:00:00",
                            "retry": 0,
                            "retryIntervalInSeconds": 30,
                            "secureOutput": false,
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "dataflow": {
                                "referenceName": "MergeContactForPartyAccountVendor",
                                "type": "DataFlowReference",
                                "parameters": {},
                                "datasetParameters": {
                                    "ContactForPartyAccount": {
                                        "filename": "ContactForPartyAccount.csv",
                                        "foldername": "output",
                                        "container": "partybootstrapping"
                                    },
                                    "ContactForPartyVendor": {
                                        "filename": "ContactForPartyVendor.csv",
                                        "foldername": "output",
                                        "container": "partybootstrapping"
                                    },
                                    "ContactForPartyCustomerContact": {
                                        "filename": "ContactForPartyCustomerContact.csv",
                                        "foldername": "output",
                                        "container": "partybootstrapping"
                                    },
                                    "CDSSalutation": {
                                        "filename": "CDSSalutation.csv",
                                        "foldername": "input",
                                        "container": "partybootstrapping"
                                    },
                                    "CDSComplimentaryClosing": {
                                        "filename": "CDSComplimentaryClosing.csv",
                                        "foldername": "input",
                                        "container": "partybootstrapping"
                                    },
                                    "CDSLoyaltyLevel": {
                                        "filename": "CDSLoyaltyLevel.csv",
                                        "foldername": "input",
                                        "container": "partybootstrapping"
                                    },
                                    "CDSPersonalCharacterType": {
                                        "filename": "CDSPersonalCharacterType.csv",
                                        "foldername": "input",
                                        "container": "partybootstrapping"
                                    },
                                    "CDSSalesContactPersonTitle": {
                                        "filename": "CDSSalesContactPersonTitle.csv",
                                        "foldername": "input",
                                        "container": "partybootstrapping"
                                    },
                                    "CDSDecisionMakingRole": {
                                        "filename": "CDSDecisionMakingRole.csv",
                                        "foldername": "input",
                                        "container": "partybootstrapping"
                                    },
                                    "CDSWorker": {
                                        "filename": "CDSWorker.csv",
                                        "foldername": "input",
                                        "container": "partybootstrapping"
                                    },
                                    "ContactForParty": {}
                                }
                            },
                            "staging": {},
                            "compute": {
                                "coreCount": 8,
                                "computeType": "General"
                            },
                            "traceLevel": "Fine"
                        }
                    },
                    {
                        "name": "15-3-Create csv file with ContactForParty for Vendors",
                        "type": "ExecuteDataFlow",
                        "dependsOn": [
                            {
                                "activity": "14-3-Import Vendor with partyid into Dataverse",
                                "dependencyConditions": [
                                    "Succeeded"
                                ]
                            }
                        ],
                        "policy": {
                            "timeout": "7.00:00:00",
                            "retry": 0,
                            "retryIntervalInSeconds": 30,
                            "secureOutput": false,
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "dataflow": {
                                "referenceName": "PrepareContactForPartyVendor",
                                "type": "DataFlowReference",
                                "parameters": {},
                                "datasetParameters": {
                                    "VendorParty": {
                                        "filename": "VendorParty.csv",
                                        "foldername": "output",
                                        "container": "partybootstrapping"
                                    },
                                    "FOAllContactPerson": {
                                        "filename": "FOAllContactPerson.csv",
                                        "foldername": "input",
                                        "container": "partybootstrapping"
                                    },
                                    "CDSAllContact": {
                                        "filename": "CDSAllContact.csv",
                                        "foldername": "input",
                                        "container": "partybootstrapping"
                                    },
                                    "CDSParty": {
                                        "filename": "CDSParty.csv",
                                        "foldername": "input",
                                        "container": "partybootstrapping"
                                    },
                                    "CDSVendorPartyFile": {}
                                }
                            },
                            "staging": {},
                            "compute": {
                                "coreCount": 8,
                                "computeType": "General"
                            },
                            "traceLevel": "Fine"
                        }
                    },
                    {
                        "name": "15-2-Create csv file with ContactForParty for Contacts",
                        "type": "ExecuteDataFlow",
                        "dependsOn": [
                            {
                                "activity": "14-2-Import Contact with partyid into Dataverse",
                                "dependencyConditions": [
                                    "Succeeded"
                                ]
                            }
                        ],
                        "policy": {
                            "timeout": "7.00:00:00",
                            "retry": 0,
                            "retryIntervalInSeconds": 30,
                            "secureOutput": false,
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "dataflow": {
                                "referenceName": "PrepareContactForPartyCustomerContact",
                                "type": "DataFlowReference",
                                "parameters": {},
                                "datasetParameters": {
                                    "ContactParty": {
                                        "filename": "ContactParty.csv",
                                        "foldername": "output",
                                        "container": "partybootstrapping"
                                    },
                                    "CDSParty": {
                                        "filename": "CDSParty.csv",
                                        "foldername": "input",
                                        "container": "partybootstrapping"
                                    },
                                    "FOAllContactPerson": {
                                        "filename": "FOAllContactPerson.csv",
                                        "foldername": "input",
                                        "container": "partybootstrapping"
                                    },
                                    "CDSAllContact": {
                                        "filename": "CDSAllContact.csv",
                                        "foldername": "input",
                                        "container": "partybootstrapping"
                                    },
                                    "ContactForPartyCustomerContact": {}
                                }
                            },
                            "staging": {},
                            "compute": {
                                "coreCount": 8,
                                "computeType": "General"
                            },
                            "traceLevel": "Fine"
                        }
                    },
                    {
                        "name": "16-1-Retrieve salutation from Dataverse",
                        "description": "Retrieve salutation from Dataverse",
                        "type": "Copy",
                        "dependsOn": [],
                        "policy": {
                            "timeout": "7.00:00:00",
                            "retry": 0,
                            "retryIntervalInSeconds": 30,
                            "secureOutput": false,
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "source": {
                                "type": "DynamicsCrmSource",
                                "query": "<fetch version=\"1.0\" output-format=\"xml-platform\" mapping=\"logical\" distinct=\"true\">\n  <entity name=\"msdyn_salutation\" >\n    <attribute name=\"msdyn_company\" />\n    <attribute name=\"msdyn_salutationphrase\" />\n    <attribute name=\"msdyn_companyname\" />\n    <attribute name=\"statecode\" />\n    <attribute name=\"msdyn_salutationid\" />\n  </entity>\n</fetch>"
                            },
                            "sink": {
                                "type": "DelimitedTextSink",
                                "storeSettings": {
                                    "type": "AzureBlobStorageWriteSettings"
                                },
                                "formatSettings": {
                                    "type": "DelimitedTextWriteSettings",
                                    "quoteAllText": true,
                                    "fileExtension": ".txt"
                                }
                            },
                            "enableStaging": false,
                            "translator": {
                                "type": "TabularTranslator",
                                "mappings": [
                                    {
                                        "source": {
                                            "name": "msdyn_salutationphrase",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "msdyn_salutationphrase",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "statecode",
                                            "type": "Int32"
                                        },
                                        "sink": {
                                            "name": "statecode",
                                            "type": "Int32"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "msdyn_salutationid",
                                            "type": "Guid"
                                        },
                                        "sink": {
                                            "name": "msdyn_salutationid",
                                            "type": "Guid"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "msdyn_company",
                                            "type": "Guid"
                                        },
                                        "sink": {
                                            "name": "msdyn_company",
                                            "type": "Guid"
                                        }
                                    }
                                ]
                            }
                        },
                        "inputs": [
                            {
                                "referenceName": "DynamicsCrmConnection",
                                "type": "DatasetReference",
                                "parameters": {
                                    "entityname": "msdyn_salutation"
                                }
                            }
                        ],
                        "outputs": [
                            {
                                "referenceName": "DelimitedTextFiles",
                                "type": "DatasetReference",
                                "parameters": {
                                    "filename": "CDSSalutation.csv",
                                    "foldername": "input",
                                    "container": "partybootstrapping"
                                }
                            }
                        ]
                    },
                    {
                        "name": "16-2-Retrieve Character Type from Dataverse_copy1",
                        "description": "Retrieve Personal Character Type from Dataverse",
                        "type": "Copy",
                        "dependsOn": [],
                        "policy": {
                            "timeout": "7.00:00:00",
                            "retry": 0,
                            "retryIntervalInSeconds": 30,
                            "secureOutput": false,
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "source": {
                                "type": "DynamicsCrmSource",
                                "query": "<fetch version=\"1.0\" output-format=\"xml-platform\" mapping=\"logical\" distinct=\"true\">\n  <entity name=\"msdyn_personalcharactertype\" >\n    <attribute name=\"msdyn_company\" />\n    <attribute name=\"msdyn_typename\" />\n    <attribute name=\"msdyn_typedescription\" />\n    <attribute name=\"msdyn_companyname\" />\n    <attribute name=\"statecode\" />\n    <attribute name=\"msdyn_personalcharactertypeid\" />\n  </entity>\n</fetch>"
                            },
                            "sink": {
                                "type": "DelimitedTextSink",
                                "storeSettings": {
                                    "type": "AzureBlobStorageWriteSettings"
                                },
                                "formatSettings": {
                                    "type": "DelimitedTextWriteSettings",
                                    "quoteAllText": true,
                                    "fileExtension": ".txt"
                                }
                            },
                            "enableStaging": false,
                            "translator": {
                                "type": "TabularTranslator",
                                "mappings": [
                                    {
                                        "source": {
                                            "name": "msdyn_typename",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "msdyn_typename",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "statecode",
                                            "type": "Int32"
                                        },
                                        "sink": {
                                            "name": "statecode",
                                            "type": "Int32"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "msdyn_personalcharactertypeid",
                                            "type": "Guid"
                                        },
                                        "sink": {
                                            "name": "msdyn_personalcharactertypeid",
                                            "type": "Guid"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "msdyn_company",
                                            "type": "Guid"
                                        },
                                        "sink": {
                                            "name": "msdyn_company",
                                            "type": "Guid"
                                        }
                                    }
                                ]
                            }
                        },
                        "inputs": [
                            {
                                "referenceName": "DynamicsCrmConnection",
                                "type": "DatasetReference",
                                "parameters": {
                                    "entityname": "msdyn_personalcharactertype"
                                }
                            }
                        ],
                        "outputs": [
                            {
                                "referenceName": "DelimitedTextFiles",
                                "type": "DatasetReference",
                                "parameters": {
                                    "filename": "CDSPersonalCharacterType.csv",
                                    "foldername": "input",
                                    "container": "partybootstrapping"
                                }
                            }
                        ]
                    },
                    {
                        "name": "16-4-Retrieve loyalty level from Dataverse",
                        "description": "Retrieve loyalty level from Dataverse",
                        "type": "Copy",
                        "dependsOn": [],
                        "policy": {
                            "timeout": "7.00:00:00",
                            "retry": 0,
                            "retryIntervalInSeconds": 30,
                            "secureOutput": false,
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "source": {
                                "type": "DynamicsCrmSource",
                                "query": "<fetch version=\"1.0\" output-format=\"xml-platform\" mapping=\"logical\" distinct=\"true\">\n  <entity name=\"msdyn_loyaltylevel\" >\n    <attribute name=\"msdyn_company\" />\n    <attribute name=\"msdyn_levelphrase\" />\n    <attribute name=\"msdyn_description\" />\n    <attribute name=\"msdyn_companyname\" />\n    <attribute name=\"statecode\" />\n    <attribute name=\"msdyn_loyaltylevelid\" />\n  </entity>\n</fetch>"
                            },
                            "sink": {
                                "type": "DelimitedTextSink",
                                "storeSettings": {
                                    "type": "AzureBlobStorageWriteSettings"
                                },
                                "formatSettings": {
                                    "type": "DelimitedTextWriteSettings",
                                    "quoteAllText": true,
                                    "fileExtension": ".txt"
                                }
                            },
                            "enableStaging": false,
                            "translator": {
                                "type": "TabularTranslator",
                                "mappings": [
                                    {
                                        "source": {
                                            "name": "msdyn_levelphrase",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "msdyn_levelphrase",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "statecode",
                                            "type": "Int32"
                                        },
                                        "sink": {
                                            "name": "statecode",
                                            "type": "Int32"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "msdyn_loyaltylevelid",
                                            "type": "Guid"
                                        },
                                        "sink": {
                                            "name": "msdyn_loyaltylevelid",
                                            "type": "Guid"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "msdyn_company",
                                            "type": "Guid"
                                        },
                                        "sink": {
                                            "name": "msdyn_company",
                                            "type": "Guid"
                                        }
                                    }
                                ]
                            }
                        },
                        "inputs": [
                            {
                                "referenceName": "DynamicsCrmConnection",
                                "type": "DatasetReference",
                                "parameters": {
                                    "entityname": "msdyn_loyaltylevel"
                                }
                            }
                        ],
                        "outputs": [
                            {
                                "referenceName": "DelimitedTextFiles",
                                "type": "DatasetReference",
                                "parameters": {
                                    "filename": "CDSLoyaltyLevel.csv",
                                    "foldername": "input",
                                    "container": "partybootstrapping"
                                }
                            }
                        ]
                    },
                    {
                        "name": "16-3-Retrieve Complimentary Closing from Dataverse",
                        "description": "Retrieve Complimentary Closing from Dataverse",
                        "type": "Copy",
                        "dependsOn": [],
                        "policy": {
                            "timeout": "7.00:00:00",
                            "retry": 0,
                            "retryIntervalInSeconds": 30,
                            "secureOutput": false,
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "source": {
                                "type": "DynamicsCrmSource",
                                "query": "<fetch version=\"1.0\" output-format=\"xml-platform\" mapping=\"logical\" distinct=\"true\">\n  <entity name=\"msdyn_complimentaryclosing\" >\n    <attribute name=\"msdyn_companyid\" />\n    <attribute name=\"msdyn_closingphrase\" />\n    <attribute name=\"statecode\" />\n    <attribute name=\"msdyn_complimentaryclosingid\" />\n  </entity>\n</fetch>"
                            },
                            "sink": {
                                "type": "DelimitedTextSink",
                                "storeSettings": {
                                    "type": "AzureBlobStorageWriteSettings"
                                },
                                "formatSettings": {
                                    "type": "DelimitedTextWriteSettings",
                                    "quoteAllText": true,
                                    "fileExtension": ".txt"
                                }
                            },
                            "enableStaging": false,
                            "translator": {
                                "type": "TabularTranslator",
                                "mappings": [
                                    {
                                        "source": {
                                            "name": "msdyn_closingphrase",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "msdyn_closingphrase",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "statecode",
                                            "type": "Int32"
                                        },
                                        "sink": {
                                            "name": "statecode",
                                            "type": "Int32"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "msdyn_complimentaryclosingid",
                                            "type": "Guid"
                                        },
                                        "sink": {
                                            "name": "msdyn_complimentaryclosingid",
                                            "type": "Guid"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "msdyn_companyid",
                                            "type": "Guid"
                                        },
                                        "sink": {
                                            "name": "msdyn_companyid",
                                            "type": "Guid"
                                        }
                                    }
                                ]
                            }
                        },
                        "inputs": [
                            {
                                "referenceName": "DynamicsCrmConnection",
                                "type": "DatasetReference",
                                "parameters": {
                                    "entityname": "msdyn_complimentaryclosing"
                                }
                            }
                        ],
                        "outputs": [
                            {
                                "referenceName": "DelimitedTextFiles",
                                "type": "DatasetReference",
                                "parameters": {
                                    "filename": "CDSComplimentaryClosing.csv",
                                    "foldername": "input",
                                    "container": "partybootstrapping"
                                }
                            }
                        ]
                    },
                    {
                        "name": "16-5-Retrieve Sales Contact Person Title from Datavers",
                        "description": "Retrieve Sales Contact Person Title from Dataverse",
                        "type": "Copy",
                        "dependsOn": [],
                        "policy": {
                            "timeout": "7.00:00:00",
                            "retry": 0,
                            "retryIntervalInSeconds": 30,
                            "secureOutput": false,
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "source": {
                                "type": "DynamicsCrmSource",
                                "query": "<fetch version=\"1.0\" output-format=\"xml-platform\" mapping=\"logical\" distinct=\"true\">\n  <entity name=\"msdyn_salescontactpersontitle\" >\n    <attribute name=\"msdyn_company\" />\n    <attribute name=\"msdyn_companyname\" />\n    <attribute name=\"msdyn_jobtitle\" />\n    <attribute name=\"msdyn_jobtitlealias\" />\n    <attribute name=\"msdyn_companyname\" />\n    <attribute name=\"statecode\" />\n    <attribute name=\"msdyn_salescontactpersontitleid\" />\n  </entity>\n</fetch>"
                            },
                            "sink": {
                                "type": "DelimitedTextSink",
                                "storeSettings": {
                                    "type": "AzureBlobStorageWriteSettings"
                                },
                                "formatSettings": {
                                    "type": "DelimitedTextWriteSettings",
                                    "quoteAllText": true,
                                    "fileExtension": ".txt"
                                }
                            },
                            "enableStaging": false,
                            "translator": {
                                "type": "TabularTranslator",
                                "mappings": [
                                    {
                                        "source": {
                                            "name": "msdyn_company",
                                            "type": "Guid"
                                        },
                                        "sink": {
                                            "name": "msdyn_company",
                                            "type": "Guid"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "msdyn_jobtitle",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "msdyn_jobtitle",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "msdyn_jobtitlealias",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "msdyn_jobtitlealias",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "statecode",
                                            "type": "Int32"
                                        },
                                        "sink": {
                                            "name": "statecode",
                                            "type": "Int32"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "msdyn_salescontactpersontitleid",
                                            "type": "Guid"
                                        },
                                        "sink": {
                                            "name": "msdyn_salescontactpersontitleid",
                                            "type": "Guid"
                                        }
                                    }
                                ]
                            }
                        },
                        "inputs": [
                            {
                                "referenceName": "DynamicsCrmConnection",
                                "type": "DatasetReference",
                                "parameters": {
                                    "entityname": "msdyn_salescontactpersontitle"
                                }
                            }
                        ],
                        "outputs": [
                            {
                                "referenceName": "DelimitedTextFiles",
                                "type": "DatasetReference",
                                "parameters": {
                                    "filename": "CDSSalesContactPersonTitle.csv",
                                    "foldername": "input",
                                    "container": "partybootstrapping"
                                }
                            }
                        ]
                    },
                    {
                        "name": "16-6-Retrieve Decision Making Role from Datavers_copy1",
                        "description": "Retrieve Decision Making Role from Dataverse",
                        "type": "Copy",
                        "dependsOn": [],
                        "policy": {
                            "timeout": "7.00:00:00",
                            "retry": 0,
                            "retryIntervalInSeconds": 30,
                            "secureOutput": false,
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "source": {
                                "type": "DynamicsCrmSource",
                                "query": "<fetch version=\"1.0\" output-format=\"xml-platform\" mapping=\"logical\" distinct=\"true\">\n  <entity name=\"msdyn_decisionmakingrole\" >\n    <attribute name=\"msdyn_company\" />\n    <attribute name=\"msdyn_rolename\" />\n    <attribute name=\"msdyn_roledescription\" />\n    <attribute name=\"statecode\" />\n    <attribute name=\"msdyn_decisionmakingroleid\" />\n  </entity>\n</fetch>"
                            },
                            "sink": {
                                "type": "DelimitedTextSink",
                                "storeSettings": {
                                    "type": "AzureBlobStorageWriteSettings"
                                },
                                "formatSettings": {
                                    "type": "DelimitedTextWriteSettings",
                                    "quoteAllText": true,
                                    "fileExtension": ".txt"
                                }
                            },
                            "enableStaging": false,
                            "translator": {
                                "type": "TabularTranslator",
                                "mappings": [
                                    {
                                        "source": {
                                            "name": "msdyn_rolename",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "msdyn_rolename",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "statecode",
                                            "type": "Int32"
                                        },
                                        "sink": {
                                            "name": "statecode",
                                            "type": "Int32"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "msdyn_decisionmakingroleid",
                                            "type": "Guid"
                                        },
                                        "sink": {
                                            "name": "msdyn_decisionmakingroleid",
                                            "type": "Guid"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "msdyn_company",
                                            "type": "Guid"
                                        },
                                        "sink": {
                                            "name": "msdyn_company",
                                            "type": "Guid"
                                        }
                                    }
                                ]
                            }
                        },
                        "inputs": [
                            {
                                "referenceName": "DynamicsCrmConnection",
                                "type": "DatasetReference",
                                "parameters": {
                                    "entityname": "msdyn_decisionmakingrole"
                                }
                            }
                        ],
                        "outputs": [
                            {
                                "referenceName": "DelimitedTextFiles",
                                "type": "DatasetReference",
                                "parameters": {
                                    "filename": "CDSDecisionMakingRole.csv",
                                    "foldername": "input",
                                    "container": "partybootstrapping"
                                }
                            }
                        ]
                    },
                    {
                        "name": "16-7-Retrieve worker from Datavers",
                        "description": "Retrieve worker from Dataverse",
                        "type": "Copy",
                        "dependsOn": [],
                        "policy": {
                            "timeout": "7.00:00:00",
                            "retry": 0,
                            "retryIntervalInSeconds": 30,
                            "secureOutput": false,
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "source": {
                                "type": "DynamicsCrmSource",
                                "query": "<fetch version=\"1.0\" output-format=\"xml-platform\" mapping=\"logical\" distinct=\"true\">\n  <entity name=\"cdm_worker\" >\n    <attribute name=\"cdm_workernumber\" />\n    <attribute name=\"statecode\" />\n    <attribute name=\"cdm_workerid\" />\n  </entity>\n</fetch>"
                            },
                            "sink": {
                                "type": "DelimitedTextSink",
                                "storeSettings": {
                                    "type": "AzureBlobStorageWriteSettings"
                                },
                                "formatSettings": {
                                    "type": "DelimitedTextWriteSettings",
                                    "quoteAllText": true,
                                    "fileExtension": ".txt"
                                }
                            },
                            "enableStaging": false,
                            "translator": {
                                "type": "TabularTranslator",
                                "mappings": [
                                    {
                                        "source": {
                                            "name": "cdm_workernumber",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "cdm_workernumber",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "statecode",
                                            "type": "Int32"
                                        },
                                        "sink": {
                                            "name": "statecode",
                                            "type": "Int32"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "cdm_workerid",
                                            "type": "Guid"
                                        },
                                        "sink": {
                                            "name": "cdm_workerid",
                                            "type": "Guid"
                                        }
                                    }
                                ]
                            }
                        },
                        "inputs": [
                            {
                                "referenceName": "DynamicsCrmConnection",
                                "type": "DatasetReference",
                                "parameters": {
                                    "entityname": "cdm_worker"
                                }
                            }
                        ],
                        "outputs": [
                            {
                                "referenceName": "DelimitedTextFiles",
                                "type": "DatasetReference",
                                "parameters": {
                                    "filename": "CDSWorker.csv",
                                    "foldername": "input",
                                    "container": "partybootstrapping"
                                }
                            }
                        ]
                    }
                ],
                "policy": {
                    "elapsedTimeMetric": {},
                    "cancelAfter": {}
                },
                "variables": {
                    "CompanyName": {
                        "type": "String"
                    },
                    "filter": {
                        "type": "String"
                    },
                    "Companies": {
                        "type": "Array"
                    }
                },
                "annotations": [],
                "lastPublishTime": "2021-03-24T03:04:53Z"
            },
            "dependsOn": [
                "[concat(variables('factoryId'), '/datasets/FOConnection')]",
                "[concat(variables('factoryId'), '/datasets/DelimitedTextFiles')]",
                "[concat(variables('factoryId'), '/datasets/DynamicsCrmConnection')]",
                "[concat(variables('factoryId'), '/dataflows/DataSanityFlowCheck')]",
                "[concat(variables('factoryId'), '/datasets/DelimitedTextSink')]",
                "[concat(variables('factoryId'), '/dataflows/PartyDataStagging')]",
                "[concat(variables('factoryId'), '/dataflows/LinkParty')]",
                "[concat(variables('factoryId'), '/dataflows/ContactForParty')]",
                "[concat(variables('factoryId'), '/dataflows/DWCompanies')]",
                "[concat(variables('factoryId'), '/dataflows/MergeContactForPartyAccountVendor')]",
                "[concat(variables('factoryId'), '/dataflows/PrepareContactForPartyVendor')]",
                "[concat(variables('factoryId'), '/dataflows/PrepareContactForPartyCustomerContact')]",
                "[concat(variables('factoryId'), '/linkedServices/AzureBlobStorage')]"
            ]
        },
        {
            "name": "[concat(parameters('factoryName'), '/DataSanityFlowCheck')]",
            "type": "Microsoft.DataFactory/factories/dataflows",
            "apiVersion": "2018-06-01",
            "properties": {
                "type": "MappingDataFlow",
                "typeProperties": {
                    "sources": [
                        {
                            "dataset": {
                                "referenceName": "DelimitedTextFiles",
                                "type": "DatasetReference"
                            },
                            "name": "FOCustomer"
                        },
                        {
                            "dataset": {
                                "referenceName": "DelimitedTextFiles",
                                "type": "DatasetReference"
                            },
                            "name": "CDSAccount"
                        },
                        {
                            "dataset": {
                                "referenceName": "DelimitedTextFiles",
                                "type": "DatasetReference"
                            },
                            "name": "FOVendor"
                        },
                        {
                            "dataset": {
                                "referenceName": "DelimitedTextFiles",
                                "type": "DatasetReference"
                            },
                            "name": "CDSVendor"
                        },
                        {
                            "dataset": {
                                "referenceName": "DelimitedTextFiles",
                                "type": "DatasetReference"
                            },
                            "name": "FOContact"
                        },
                        {
                            "dataset": {
                                "referenceName": "DelimitedTextFiles",
                                "type": "DatasetReference"
                            },
                            "name": "CDSContact"
                        }
                    ],
                    "sinks": [
                        {
                            "dataset": {
                                "referenceName": "DelimitedTextSink",
                                "type": "DatasetReference"
                            },
                            "name": "FOCDSCustomerPartyNumber"
                        },
                        {
                            "dataset": {
                                "referenceName": "DelimitedTextSink",
                                "type": "DatasetReference"
                            },
                            "name": "FOCDSVendorPartyNumber"
                        },
                        {
                            "dataset": {
                                "referenceName": "DelimitedTextSink",
                                "type": "DatasetReference"
                            },
                            "name": "FOCDSContactPartyNumber"
                        }
                    ],
                    "transformations": [
                        {
                            "name": "FOCDSCustomer"
                        },
                        {
                            "name": "FOCDSVendor"
                        },
                        {
                            "name": "FOCDSContact"
                        }
                    ],
                    "script": "source(output(\n\t\tdataAreaId as string,\n\t\tCustomerAccount as string,\n\t\tPartyNumber as string\n\t),\n\tallowSchemaDrift: true,\n\tvalidateSchema: false,\n\tignoreNoFilesFound: false) ~> FOCustomer\nsource(output(\n\t\tmsdyn_company as string,\n\t\taccountid as string,\n\t\t{cdm_company1.cdm_companycode} as string,\n\t\taccountnumber as string,\n\t\tmsdyn_partynumber as string,\n\t\tname as string,\n\t\tmsdyn_vendorcreatedbyworkflow as boolean,\n\t\tnumberofemployees as boolean\n\t),\n\tallowSchemaDrift: true,\n\tvalidateSchema: false,\n\tignoreNoFilesFound: false) ~> CDSAccount\nsource(output(\n\t\tdataAreaId as string,\n\t\tVendorAccountNumber as string,\n\t\tVendorPartyNumber as string\n\t),\n\tallowSchemaDrift: true,\n\tvalidateSchema: false,\n\tignoreNoFilesFound: false) ~> FOVendor\nsource(output(\n\t\tmsdyn_company as string,\n\t\tmsdyn_vendoraccountnumber as string,\n\t\tmsdyn_language as integer,\n\t\tmsdyn_name as string,\n\t\tmsdyn_currencycode as string,\n\t\tmsdyn_numberofemployees as boolean,\n\t\t{cdm_company1.cdm_companycode} as string,\n\t\tmsdyn_isperson as boolean,\n\t\tmsdyn_vendorpersoncreatedbyworkflow as boolean,\n\t\tmsdyn_vendorid as string,\n\t\tmsdyn_vendorpartynumber as string,\n\t\tmsdyn_vendorcreatedbyworkflow as boolean\n\t),\n\tallowSchemaDrift: true,\n\tvalidateSchema: false,\n\tignoreNoFilesFound: false) ~> CDSVendor\nsource(output(\n\t\tdataAreaId as string,\n\t\tContactPersonId as string,\n\t\tEmploymentOfficeLocation as string,\n\t\tPrimarySalutationPhrase as string,\n\t\tSpouseName as string,\n\t\tIsVIP as boolean,\n\t\tOrganizationIdentificationNumber as string,\n\t\tAssistantPhoneNumber as string,\n\t\tNotes as string,\n\t\tAvailableToTime as integer,\n\t\tIsReceivingDirectMail as boolean,\n\t\tEmploymentJobFunctionName as string,\n\t\tGovernmentIdentificationNumber as string,\n\t\tEmploymentDepartment as string,\n\t\tMileageDistance as string,\n\t\tContactPersonResponsiblePersonnelNumber as short,\n\t\tMicrosoftOutlookCategories as string,\n\t\tAssociatedPartyNumber as integer,\n\t\tAvailableFromTime as boolean,\n\t\tEmploymentComputerNetworkName as string,\n\t\tLoyaltyLevelPhrase as string,\n\t\tEmploymentJobTitle as string,\n\t\tContactActivitySensitivityLevel as string,\n\t\tHasRequestedInternetAccess as boolean,\n\t\tManagerContactPersonId as string,\n\t\tIdentityCardNumber as string,\n\t\tAssistantName as string,\n\t\tContactPersonPartyNumber as string,\n\t\tEmploymentProfession as string,\n\t\tPrimaryComplimentaryClosingPhrase as string,\n\t\tPersonalCharacterTypeCode as string,\n\t\tDecisionMakingRoleCode as string\n\t),\n\tallowSchemaDrift: true,\n\tvalidateSchema: false,\n\tignoreNoFilesFound: false) ~> FOContact\nsource(output(\n\t\tcontactid as string,\n\t\tmsdyn_language as integer,\n\t\tmsdyn_company as string,\n\t\tmsdyn_isvendor as boolean,\n\t\tmsdyn_sellable as boolean,\n\t\t{cdm_company1.cdm_companycode} as string,\n\t\tmsdyn_partynumber as string,\n\t\tfirstname as string,\n\t\tmsdyn_contactforvendor as boolean,\n\t\tlastname as string,\n\t\tmsdyn_contactpersonid as string\n\t),\n\tallowSchemaDrift: true,\n\tvalidateSchema: false,\n\tignoreNoFilesFound: false) ~> CDSContact\nFOCustomer, CDSAccount join(dataAreaId == {cdm_company1.cdm_companycode}\n\t&& CustomerAccount == accountnumber\n\t&& PartyNumber != msdyn_partynumber,\n\tjoinType:'inner',\n\tbroadcast: 'left')~> FOCDSCustomer\nFOVendor, CDSVendor join(dataAreaId == {cdm_company1.cdm_companycode}\n\t&& VendorAccountNumber == msdyn_vendoraccountnumber\n\t&& VendorPartyNumber != msdyn_vendorpartynumber,\n\tjoinType:'inner',\n\tbroadcast: 'left')~> FOCDSVendor\nFOContact, CDSContact join(dataAreaId == {cdm_company1.cdm_companycode}\n\t&& ContactPersonId == msdyn_contactpersonid\n\t&& ContactPersonPartyNumber != msdyn_partynumber,\n\tjoinType:'inner',\n\tbroadcast: 'left')~> FOCDSContact\nFOCDSCustomer sink(allowSchemaDrift: true,\n\tvalidateSchema: false,\n\tpartitionFileNames:['FOCDSCustomerPartyNumber.csv'],\n\tpartitionBy('hash', 1),\n\tskipDuplicateMapInputs: true,\n\tskipDuplicateMapOutputs: true) ~> FOCDSCustomerPartyNumber\nFOCDSVendor sink(allowSchemaDrift: true,\n\tvalidateSchema: false,\n\tpartitionFileNames:['FOCDSVendorPartyNumber.csv'],\n\tpartitionBy('hash', 1),\n\tskipDuplicateMapInputs: true,\n\tskipDuplicateMapOutputs: true) ~> FOCDSVendorPartyNumber\nFOCDSContact sink(allowSchemaDrift: true,\n\tvalidateSchema: false,\n\tpartitionFileNames:['FOCDSVendorPartyNumber.csv'],\n\tpartitionBy('hash', 1),\n\tskipDuplicateMapInputs: true,\n\tskipDuplicateMapOutputs: true) ~> FOCDSContactPartyNumber"
                }
            },
            "dependsOn": [
                "[concat(variables('factoryId'), '/datasets/DelimitedTextFiles')]",
                "[concat(variables('factoryId'), '/datasets/DelimitedTextSink')]"
            ]
        },
        {
            "name": "[concat(parameters('factoryName'), '/PartyDataStagging')]",
            "type": "Microsoft.DataFactory/factories/dataflows",
            "apiVersion": "2018-06-01",
            "properties": {
                "description": "Merge party data from FO and CDS systems.",
                "type": "MappingDataFlow",
                "typeProperties": {
                    "sources": [
                        {
                            "dataset": {
                                "referenceName": "DelimitedTextFiles",
                                "type": "DatasetReference"
                            },
                            "name": "FOAllCustomer"
                        },
                        {
                            "dataset": {
                                "referenceName": "DelimitedTextFiles",
                                "type": "DatasetReference"
                            },
                            "name": "CDSAllAccount"
                        },
                        {
                            "dataset": {
                                "referenceName": "DelimitedTextFiles",
                                "type": "DatasetReference"
                            },
                            "name": "FOParty"
                        },
                        {
                            "dataset": {
                                "referenceName": "DelimitedTextFiles",
                                "type": "DatasetReference"
                            },
                            "name": "CDSOptionset"
                        },
                        {
                            "dataset": {
                                "referenceName": "DelimitedTextFiles",
                                "type": "DatasetReference"
                            },
                            "name": "CDSAllContact"
                        },
                        {
                            "dataset": {
                                "referenceName": "DelimitedTextFiles",
                                "type": "DatasetReference"
                            },
                            "name": "FOAllContact"
                        },
                        {
                            "dataset": {
                                "referenceName": "DelimitedTextFiles",
                                "type": "DatasetReference"
                            },
                            "name": "FOAllVendor"
                        },
                        {
                            "dataset": {
                                "referenceName": "DelimitedTextFiles",
                                "type": "DatasetReference"
                            },
                            "name": "CDSAllVendor"
                        },
                        {
                            "dataset": {
                                "referenceName": "DelimitedTextFiles",
                                "type": "DatasetReference"
                            },
                            "name": "FONewParty"
                        }
                    ],
                    "sinks": [
                        {
                            "dataset": {
                                "referenceName": "DelimitedTextOutput",
                                "type": "DatasetReference"
                            },
                            "name": "FOCDSParty"
                        },
                        {
                            "dataset": {
                                "referenceName": "DelimitedTextOutput",
                                "type": "DatasetReference"
                            },
                            "name": "FONewPartyFile"
                        }
                    ],
                    "transformations": [
                        {
                            "name": "CDSAccountNotExistsInFO"
                        },
                        {
                            "name": "AccountRuleToCreateParty"
                        },
                        {
                            "name": "CDSAccountWithoutVendor"
                        },
                        {
                            "name": "CDSAccountParty"
                        },
                        {
                            "name": "CDSAccountLanguageLookup"
                        },
                        {
                            "name": "CDSNewAccount"
                        },
                        {
                            "name": "CDSContactCustomer"
                        },
                        {
                            "name": "CDSContactCustomerNotExistsInFO"
                        },
                        {
                            "name": "ContactCustomerRuleToCreateParty"
                        },
                        {
                            "name": "ContactCustomerLanguageLookup"
                        },
                        {
                            "name": "CDSNewContactCustomer"
                        },
                        {
                            "name": "CDSContactCustomerParty"
                        },
                        {
                            "name": "CDSContactPerson"
                        },
                        {
                            "name": "ContactPersonNotExistsInFO"
                        },
                        {
                            "name": "ContactPersonRuleToCreateParty"
                        },
                        {
                            "name": "ContactPersonLanguageLookup"
                        },
                        {
                            "name": "CDSNewContactPerson"
                        },
                        {
                            "name": "CDSContactParty"
                        },
                        {
                            "name": "CDSVendorNotExistsInFO"
                        },
                        {
                            "name": "VendorRuleToCreateParty"
                        },
                        {
                            "name": "VendorLanguageLookup"
                        },
                        {
                            "name": "CDSNewVendor"
                        },
                        {
                            "name": "CDSVendorParty"
                        },
                        {
                            "name": "NewCDSAccountParty"
                        },
                        {
                            "name": "NewCDSContactCustomerParty"
                        },
                        {
                            "name": "NewCDSVendorParty"
                        },
                        {
                            "name": "CDSAccountWithPartyNumber"
                        },
                        {
                            "name": "CDSContactPersonWithPartyNumber"
                        },
                        {
                            "name": "CDSContactCustomerWithPartyNumber"
                        },
                        {
                            "name": "CDSVendorWithPartyNumber"
                        },
                        {
                            "name": "NewCDSContactPersonParty"
                        },
                        {
                            "name": "PartyLanguageJoin"
                        },
                        {
                            "name": "PartyLanguageId"
                        },
                        {
                            "name": "AccountPartyType"
                        },
                        {
                            "name": "ContactPersonPartyType"
                        },
                        {
                            "name": "ContactCustomerPartyType"
                        },
                        {
                            "name": "VendorPartyType"
                        },
                        {
                            "name": "SplitLanguagePartyType"
                        },
                        {
                            "name": "CDSPartyType"
                        },
                        {
                            "name": "CDSLanguage"
                        },
                        {
                            "name": "PartyTypeJoin"
                        },
                        {
                            "name": "FOCDSPartyType"
                        },
                        {
                            "name": "Enum"
                        },
                        {
                            "name": "EnumMap"
                        }
                    ],
                    "script": "source(output(\n\t\tdataAreaId as string,\n\t\tCustomerAccount as string,\n\t\tPartyNumber as string\n\t),\n\tallowSchemaDrift: true,\n\tvalidateSchema: false,\n\tignoreNoFilesFound: false) ~> FOAllCustomer\nsource(output(\n\t\tmsdyn_company as string,\n\t\taccountid as string,\n\t\t{cdm_company1.cdm_companycode} as string,\n\t\tmsdyn_language as integer,\n\t\taccountnumber as string,\n\t\tname as string,\n\t\tmsdyn_vendorcreatedbyworkflow as boolean,\n\t\tmsdyn_partynumber as string,\n\t\tmsdyn_organizationnumber as string,\n\t\tcustomertypecode as short,\n\t\tnumberofemployees as string,\n\t\tmsdyn_namealias as string,\n\t\tmsdyn_organizationphoneticname as string,\n\t\tmsdyn_organizationabccode as integer,\n\t\tmsdyn_mappedvendoraccount as string\n\t),\n\tallowSchemaDrift: true,\n\tvalidateSchema: false,\n\tignoreNoFilesFound: false) ~> CDSAllAccount\nsource(output(\n\t\tPartyNumber as string,\n\t\tAddressBooks as string,\n\t\tPersonAnniversaryDay as string,\n\t\tPersonInitials as string,\n\t\tOrganizationName as string,\n\t\tPersonPhoneticFirstName as string,\n\t\tPersonPersonalTitle as string,\n\t\tPersonChildrenNames as string,\n\t\tPersonBirthDay as string,\n\t\tPersonHobbies as string,\n\t\tPersonProfessionalSuffix as string,\n\t\tPersonLastName as string,\n\t\tPersonPhoneticMiddleName as string,\n\t\tNameAlias as string,\n\t\tPartyType as string,\n\t\tLanguageId as string,\n\t\tKnownAs as string,\n\t\tOrganizationPhoneticName as string,\n\t\tPersonAnniversaryYear as string,\n\t\tOrganizationNumber as string,\n\t\tPersonFirstName as string,\n\t\tPersonMiddleName as string,\n\t\tPersonLastNamePrefix as string,\n\t\tPersonPersonalSuffix as string,\n\t\tOrganizationNumOfEmployees as string,\n\t\tPersonBirthYear as string,\n\t\tPersonPhoneticLastName as string,\n\t\tPersonProfessionalTitle as string,\n\t\tOrganizationABCCode as string,\n\t\tPersonBirthMonth as string,\n\t\tPersonAnniversaryMonth as string,\n\t\tPersonGender as string,\n\t\tPersonMaritalStatus as string\n\t),\n\tallowSchemaDrift: true,\n\tvalidateSchema: false,\n\tignoreNoFilesFound: false) ~> FOParty\nsource(output(\n\t\tattributevalue as integer,\n\t\tvalue as string,\n\t\tattributename as string,\n\t\tstringmapid as string\n\t),\n\tallowSchemaDrift: true,\n\tvalidateSchema: false,\n\tignoreNoFilesFound: false) ~> CDSOptionset\nsource(output(\n\t\tcontactid as string,\n\t\tmsdyn_language as integer,\n\t\tmsdyn_company as string,\n\t\tmsdyn_isvendor as boolean,\n\t\tmsdyn_sellable as boolean,\n\t\t{cdm_company1.cdm_companycode} as string,\n\t\tmsdyn_partynumber as string,\n\t\tfirstname as string,\n\t\tmsdyn_contactforvendor as boolean,\n\t\tlastname as string,\n\t\tmsdyn_contactpersonid as string,\n\t\tmsdyn_birthmonth as string,\n\t\tmsdyn_anniversarymonth as string,\n\t\tmsdyn_birthyear as string,\n\t\tmsdyn_anniversaryyear as string,\n\t\tmsdyn_phoneticlastname as string,\n\t\tmsdyn_namealias as string,\n\t\tmsdyn_anniversaryday as string,\n\t\tsuffix as string,\n\t\tmsdyn_birthday as string,\n\t\tfamilystatuscode as string,\n\t\tnickname as string,\n\t\tjobtitle as string,\n\t\tmsdyn_linkedvendoraccount as string,\n\t\tmsdyn_lastnameprefix as string,\n\t\tmsdyn_phoneticfirstname as string,\n\t\tmsdyn_phoneticmiddlename as string\n\t),\n\tallowSchemaDrift: true,\n\tvalidateSchema: false,\n\tignoreNoFilesFound: false) ~> CDSAllContact\nsource(output(\n\t\tdataAreaId as string,\n\t\tContactPersonId as string,\n\t\tEmploymentOfficeLocation as string,\n\t\tPrimarySalutationPhrase as string,\n\t\tSpouseName as string,\n\t\tIsVIP as boolean,\n\t\tOrganizationIdentificationNumber as string,\n\t\tAssistantPhoneNumber as string,\n\t\tNotes as string,\n\t\tAvailableToTime as integer,\n\t\tIsReceivingDirectMail as boolean,\n\t\tEmploymentJobFunctionName as string,\n\t\tGovernmentIdentificationNumber as string,\n\t\tEmploymentDepartment as string,\n\t\tMileageDistance as string,\n\t\tContactPersonResponsiblePersonnelNumber as short,\n\t\tMicrosoftOutlookCategories as string,\n\t\tAssociatedPartyNumber as integer,\n\t\tAvailableFromTime as boolean,\n\t\tEmploymentComputerNetworkName as string,\n\t\tLoyaltyLevelPhrase as string,\n\t\tEmploymentJobTitle as string,\n\t\tContactActivitySensitivityLevel as string,\n\t\tHasRequestedInternetAccess as boolean,\n\t\tManagerContactPersonId as string,\n\t\tIdentityCardNumber as string,\n\t\tAssistantName as string,\n\t\tContactPersonPartyNumber as string,\n\t\tEmploymentProfession as string,\n\t\tPrimaryComplimentaryClosingPhrase as string,\n\t\tPersonalCharacterTypeCode as string,\n\t\tDecisionMakingRoleCode as string\n\t),\n\tallowSchemaDrift: true,\n\tvalidateSchema: false,\n\tignoreNoFilesFound: false) ~> FOAllContact\nsource(output(\n\t\tdataAreaId as string,\n\t\tVendorAccountNumber as string,\n\t\tVendorPartyNumber as string\n\t),\n\tallowSchemaDrift: true,\n\tvalidateSchema: false,\n\tignoreNoFilesFound: false) ~> FOAllVendor\nsource(output(\n\t\tmsdyn_company as string,\n\t\tmsdyn_vendoraccountnumber as string,\n\t\tmsdyn_language as integer,\n\t\tmsdyn_name as string,\n\t\tmsdyn_currencycode as string,\n\t\tmsdyn_numberofemployees as short,\n\t\tmsdyn_vendorid as string,\n\t\t{cdm_company1.cdm_companycode} as string,\n\t\tmsdyn_isperson as boolean,\n\t\tmsdyn_namealias as string,\n\t\tmsdyn_vendorpersoncreatedbyworkflow as boolean,\n\t\tmsdyn_vendorpartynumber as string,\n\t\tmsdyn_organizationnumber as string,\n\t\tmsdyn_vendorknownasname as string,\n\t\tmsdyn_linkedvendorinaccountsentity as string,\n\t\tmsdyn_hobbies as string,\n\t\tmsdyn_middlename as string,\n\t\tmsdyn_professionalsuffix as string,\n\t\tmsdyn_initials as string,\n\t\tmsdyn_lastnameprefix as string,\n\t\tmsdyn_personanniversaryday as string,\n\t\tmsdyn_phoneticmiddlename as string,\n\t\tmsdyn_childrennames as string,\n\t\tmsdyn_birthday as string,\n\t\tmsdyn_professionatitle as string,\n\t\tmsdyn_gendercode as string,\n\t\tmsdyn_birthyear as string,\n\t\tmsdyn_anniversarymonth as string,\n\t\tmsdyn_anniversaryyear as string,\n\t\tmsdyn_phoneticfirstname as string,\n\t\tmsdyn_phoneticlastname as string,\n\t\tmsdyn_maritalstatuscode as string,\n\t\tmsdyn_firstname as string,\n\t\tmsdyn_birthmonth as string,\n\t\tmsdyn_lastname as string\n\t),\n\tallowSchemaDrift: true,\n\tvalidateSchema: false,\n\tignoreNoFilesFound: false) ~> CDSAllVendor\nsource(output(\n\t\tPartyNumber as string,\n\t\tAddressBooks as string,\n\t\tPersonAnniversaryDay as string,\n\t\tPersonInitials as string,\n\t\tOrganizationName as string,\n\t\tPersonPhoneticFirstName as string,\n\t\tPersonPersonalTitle as string,\n\t\tPersonChildrenNames as string,\n\t\tPersonBirthDay as string,\n\t\tPersonHobbies as string,\n\t\tPersonProfessionalSuffix as string,\n\t\tPersonLastName as string,\n\t\tPersonPhoneticMiddleName as string,\n\t\tNameAlias as string,\n\t\tPartyType as string,\n\t\tLanguageId as string,\n\t\tKnownAs as string,\n\t\tOrganizationPhoneticName as string,\n\t\tPersonAnniversaryYear as string,\n\t\tOrganizationNumber as string,\n\t\tPersonFirstName as string,\n\t\tPersonMiddleName as string,\n\t\tPersonLastNamePrefix as string,\n\t\tPersonPersonalSuffix as string,\n\t\tOrganizationNumOfEmployees as string,\n\t\tPersonBirthYear as string,\n\t\tPersonPhoneticLastName as string,\n\t\tPersonProfessionalTitle as string,\n\t\tOrganizationABCCode as integer,\n\t\tPersonBirthMonth as integer,\n\t\tPersonAnniversaryMonth as integer,\n\t\tPersonGender as integer,\n\t\tPersonMaritalStatus as integer\n\t),\n\tallowSchemaDrift: true,\n\tvalidateSchema: false,\n\tignoreNoFilesFound: false) ~> FONewParty\nCDSAccountWithoutVendor, FOAllCustomer exists(lower({cdm_company1.cdm_companycode}) == lower(dataAreaId)\n\t&& lower(accountnumber) == lower(CustomerAccount),\n\tnegate:true,\n\tbroadcast: 'auto')~> CDSAccountNotExistsInFO\nCDSAccountWithPartyNumber select(mapColumn(\n\t\tmsdyn_msdyn_party_account_partyid = accountid,\n\t\tLanguageId = msdyn_language,\n\t\tOrganizationName = name,\n\t\tPartyNumber = msdyn_partynumber,\n\t\tOrganizationNumOfEmployees = numberofemployees,\n\t\tNameAlias = msdyn_namealias,\n\t\tOrganizationPhoneticName = msdyn_organizationphoneticname,\n\t\tmsdyn_organizationabccode,\n\t\tOrganizationNumber = msdyn_organizationnumber\n\t),\n\tskipDuplicateMapInputs: true,\n\tskipDuplicateMapOutputs: true) ~> AccountRuleToCreateParty\nCDSAllAccount filter(notEquals(customertypecode,11) || isNull(customertypecode)) ~> CDSAccountWithoutVendor\nFOParty, CDSNewAccount union(byName: true,\n\tpartitionBy('hash', 1))~> CDSAccountParty\nAccountRuleToCreateParty, CDSLanguage lookup(LanguageId == id,\n\tmultiple: false,\n\tpickup: 'any',\n\tbroadcast: 'auto')~> CDSAccountLanguageLookup\nAccountPartyType select(mapColumn(\n\t\tOrganizationName,\n\t\tPartyNumber,\n\t\tOrganizationNumOfEmployees,\n\t\tNameAlias,\n\t\tOrganizationPhoneticName,\n\t\tOrganizationNumber,\n\t\tLanguageId = code,\n\t\tPartyType\n\t),\n\tskipDuplicateMapInputs: true,\n\tskipDuplicateMapOutputs: true) ~> CDSNewAccount\nCDSAllContact filter(msdyn_sellable,\n\tpartitionBy('hash', 1)) ~> CDSContactCustomer\nCDSContactCustomer, FOAllCustomer exists(lower({cdm_company1.cdm_companycode}) == lower(dataAreaId)\n\t&& lower(msdyn_contactpersonid) == lower(CustomerAccount),\n\tnegate:true,\n\tbroadcast: 'auto')~> CDSContactCustomerNotExistsInFO\nCDSContactCustomerWithPartyNumber select(mapColumn(\n\t\tLanguageId = msdyn_language,\n\t\tPartyNumber = msdyn_partynumber,\n\t\tPersonFirstName = firstname,\n\t\tPersonPhoneticFirstName = msdyn_phoneticfirstname,\n\t\tPersonLastName = lastname,\n\t\tmsdyn_anniversarymonth,\n\t\tmsdyn_birthyear,\n\t\tPersonAnniversaryYear = msdyn_anniversaryyear,\n\t\tNameAlias = msdyn_namealias,\n\t\tPersonAnniversaryDay = msdyn_anniversaryday,\n\t\tPersonBirthDay = msdyn_birthday,\n\t\tPersonPhoneticLastName = msdyn_phoneticlastname,\n\t\tmsdyn_lastnameprefix,\n\t\tPersonPhoneticMiddleName = msdyn_phoneticmiddlename,\n\t\tPartyNumber = msdyn_partynumber\n\t),\n\tskipDuplicateMapInputs: true,\n\tskipDuplicateMapOutputs: true) ~> ContactCustomerRuleToCreateParty\nContactCustomerRuleToCreateParty, CDSLanguage lookup(LanguageId == id,\n\tmultiple: false,\n\tpickup: 'any',\n\tbroadcast: 'auto')~> ContactCustomerLanguageLookup\nContactCustomerPartyType select(mapColumn(\n\t\tPersonFirstName,\n\t\tPersonPhoneticFirstName,\n\t\tPersonLastName,\n\t\tPersonAnniversaryYear,\n\t\tNameAlias,\n\t\tPersonAnniversaryDay,\n\t\tPersonBirthDay,\n\t\tPersonPhoneticLastName,\n\t\tPersonLastNamePrefix = msdyn_lastnameprefix,\n\t\tPersonPhoneticMiddleName,\n\t\tLanguageId = code,\n\t\tPartyNumber\n\t),\n\tskipDuplicateMapInputs: true,\n\tskipDuplicateMapOutputs: true) ~> CDSNewContactCustomer\nCDSAccountParty, CDSNewContactCustomer union(byName: true)~> CDSContactCustomerParty\nCDSAllContact filter(!msdyn_sellable && !msdyn_isvendor) ~> CDSContactPerson\nCDSContactPerson, FOAllContact exists(lower({cdm_company1.cdm_companycode}) == lower(dataAreaId)\n\t&& lower(msdyn_contactpersonid) == lower(ContactPersonId),\n\tnegate:true,\n\tbroadcast: 'auto')~> ContactPersonNotExistsInFO\nCDSContactPersonWithPartyNumber select(mapColumn(\n\t\tmsdyn_msdyn_party_contact_partyid = contactid,\n\t\tPersonFirstName = firstname,\n\t\tPersonLastName = lastname,\n\t\tmsdyn_birthmonth,\n\t\tmsdyn_anniversarymonth,\n\t\tPersonBirthYear = msdyn_birthyear,\n\t\tPersonAnniversaryYear = msdyn_anniversaryyear,\n\t\tPersonPhoneticLastName = msdyn_phoneticlastname,\n\t\tNameAlias = msdyn_namealias,\n\t\tPersonAnniversaryDay = msdyn_anniversaryday,\n\t\tPersonBirthDay = msdyn_birthday,\n\t\tnickname,\n\t\tPersonPersonalTitle = jobtitle,\n\t\tPersonLastNamePrefix = msdyn_lastnameprefix,\n\t\tPersonPhoneticFirstName = msdyn_phoneticfirstname,\n\t\tPersonPhoneticMiddleName = msdyn_phoneticmiddlename,\n\t\tPartyNumber = msdyn_partynumber,\n\t\tLanguageId = msdyn_language\n\t),\n\tskipDuplicateMapInputs: true,\n\tskipDuplicateMapOutputs: true) ~> ContactPersonRuleToCreateParty\nContactPersonRuleToCreateParty, CDSLanguage lookup(LanguageId == id,\n\tmultiple: false,\n\tpickup: 'any',\n\tbroadcast: 'auto')~> ContactPersonLanguageLookup\nContactPersonPartyType select(mapColumn(\n\t\tPersonFirstName,\n\t\tPersonLastName,\n\t\tPersonBirthYear,\n\t\tPersonAnniversaryYear,\n\t\tPersonPhoneticLastName,\n\t\tNameAlias,\n\t\tPersonAnniversaryDay,\n\t\tPersonBirthDay,\n\t\tPersonPersonalTitle,\n\t\tPersonLastNamePrefix,\n\t\tPersonPhoneticFirstName,\n\t\tPersonPhoneticMiddleName,\n\t\tPartyNumber,\n\t\tLanguageId = code,\n\t\tKnownAs = nickname,\n\t\tPartyType\n\t),\n\tskipDuplicateMapInputs: true,\n\tskipDuplicateMapOutputs: true) ~> CDSNewContactPerson\nCDSContactCustomerParty, CDSNewContactPerson union(byName: true)~> CDSContactParty\nCDSAllVendor, FOAllVendor exists(lower({cdm_company1.cdm_companycode}) == lower(dataAreaId)\n\t&& lower(msdyn_vendoraccountnumber) == lower(VendorAccountNumber),\n\tnegate:true,\n\tbroadcast: 'auto')~> CDSVendorNotExistsInFO\nCDSVendorWithPartyNumber select(mapColumn(\n\t\tLanguageId = msdyn_language,\n\t\tOrganizationName = msdyn_name,\n\t\tmsdyn_msdyn_party_msdyn_vendor_partyid = msdyn_vendorid,\n\t\tNameAlias = msdyn_namealias,\n\t\tPartyNumber = msdyn_vendorpartynumber,\n\t\tOrganizationNumber = msdyn_organizationnumber,\n\t\tKnownAs = msdyn_vendorknownasname,\n\t\tPersonHobbies = msdyn_hobbies,\n\t\tPersonMiddleName = msdyn_middlename,\n\t\tPersonProfessionalSuffix = msdyn_professionalsuffix,\n\t\tPersonInitials = msdyn_initials,\n\t\tPersonLastNamePrefix = msdyn_lastnameprefix,\n\t\tPersonAnniversaryDay = msdyn_personanniversaryday,\n\t\tPersonPhoneticMiddleName = msdyn_phoneticmiddlename,\n\t\tPersonChildrenNames = msdyn_childrennames,\n\t\tPersonBirthDay = msdyn_birthday,\n\t\tPersonProfessionalTitle = msdyn_professionatitle,\n\t\tPersonBirthYear = msdyn_birthyear,\n\t\tmsdyn_anniversarymonth,\n\t\tPersonAnniversaryYear = msdyn_anniversaryyear,\n\t\tPersonPhoneticFirstName = msdyn_phoneticfirstname,\n\t\tPersonPhoneticLastName = msdyn_phoneticlastname,\n\t\tPersonFirstName = msdyn_firstname,\n\t\tPersonLastName = msdyn_lastname,\n\t\tmsdyn_isperson\n\t),\n\tskipDuplicateMapInputs: true,\n\tskipDuplicateMapOutputs: true) ~> VendorRuleToCreateParty\nVendorRuleToCreateParty, CDSLanguage lookup(LanguageId == id,\n\tmultiple: false,\n\tpickup: 'any',\n\tbroadcast: 'auto')~> VendorLanguageLookup\nVendorPartyType select(mapColumn(\n\t\tOrganizationName,\n\t\tNameAlias,\n\t\tPartyNumber,\n\t\tOrganizationNumber,\n\t\tKnownAs,\n\t\tPersonHobbies,\n\t\tPersonMiddleName,\n\t\tPersonProfessionalSuffix,\n\t\tPersonInitials,\n\t\tPersonLastNamePrefix,\n\t\tPersonAnniversaryDay,\n\t\tPersonPhoneticMiddleName,\n\t\tPersonChildrenNames,\n\t\tPersonBirthDay,\n\t\tPersonProfessionalTitle,\n\t\tPersonBirthYear,\n\t\tPersonAnniversaryYear,\n\t\tPersonPhoneticFirstName,\n\t\tPersonPhoneticLastName,\n\t\tPersonFirstName,\n\t\tPersonLastName,\n\t\tLanguageId = code,\n\t\tPartyType\n\t),\n\tskipDuplicateMapInputs: true,\n\tskipDuplicateMapOutputs: true) ~> CDSNewVendor\nCDSContactParty, CDSNewVendor union(byName: true)~> CDSVendorParty\nFONewParty, CDSNewAccount union(byName: true)~> NewCDSAccountParty\nNewCDSAccountParty, CDSNewContactCustomer union(byName: true)~> NewCDSContactCustomerParty\nNewCDSContactPersonParty, CDSNewVendor union(byName: true)~> NewCDSVendorParty\nCDSAccountNotExistsInFO filter(!isNull(msdyn_partynumber)) ~> CDSAccountWithPartyNumber\nContactPersonNotExistsInFO filter(!isNull(msdyn_partynumber)) ~> CDSContactPersonWithPartyNumber\nCDSContactCustomerNotExistsInFO filter(!isNull(msdyn_partynumber)) ~> CDSContactCustomerWithPartyNumber\nCDSVendorNotExistsInFO filter(!isNull(msdyn_vendorpartynumber)) ~> CDSVendorWithPartyNumber\nNewCDSContactCustomerParty, CDSNewContactPerson union(byName: true)~> NewCDSContactPersonParty\nCDSVendorParty, CDSLanguage join(LanguageId == code,\n\tjoinType:'inner',\n\tbroadcast: 'auto')~> PartyLanguageJoin\nPartyLanguageJoin select(mapColumn(\n\t\tPartyNumber,\n\t\tAddressBooks,\n\t\tPersonAnniversaryDay,\n\t\tPersonInitials,\n\t\tOrganizationName,\n\t\tPersonPhoneticFirstName,\n\t\tPersonPersonalTitle,\n\t\tPersonChildrenNames,\n\t\tPersonBirthDay,\n\t\tPersonHobbies,\n\t\tPersonProfessionalSuffix,\n\t\tPersonLastName,\n\t\tPersonPhoneticMiddleName,\n\t\tNameAlias,\n\t\tPartyType,\n\t\tKnownAs,\n\t\tOrganizationPhoneticName,\n\t\tPersonAnniversaryYear,\n\t\tOrganizationNumber,\n\t\tPersonFirstName,\n\t\tPersonMiddleName,\n\t\tPersonLastNamePrefix,\n\t\tPersonPersonalSuffix,\n\t\tOrganizationNumOfEmployees,\n\t\tPersonBirthYear,\n\t\tPersonPhoneticLastName,\n\t\tPersonProfessionalTitle,\n\t\tLanguageId = id,\n\t\tOrganizationABCCode,\n\t\tPersonGender,\n\t\tPersonMaritalStatus,\n\t\tPersonBirthMonth,\n\t\tPersonAnniversaryMonth\n\t),\n\tskipDuplicateMapInputs: true,\n\tskipDuplicateMapOutputs: true) ~> PartyLanguageId\nCDSAccountLanguageLookup derive(PartyType = \"Organization\",\n\t\tNameAlias = iifNull(NameAlias, NameAlias, substring(OrganizationName, 1, 20))) ~> AccountPartyType\nContactPersonLanguageLookup derive(PartyType = \"Person\",\n\t\tNameAlias = iifNull(NameAlias, NameAlias, substring(PersonFirstName, 1, 20))) ~> ContactPersonPartyType\nContactCustomerLanguageLookup derive(PartyType = \"Organization\",\n\t\tNameAlias = iifNull(NameAlias, NameAlias, substring(PersonFirstName, 1, 20))) ~> ContactCustomerPartyType\nVendorLanguageLookup derive(PartyType = iif(msdyn_isperson,\"Person\",\"Organization\"),\n\t\tNameAlias = iif(msdyn_isperson, iifNull(NameAlias, NameAlias, substring(PersonFirstName, 1, 20)), iifNull(NameAlias, NameAlias, substring(OrganizationName, 1, 20)))) ~> VendorPartyType\nCDSOptionset split(attributename==\"msdyn_language\",\n\tdisjoint: false) ~> SplitLanguagePartyType@(CDSLanguageOption, CDSPartyTypeOption)\nSplitLanguagePartyType@CDSPartyTypeOption select(mapColumn(\n\t\tid = attributevalue,\n\t\tcode = value\n\t),\n\tskipDuplicateMapInputs: true,\n\tskipDuplicateMapOutputs: true) ~> CDSPartyType\nSplitLanguagePartyType@CDSLanguageOption select(mapColumn(\n\t\tid = attributevalue,\n\t\tcode = value\n\t),\n\tskipDuplicateMapInputs: true,\n\tskipDuplicateMapOutputs: true) ~> CDSLanguage\nPartyLanguageId, CDSPartyType join(PartyType == code,\n\tjoinType:'inner',\n\tbroadcast: 'auto')~> PartyTypeJoin\nPartyTypeJoin select(mapColumn(\n\t\tPartyNumber,\n\t\tAddressBooks,\n\t\tPersonAnniversaryDay,\n\t\tPersonInitials,\n\t\tOrganizationName,\n\t\tPersonPhoneticFirstName,\n\t\tPersonPersonalTitle,\n\t\tPersonChildrenNames,\n\t\tPersonBirthDay,\n\t\tPersonHobbies,\n\t\tPersonProfessionalSuffix,\n\t\tPersonLastName,\n\t\tPersonPhoneticMiddleName,\n\t\tNameAlias,\n\t\tKnownAs,\n\t\tOrganizationPhoneticName,\n\t\tPersonAnniversaryYear,\n\t\tOrganizationNumber,\n\t\tPersonFirstName,\n\t\tPersonMiddleName,\n\t\tPersonLastNamePrefix,\n\t\tPersonPersonalSuffix,\n\t\tOrganizationNumOfEmployees,\n\t\tPersonBirthYear,\n\t\tPersonPhoneticLastName,\n\t\tPersonProfessionalTitle,\n\t\tLanguageId,\n\t\tPartyType = id,\n\t\tOrganizationABCCode,\n\t\tPersonGender,\n\t\tPersonMaritalStatus,\n\t\tPersonBirthMonth,\n\t\tPersonAnniversaryMonth\n\t),\n\tskipDuplicateMapInputs: true,\n\tskipDuplicateMapOutputs: true) ~> FOCDSPartyType\nFOCDSPartyType derive(OrganizationABCCode = case(lower(OrganizationABCCode)=='a',192350000,\r\ncase(lower(OrganizationABCCode)=='b',192350001,\r\ncase(lower(OrganizationABCCode)=='c',192350002,\r\ncase(lower(OrganizationABCCode)=='none',192350003\r\n)))),\n\t\tPersonGender = case(lower(PersonGender)=='male',1,\r\ncase(lower(PersonGender)=='female',2,\r\ncase(lower(PersonGender)=='non-Specific',192350000,\r\ncase(lower(PersonGender)=='unknown',192350001\r\n)))),\n\t\tPersonMaritalStatus = case(lower(PersonMaritalStatus)=='single',1,\r\ncase(lower(PersonMaritalStatus)=='married',2,\r\ncase(lower(PersonMaritalStatus)=='divorced',3,\r\ncase(lower(PersonMaritalStatus)=='widowhood',4,\r\ncase(lower(PersonMaritalStatus)=='none',192350000\r\n))))),\n\t\tPersonBirthMonth = case(lower(PersonBirthMonth)=='none',0,\r\ncase(lower(PersonBirthMonth)=='january',1,\r\ncase(lower(PersonBirthMonth)=='february',2,\r\ncase(lower(PersonBirthMonth)=='march',3,\r\ncase(lower(PersonBirthMonth)=='april',4,\r\ncase(lower(PersonBirthMonth)=='may',5,\r\ncase(lower(PersonBirthMonth)=='june',6,\r\ncase(lower(PersonBirthMonth)=='july',7,\r\ncase(lower(PersonBirthMonth)=='august',8,\r\ncase(lower(PersonBirthMonth)=='september',9,\r\ncase(lower(PersonBirthMonth)=='october',10,\r\ncase(lower(PersonBirthMonth)=='november',11,\r\ncase(lower(PersonBirthMonth)=='november',12\r\n))))))))))))),\n\t\tPersonAnniversaryMonth = case(lower(PersonAnniversaryMonth)=='none',0,\r\ncase(lower(PersonAnniversaryMonth)=='january',1,\r\ncase(lower(PersonAnniversaryMonth)=='february',2,\r\ncase(lower(PersonAnniversaryMonth)=='march',3,\r\ncase(lower(PersonAnniversaryMonth)=='april',4,\r\ncase(lower(PersonAnniversaryMonth)=='may',5,\r\ncase(lower(PersonAnniversaryMonth)=='june',6,\r\ncase(lower(PersonAnniversaryMonth)=='july',7,\r\ncase(lower(PersonAnniversaryMonth)=='august',8,\r\ncase(lower(PersonAnniversaryMonth)=='september',9,\r\ncase(lower(PersonAnniversaryMonth)=='october',10,\r\ncase(lower(PersonAnniversaryMonth)=='november',11,\r\ncase(lower(PersonAnniversaryMonth)=='november',12\r\n)))))))))))))) ~> Enum\nNewCDSVendorParty derive(OrganizationABCCode = case(OrganizationABCCode==192350000,'a',\r\ncase(OrganizationABCCode==192350001,'b',\r\ncase(OrganizationABCCode==192350002,'c',\r\ncase(OrganizationABCCode==192350003,'none'\r\n)))),\n\t\tPersonGender = case(PersonGender==1,'male',\r\ncase(PersonGender==2,'female',\r\ncase(PersonGender==192350000,'non-Specific',\r\ncase(PersonGender==192350001,'unknown'\r\n)))),\n\t\tPersonMaritalStatus = case(PersonMaritalStatus==1,'single',\r\ncase(PersonMaritalStatus==2,'married',\r\ncase(PersonMaritalStatus==3,'divorced',\r\ncase(PersonMaritalStatus==4,'widowhood',\r\ncase(PersonMaritalStatus==192350000,'none'\r\n))))),\n\t\tPersonBirthMonth = case(PersonBirthMonth==0,'none',\r\ncase(PersonBirthMonth==1,'january',\r\ncase(PersonBirthMonth==2,'february',\r\ncase(PersonBirthMonth==3,'march',\r\ncase(PersonBirthMonth==4, 'april',\r\ncase(PersonBirthMonth==5,'may',\r\ncase(PersonBirthMonth==6,'june',\r\ncase(PersonBirthMonth==7,'july',\r\ncase(PersonBirthMonth==8, 'august',\r\ncase(PersonBirthMonth==9,'september',\r\ncase(PersonBirthMonth==10, 'october',\r\ncase(PersonBirthMonth==11, 'november',\r\ncase(PersonBirthMonth==12,'december'\r\n))))))))))))),\n\t\tPersonAnniversaryMonth = case(PersonAnniversaryMonth==0,'none',\r\ncase(PersonAnniversaryMonth==1,'january',\r\ncase(PersonAnniversaryMonth==2,'february',\r\ncase(PersonAnniversaryMonth==3,'march',\r\ncase(PersonAnniversaryMonth==4, 'april',\r\ncase(PersonAnniversaryMonth==5,'may',\r\ncase(PersonAnniversaryMonth==6,'june',\r\ncase(PersonAnniversaryMonth==7,'july',\r\ncase(PersonAnniversaryMonth==8, 'august',\r\ncase(PersonAnniversaryMonth==9,'september',\r\ncase(PersonAnniversaryMonth==10, 'october',\r\ncase(PersonAnniversaryMonth==11, 'november',\r\ncase(PersonAnniversaryMonth==12,'december'\r\n)))))))))))))) ~> EnumMap\nEnum sink(input(\n\t\tColumn_1 as string,\n\t\tColumn_2 as string,\n\t\tColumn_3 as string,\n\t\tColumn_4 as string,\n\t\tColumn_5 as string,\n\t\tColumn_6 as string,\n\t\tColumn_7 as string,\n\t\tColumn_8 as string,\n\t\tColumn_9 as string,\n\t\tColumn_10 as string,\n\t\tColumn_11 as string,\n\t\tColumn_12 as string,\n\t\tColumn_13 as string,\n\t\tColumn_14 as string,\n\t\tColumn_15 as string,\n\t\tColumn_16 as string,\n\t\tColumn_17 as string,\n\t\tColumn_18 as string,\n\t\tColumn_19 as string,\n\t\tColumn_20 as string,\n\t\tColumn_21 as string,\n\t\tColumn_22 as string,\n\t\tColumn_23 as string,\n\t\tColumn_24 as string,\n\t\tColumn_25 as string,\n\t\tColumn_26 as string,\n\t\tColumn_27 as string,\n\t\tColumn_28 as string,\n\t\tColumn_29 as string,\n\t\tColumn_30 as string,\n\t\tColumn_31 as string\n\t),\n\tallowSchemaDrift: true,\n\tvalidateSchema: false,\n\tpartitionFileNames:['FOCDSParty.csv'],\n\tmapColumn(\n\t\tPartyNumber,\n\t\tAddressBooks,\n\t\tPersonAnniversaryDay,\n\t\tPersonInitials,\n\t\tOrganizationName,\n\t\tPersonPhoneticFirstName,\n\t\tPersonPersonalTitle,\n\t\tPersonChildrenNames,\n\t\tPersonBirthDay,\n\t\tPersonHobbies,\n\t\tPersonProfessionalSuffix,\n\t\tPersonLastName,\n\t\tPersonPhoneticMiddleName,\n\t\tNameAlias,\n\t\tPartyType,\n\t\tLanguageId,\n\t\tKnownAs,\n\t\tOrganizationPhoneticName,\n\t\tPersonAnniversaryYear,\n\t\tOrganizationNumber,\n\t\tPersonFirstName,\n\t\tPersonMiddleName,\n\t\tPersonLastNamePrefix,\n\t\tPersonPersonalSuffix,\n\t\tOrganizationNumOfEmployees,\n\t\tPersonBirthYear,\n\t\tPersonPhoneticLastName,\n\t\tPersonProfessionalTitle,\n\t\tPersonGender,\n\t\tPersonMaritalStatus,\n\t\tOrganizationABCCode,\n\t\tPersonAnniversaryMonth,\n\t\tPersonBirthMonth\n\t),\n\tpartitionBy('hash', 1),\n\tskipDuplicateMapInputs: true,\n\tskipDuplicateMapOutputs: true) ~> FOCDSParty\nEnumMap sink(input(\n\t\tColumn_1 as string,\n\t\tColumn_2 as string,\n\t\tColumn_3 as string,\n\t\tColumn_4 as string,\n\t\tColumn_5 as string,\n\t\tColumn_6 as string,\n\t\tColumn_7 as string,\n\t\tColumn_8 as string,\n\t\tColumn_9 as string,\n\t\tColumn_10 as string,\n\t\tColumn_11 as string,\n\t\tColumn_12 as string,\n\t\tColumn_13 as string,\n\t\tColumn_14 as string,\n\t\tColumn_15 as string,\n\t\tColumn_16 as string,\n\t\tColumn_17 as string,\n\t\tColumn_18 as string,\n\t\tColumn_19 as string,\n\t\tColumn_20 as string,\n\t\tColumn_21 as string,\n\t\tColumn_22 as string,\n\t\tColumn_23 as string,\n\t\tColumn_24 as string,\n\t\tColumn_25 as string,\n\t\tColumn_26 as string,\n\t\tColumn_27 as string,\n\t\tColumn_28 as string,\n\t\tColumn_29 as string,\n\t\tColumn_30 as string,\n\t\tColumn_31 as string\n\t),\n\tallowSchemaDrift: true,\n\tvalidateSchema: false,\n\tpartitionFileNames:['FONewParty.csv'],\n\tmapColumn(\n\t\tPartyNumber,\n\t\tAddressBooks,\n\t\tPersonAnniversaryDay,\n\t\tPersonInitials,\n\t\tOrganizationName,\n\t\tPersonPhoneticFirstName,\n\t\tPersonPersonalTitle,\n\t\tPersonChildrenNames,\n\t\tPersonBirthDay,\n\t\tPersonHobbies,\n\t\tPersonProfessionalSuffix,\n\t\tPersonLastName,\n\t\tPersonPhoneticMiddleName,\n\t\tNameAlias,\n\t\tPartyType,\n\t\tLanguageId,\n\t\tKnownAs,\n\t\tOrganizationPhoneticName,\n\t\tPersonAnniversaryYear,\n\t\tOrganizationNumber,\n\t\tPersonFirstName,\n\t\tPersonMiddleName,\n\t\tPersonLastNamePrefix,\n\t\tPersonPersonalSuffix,\n\t\tOrganizationNumOfEmployees,\n\t\tPersonBirthYear,\n\t\tPersonPhoneticLastName,\n\t\tPersonProfessionalTitle,\n\t\tOrganizationABCCode,\n\t\tPersonMaritalStatus,\n\t\tPersonGender,\n\t\tPersonBirthMonth,\n\t\tPersonAnniversaryMonth\n\t),\n\tpartitionBy('hash', 1),\n\tskipDuplicateMapInputs: true,\n\tskipDuplicateMapOutputs: true) ~> FONewPartyFile"
                }
            },
            "dependsOn": [
                "[concat(variables('factoryId'), '/datasets/DelimitedTextFiles')]",
                "[concat(variables('factoryId'), '/datasets/DelimitedTextOutput')]"
            ]
        },
        {
            "name": "[concat(parameters('factoryName'), '/LinkParty')]",
            "type": "Microsoft.DataFactory/factories/dataflows",
            "apiVersion": "2018-06-01",
            "properties": {
                "type": "MappingDataFlow",
                "typeProperties": {
                    "sources": [
                        {
                            "dataset": {
                                "referenceName": "DelimitedTextFiles",
                                "type": "DatasetReference"
                            },
                            "name": "CDSParty"
                        },
                        {
                            "dataset": {
                                "referenceName": "DelimitedTextFiles",
                                "type": "DatasetReference"
                            },
                            "name": "CDSAllAccount"
                        },
                        {
                            "dataset": {
                                "referenceName": "DelimitedTextFiles",
                                "type": "DatasetReference"
                            },
                            "name": "CDSAllContact"
                        },
                        {
                            "dataset": {
                                "referenceName": "DelimitedTextFiles",
                                "type": "DatasetReference"
                            },
                            "name": "CDSAllVendor"
                        }
                    ],
                    "sinks": [
                        {
                            "dataset": {
                                "referenceName": "DelimitedTextOutput",
                                "type": "DatasetReference"
                            },
                            "name": "AccountParty"
                        },
                        {
                            "dataset": {
                                "referenceName": "DelimitedTextOutput",
                                "type": "DatasetReference"
                            },
                            "name": "ContactParty"
                        },
                        {
                            "dataset": {
                                "referenceName": "DelimitedTextOutput",
                                "type": "DatasetReference"
                            },
                            "name": "VendorParty"
                        }
                    ],
                    "transformations": [
                        {
                            "name": "AccountPartyJoin"
                        },
                        {
                            "name": "AccountPartyId"
                        },
                        {
                            "name": "ContactPartyJoin"
                        },
                        {
                            "name": "ContactPartyId"
                        },
                        {
                            "name": "VendorPartyJoin"
                        },
                        {
                            "name": "VendorPartyId"
                        }
                    ],
                    "script": "source(output(\n\t\tmsdyn_partyid as string,\n\t\tmsdyn_partynumber as string,\n\t\tmsdyn_partytype as string\n\t),\n\tallowSchemaDrift: true,\n\tvalidateSchema: false,\n\tignoreNoFilesFound: false) ~> CDSParty\nsource(output(\n\t\tmsdyn_company as string,\n\t\taccountid as string,\n\t\t{cdm_company1.cdm_companycode} as string,\n\t\tmsdyn_language as integer,\n\t\taccountnumber as string,\n\t\tname as string,\n\t\tmsdyn_vendorcreatedbyworkflow as boolean,\n\t\tmsdyn_partynumber as string,\n\t\tmsdyn_organizationnumber as string,\n\t\tcustomertypecode as string,\n\t\tnumberofemployees as string,\n\t\tmsdyn_namealias as string,\n\t\tmsdyn_organizationphoneticname as string,\n\t\tmsdyn_organizationabccode as integer,\n\t\tmsdyn_mappedvendoraccount as string\n\t),\n\tallowSchemaDrift: true,\n\tvalidateSchema: false,\n\tignoreNoFilesFound: false) ~> CDSAllAccount\nsource(output(\n\t\tcontactid as string,\n\t\tmsdyn_language as integer,\n\t\tmsdyn_company as string,\n\t\tmsdyn_isvendor as boolean,\n\t\tmsdyn_sellable as boolean,\n\t\t{cdm_company1.cdm_companycode} as string,\n\t\tmsdyn_partynumber as string,\n\t\tfirstname as string,\n\t\tmsdyn_contactforvendor as boolean,\n\t\tlastname as string,\n\t\tmsdyn_contactpersonid as string,\n\t\tmsdyn_birthmonth as short,\n\t\tmsdyn_anniversarymonth as short,\n\t\tmsdyn_birthyear as boolean,\n\t\tmsdyn_anniversaryyear as boolean,\n\t\tmsdyn_phoneticlastname as string,\n\t\tmsdyn_namealias as string,\n\t\tmsdyn_anniversaryday as boolean,\n\t\tsuffix as string,\n\t\tmsdyn_birthday as boolean,\n\t\tfamilystatuscode as short,\n\t\tnickname as string,\n\t\tjobtitle as string,\n\t\tmsdyn_linkedvendoraccount as string,\n\t\tmsdyn_lastnameprefix as string,\n\t\tmsdyn_phoneticfirstname as string,\n\t\tmsdyn_phoneticmiddlename as string\n\t),\n\tallowSchemaDrift: true,\n\tvalidateSchema: false,\n\tignoreNoFilesFound: false) ~> CDSAllContact\nsource(output(\n\t\tmsdyn_company as string,\n\t\tmsdyn_vendoraccountnumber as string,\n\t\tmsdyn_language as integer,\n\t\tmsdyn_name as string,\n\t\tmsdyn_currencycode as string,\n\t\tmsdyn_numberofemployees as boolean,\n\t\tmsdyn_vendorid as string,\n\t\t{cdm_company1.cdm_companycode} as string,\n\t\tmsdyn_isperson as boolean,\n\t\tmsdyn_namealias as string,\n\t\tmsdyn_vendorpersoncreatedbyworkflow as boolean,\n\t\tmsdyn_vendorpartynumber as string,\n\t\tmsdyn_organizationnumber as string,\n\t\tmsdyn_vendorknownasname as string,\n\t\tmsdyn_linkedvendorinaccountsentity as string,\n\t\tmsdyn_hobbies as string,\n\t\tmsdyn_middlename as string,\n\t\tmsdyn_professionalsuffix as string,\n\t\tmsdyn_initials as string,\n\t\tmsdyn_lastnameprefix as string,\n\t\tmsdyn_personanniversaryday as boolean,\n\t\tmsdyn_phoneticmiddlename as string,\n\t\tmsdyn_childrennames as string,\n\t\tmsdyn_birthday as boolean,\n\t\tmsdyn_professionatitle as string,\n\t\tmsdyn_gendercode as boolean,\n\t\tmsdyn_birthyear as boolean,\n\t\tmsdyn_anniversarymonth as short,\n\t\tmsdyn_anniversaryyear as boolean,\n\t\tmsdyn_phoneticfirstname as string,\n\t\tmsdyn_phoneticlastname as string,\n\t\tmsdyn_maritalstatuscode as boolean,\n\t\tmsdyn_firstname as string,\n\t\tmsdyn_birthmonth as short,\n\t\tmsdyn_lastname as string\n\t),\n\tallowSchemaDrift: true,\n\tvalidateSchema: false,\n\tignoreNoFilesFound: false) ~> CDSAllVendor\nCDSAllAccount, CDSParty join(lower(CDSAllAccount@msdyn_partynumber) == lower(CDSParty@msdyn_partynumber),\n\tjoinType:'inner',\n\tbroadcast: 'auto')~> AccountPartyJoin\nAccountPartyJoin select(mapColumn(\n\t\taccountid,\n\t\tmsdyn_partyid,\n\t\tmsdyn_company,\n\t\taccountnumber,\n\t\t{cdm_company1.cdm_companycode},\n\t\tmsdyn_partynumber = CDSParty@msdyn_partynumber\n\t),\n\tskipDuplicateMapInputs: true,\n\tskipDuplicateMapOutputs: true) ~> AccountPartyId\nCDSAllContact, CDSParty join(lower(CDSAllContact@msdyn_partynumber) == lower(CDSParty@msdyn_partynumber),\n\tjoinType:'inner',\n\tbroadcast: 'auto')~> ContactPartyJoin\nContactPartyJoin select(mapColumn(\n\t\tcontactid,\n\t\tmsdyn_partyid,\n\t\tmsdyn_contactpersonid,\n\t\tmsdyn_company,\n\t\t{cdm_company1.cdm_companycode},\n\t\tmsdyn_partynumber = CDSParty@msdyn_partynumber\n\t),\n\tskipDuplicateMapInputs: true,\n\tskipDuplicateMapOutputs: true) ~> ContactPartyId\nCDSAllVendor, CDSParty join(lower(msdyn_vendorpartynumber) == lower(msdyn_partynumber),\n\tjoinType:'inner',\n\tbroadcast: 'auto')~> VendorPartyJoin\nVendorPartyJoin select(mapColumn(\n\t\tmsdyn_vendorid,\n\t\tmsdyn_partyid,\n\t\tmsdyn_company,\n\t\tmsdyn_vendoraccountnumber,\n\t\t{cdm_company1.cdm_companycode},\n\t\tmsdyn_partynumber\n\t),\n\tskipDuplicateMapInputs: true,\n\tskipDuplicateMapOutputs: true) ~> VendorPartyId\nAccountPartyId sink(input(\n\t\tColumn_1 as string,\n\t\tColumn_2 as string,\n\t\tColumn_3 as string,\n\t\tColumn_4 as string,\n\t\tColumn_5 as string,\n\t\tColumn_6 as string,\n\t\tColumn_7 as string,\n\t\tColumn_8 as string,\n\t\tColumn_9 as string,\n\t\tColumn_10 as string,\n\t\tColumn_11 as string,\n\t\tColumn_12 as string,\n\t\tColumn_13 as string,\n\t\tColumn_14 as string,\n\t\tColumn_15 as string,\n\t\tColumn_16 as string,\n\t\tColumn_17 as string,\n\t\tColumn_18 as string,\n\t\tColumn_19 as string,\n\t\tColumn_20 as string,\n\t\tColumn_21 as string,\n\t\tColumn_22 as string,\n\t\tColumn_23 as string,\n\t\tColumn_24 as string,\n\t\tColumn_25 as string,\n\t\tColumn_26 as string,\n\t\tColumn_27 as string,\n\t\tColumn_28 as string,\n\t\tColumn_29 as string,\n\t\tColumn_30 as string,\n\t\tColumn_31 as string\n\t),\n\tallowSchemaDrift: true,\n\tvalidateSchema: false,\n\tpartitionFileNames:['AccountParty.csv'],\n\tpartitionBy('hash', 1),\n\tskipDuplicateMapInputs: true,\n\tskipDuplicateMapOutputs: true) ~> AccountParty\nContactPartyId sink(input(\n\t\tColumn_1 as string,\n\t\tColumn_2 as string,\n\t\tColumn_3 as string,\n\t\tColumn_4 as string,\n\t\tColumn_5 as string,\n\t\tColumn_6 as string,\n\t\tColumn_7 as string,\n\t\tColumn_8 as string,\n\t\tColumn_9 as string,\n\t\tColumn_10 as string,\n\t\tColumn_11 as string,\n\t\tColumn_12 as string,\n\t\tColumn_13 as string,\n\t\tColumn_14 as string,\n\t\tColumn_15 as string,\n\t\tColumn_16 as string,\n\t\tColumn_17 as string,\n\t\tColumn_18 as string,\n\t\tColumn_19 as string,\n\t\tColumn_20 as string,\n\t\tColumn_21 as string,\n\t\tColumn_22 as string,\n\t\tColumn_23 as string,\n\t\tColumn_24 as string,\n\t\tColumn_25 as string,\n\t\tColumn_26 as string,\n\t\tColumn_27 as string,\n\t\tColumn_28 as string,\n\t\tColumn_29 as string,\n\t\tColumn_30 as string,\n\t\tColumn_31 as string\n\t),\n\tallowSchemaDrift: true,\n\tvalidateSchema: false,\n\tpartitionFileNames:['ContactParty.csv'],\n\tpartitionBy('hash', 1),\n\tskipDuplicateMapInputs: true,\n\tskipDuplicateMapOutputs: true) ~> ContactParty\nVendorPartyId sink(input(\n\t\tColumn_1 as string,\n\t\tColumn_2 as string,\n\t\tColumn_3 as string,\n\t\tColumn_4 as string,\n\t\tColumn_5 as string,\n\t\tColumn_6 as string,\n\t\tColumn_7 as string,\n\t\tColumn_8 as string,\n\t\tColumn_9 as string,\n\t\tColumn_10 as string,\n\t\tColumn_11 as string,\n\t\tColumn_12 as string,\n\t\tColumn_13 as string,\n\t\tColumn_14 as string,\n\t\tColumn_15 as string,\n\t\tColumn_16 as string,\n\t\tColumn_17 as string,\n\t\tColumn_18 as string,\n\t\tColumn_19 as string,\n\t\tColumn_20 as string,\n\t\tColumn_21 as string,\n\t\tColumn_22 as string,\n\t\tColumn_23 as string,\n\t\tColumn_24 as string,\n\t\tColumn_25 as string,\n\t\tColumn_26 as string,\n\t\tColumn_27 as string,\n\t\tColumn_28 as string,\n\t\tColumn_29 as string,\n\t\tColumn_30 as string,\n\t\tColumn_31 as string\n\t),\n\tallowSchemaDrift: true,\n\tvalidateSchema: false,\n\tpartitionFileNames:['VendorParty.csv'],\n\tpartitionBy('hash', 1),\n\tskipDuplicateMapInputs: true,\n\tskipDuplicateMapOutputs: true) ~> VendorParty"
                }
            },
            "dependsOn": [
                "[concat(variables('factoryId'), '/datasets/DelimitedTextFiles')]",
                "[concat(variables('factoryId'), '/datasets/DelimitedTextOutput')]"
            ]
        },
        {
            "name": "[concat(parameters('factoryName'), '/ContactForParty')]",
            "type": "Microsoft.DataFactory/factories/dataflows",
            "apiVersion": "2018-06-01",
            "properties": {
                "type": "MappingDataFlow",
                "typeProperties": {
                    "sources": [
                        {
                            "dataset": {
                                "referenceName": "DelimitedTextFiles",
                                "type": "DatasetReference"
                            },
                            "name": "AccountParty"
                        },
                        {
                            "dataset": {
                                "referenceName": "DelimitedTextFiles",
                                "type": "DatasetReference"
                            },
                            "name": "CDSAllContact"
                        },
                        {
                            "dataset": {
                                "referenceName": "DelimitedTextFiles",
                                "type": "DatasetReference"
                            },
                            "name": "CDSParty"
                        },
                        {
                            "dataset": {
                                "referenceName": "DelimitedTextFiles",
                                "type": "DatasetReference"
                            },
                            "name": "CDSAllCompany"
                        },
                        {
                            "dataset": {
                                "referenceName": "DelimitedTextFiles",
                                "type": "DatasetReference"
                            },
                            "name": "FOAllContactPerson"
                        }
                    ],
                    "sinks": [
                        {
                            "dataset": {
                                "referenceName": "DelimitedTextOutput",
                                "type": "DatasetReference"
                            },
                            "name": "ContactForPartyAccount"
                        }
                    ],
                    "transformations": [
                        {
                            "name": "FOCDSContactJoin"
                        },
                        {
                            "name": "FOContactForParty"
                        },
                        {
                            "name": "ContactForPartyAccountJoin"
                        },
                        {
                            "name": "FOContactForPartyAccount"
                        },
                        {
                            "name": "FOContactPartyId"
                        },
                        {
                            "name": "Enum"
                        },
                        {
                            "name": "ManagerContactForParty"
                        }
                    ],
                    "script": "source(output(\n\t\taccountid as string,\n\t\tmsdyn_partyid as string,\n\t\tmsdyn_company as string,\n\t\taccountnumber as string,\n\t\t{cdm_company1.cdm_companycode} as string,\n\t\tmsdyn_partynumber as string\n\t),\n\tallowSchemaDrift: true,\n\tvalidateSchema: false,\n\tignoreNoFilesFound: false,\n\tpartitionBy('hash', 1)) ~> AccountParty\nsource(output(\n\t\tcontactid as string,\n\t\tmsdyn_language as integer,\n\t\tmsdyn_company as string,\n\t\tmsdyn_isvendor as boolean,\n\t\tmsdyn_sellable as boolean,\n\t\t{cdm_company1.cdm_companycode} as string,\n\t\tmsdyn_partynumber as string,\n\t\tfirstname as string,\n\t\tmsdyn_contactforvendor as boolean,\n\t\tlastname as string,\n\t\tmsdyn_contactpersonid as string,\n\t\tmsdyn_birthmonth as string,\n\t\tmsdyn_anniversarymonth as string,\n\t\tmsdyn_birthyear as string,\n\t\tmsdyn_anniversaryyear as string,\n\t\tmsdyn_phoneticlastname as string,\n\t\tmsdyn_namealias as string,\n\t\tmsdyn_anniversaryday as string,\n\t\tsuffix as string,\n\t\tmsdyn_birthday as string,\n\t\tfamilystatuscode as string,\n\t\tnickname as string,\n\t\tjobtitle as string,\n\t\tmsdyn_linkedvendoraccount as string,\n\t\tmsdyn_lastnameprefix as string,\n\t\tmsdyn_phoneticfirstname as string,\n\t\tmsdyn_phoneticmiddlename as string\n\t),\n\tallowSchemaDrift: true,\n\tvalidateSchema: false,\n\tignoreNoFilesFound: false,\n\tpartitionBy('hash', 1)) ~> CDSAllContact\nsource(output(\n\t\tmsdyn_partyid as string,\n\t\tmsdyn_partytype as integer,\n\t\tmsdyn_partynumber as string\n\t),\n\tallowSchemaDrift: true,\n\tvalidateSchema: false,\n\tignoreNoFilesFound: false,\n\tpartitionBy('hash', 1)) ~> CDSParty\nsource(output(\n\t\tcdm_name as string,\n\t\tcdm_companyid as string,\n\t\tcdm_companycode as string\n\t),\n\tallowSchemaDrift: true,\n\tvalidateSchema: false,\n\tignoreNoFilesFound: false) ~> CDSAllCompany\nsource(output(\n\t\tdataAreaId as string,\n\t\tContactPersonId as string,\n\t\tEmploymentOfficeLocation as string,\n\t\tPrimarySalutationPhrase as string,\n\t\tSpouseName as string,\n\t\tIsVIP as boolean,\n\t\tOrganizationIdentificationNumber as string,\n\t\tAssistantPhoneNumber as string,\n\t\tNotes as string,\n\t\tAvailableToTime as integer,\n\t\tIsReceivingDirectMail as boolean,\n\t\tEmploymentJobFunctionName as string,\n\t\tGovernmentIdentificationNumber as string,\n\t\tEmploymentDepartment as string,\n\t\tMileageDistance as string,\n\t\tContactPersonResponsiblePersonnelNumber as short,\n\t\tMicrosoftOutlookCategories as string,\n\t\tAssociatedPartyNumber as string,\n\t\tAvailableFromTime as string,\n\t\tEmploymentComputerNetworkName as string,\n\t\tLoyaltyLevelPhrase as string,\n\t\tEmploymentJobTitle as string,\n\t\tContactActivitySensitivityLevel as string,\n\t\tHasRequestedInternetAccess as boolean,\n\t\tManagerContactPersonId as string,\n\t\tIdentityCardNumber as string,\n\t\tAssistantName as string,\n\t\tContactPersonPartyNumber as string,\n\t\tEmploymentProfession as string,\n\t\tPrimaryComplimentaryClosingPhrase as string,\n\t\tPersonalCharacterTypeCode as string,\n\t\tDecisionMakingRoleCode as string\n\t),\n\tallowSchemaDrift: true,\n\tvalidateSchema: false,\n\tignoreNoFilesFound: false,\n\tpartitionBy('hash', 1)) ~> FOAllContactPerson\nFOAllContactPerson, CDSAllContact join(lower(dataAreaId) == lower({cdm_company1.cdm_companycode})\n\t&& lower(ContactPersonId) == lower(msdyn_contactpersonid),\n\tjoinType:'inner',\n\tpartitionBy('hash', 1),\n\tbroadcast: 'auto')~> FOCDSContactJoin\nFOContactPartyId select(mapColumn(\n\t\tmsdyn_contactid = contactid,\n\t\tmsdyn_contactpartyid = msdyn_partyid,\n\t\tmsdyn_employmentprofession = EmploymentProfession,\n\t\tmsdyn_decisionmakingrole = DecisionMakingRoleCode,\n\t\tmsdyn_notes = Notes,\n\t\tmsdyn_spousename = SpouseName,\n\t\tmsdyn_associatedcompanyid = msdyn_company,\n\t\tAssociatedPartyNumber,\n\t\tmsdyn_contactforpartynumber = ContactPersonId,\n\t\tmsdyn_employmentdepartment = EmploymentDepartment,\n\t\tmsdyn_primarysalutationphrase = PrimarySalutationPhrase,\n\t\tmsdyn_assistantname = AssistantName,\n\t\tmsdyn_assistantphonenumber = AssistantPhoneNumber,\n\t\tmsdyn_availablefromtime = AvailableFromTime,\n\t\tmsdyn_availabletotime = AvailableToTime,\n\t\tmsdyn_employmentcomputernetworkname = EmploymentComputerNetworkName,\n\t\tmsdyn_employmentjobfunctionname = EmploymentJobFunctionName,\n\t\tmsdyn_governmentidentificationnumber = GovernmentIdentificationNumber,\n\t\tmsdyn_identitycardnumber = IdentityCardNumber,\n\t\tmsdyn_loyaltylevelphrase = LoyaltyLevelPhrase,\n\t\tmsdyn_microsoftoutlookcategories = MicrosoftOutlookCategories,\n\t\tmsdyn_mileagedistance = MileageDistance,\n\t\tmsdyn_organizationidentificationnumber = OrganizationIdentificationNumber,\n\t\tmsdyn_personalcharactertypecode = PersonalCharacterTypeCode,\n\t\tmsdyn_primarycomplimentaryclosingphrase = PrimaryComplimentaryClosingPhrase,\n\t\tmsdyn_employmentofficelocation = EmploymentOfficeLocation,\n\t\tmsdyn_jobtitle = EmploymentJobTitle,\n\t\tmsdyn_employeeresponsible = ContactPersonResponsiblePersonnelNumber,\n\t\tmsdyn_isreceivingdirectmail = IsReceivingDirectMail,\n\t\tmsdyn_isvip = IsVIP,\n\t\tmsdyn_contactactivitysensitivitylevel = ContactActivitySensitivityLevel,\n\t\tmsdyn_hasrequestedinternetaccess = HasRequestedInternetAccess,\n\t\tmsdyn_parentcontactforpartyid = ManagerContactPersonId\n\t),\n\tpartitionBy('hash', 1),\n\tskipDuplicateMapInputs: true,\n\tskipDuplicateMapOutputs: true) ~> FOContactForParty\nFOContactForParty, AccountParty join(lower(AssociatedPartyNumber) == lower(msdyn_partynumber),\n\tjoinType:'inner',\n\tpartitionBy('hash', 1),\n\tbroadcast: 'auto')~> ContactForPartyAccountJoin\nManagerContactForParty select(mapColumn(\n\t\tmsdyn_contactid,\n\t\tmsdyn_contactpartyid,\n\t\tmsdyn_associatedaccountid = accountid,\n\t\tmsdyn_associatedpartyid = AccountParty@msdyn_partyid,\n\t\tmsdyn_associatedcompanyid,\n\t\tmsdyn_employmentprofession,\n\t\tmsdyn_decisionmakingrole,\n\t\tmsdyn_notes,\n\t\tmsdyn_spousename,\n\t\tmsdyn_contactforpartynumber,\n\t\tmsdyn_employmentdepartment,\n\t\tmsdyn_primarysalutationphrase,\n\t\tmsdyn_assistantname,\n\t\tmsdyn_assistantphonenumber,\n\t\tmsdyn_availablefromtime,\n\t\tmsdyn_availabletotime,\n\t\tmsdyn_employmentcomputernetworkname,\n\t\tmsdyn_employmentjobfunctionname,\n\t\tmsdyn_governmentidentificationnumber,\n\t\tmsdyn_identitycardnumber,\n\t\tmsdyn_loyaltylevelphrase,\n\t\tmsdyn_microsoftoutlookcategories,\n\t\tmsdyn_mileagedistance,\n\t\tmsdyn_organizationidentificationnumber,\n\t\tmsdyn_personalcharactertypecode,\n\t\tmsdyn_employmentofficelocation,\n\t\tmsdyn_primarycomplimentaryclosingphrase,\n\t\tmsdyn_jobtitle,\n\t\tmsdyn_employeeresponsible,\n\t\tmsdyn_parentcontactforpartyid = CDSParty@msdyn_partyid,\n\t\tmsdyn_isreceivingdirectmail,\n\t\tmsdyn_isvip,\n\t\tmsdyn_contactactivitysensitivitylevel,\n\t\tmsdyn_hasrequestedinternetaccess\n\t),\n\tpartitionBy('hash', 1),\n\tskipDuplicateMapInputs: true,\n\tskipDuplicateMapOutputs: true) ~> FOContactForPartyAccount\nFOCDSContactJoin, CDSParty join(lower(ContactPersonPartyNumber) == lower(CDSParty@msdyn_partynumber),\n\tjoinType:'inner',\n\tpartitionBy('hash', 1),\n\tbroadcast: 'both')~> FOContactPartyId\nFOContactForPartyAccount derive(msdyn_contactactivitysensitivitylevel = case(lower(msdyn_contactactivitysensitivitylevel)=='normal',192350000,\r\ncase(lower(msdyn_contactactivitysensitivitylevel)=='personal',192350001,\r\ncase(lower(msdyn_contactactivitysensitivitylevel)=='private',192350002,\r\ncase(lower(msdyn_contactactivitysensitivitylevel)=='confidential',192350003\r\n)))),\n\tpartitionBy('hash', 1)) ~> Enum\nContactForPartyAccountJoin, CDSParty join(lower(msdyn_parentcontactforpartyid) == lower(CDSParty@msdyn_partynumber),\n\tjoinType:'left',\n\tpartitionBy('hash', 1),\n\tbroadcast: 'auto')~> ManagerContactForParty\nEnum sink(input(\n\t\tColumn_1 as string,\n\t\tColumn_2 as string,\n\t\tColumn_3 as string,\n\t\tColumn_4 as string,\n\t\tColumn_5 as string,\n\t\tColumn_6 as string,\n\t\tColumn_7 as string,\n\t\tColumn_8 as string,\n\t\tColumn_9 as string,\n\t\tColumn_10 as string,\n\t\tColumn_11 as string,\n\t\tColumn_12 as string,\n\t\tColumn_13 as string,\n\t\tColumn_14 as string,\n\t\tColumn_15 as string,\n\t\tColumn_16 as string,\n\t\tColumn_17 as string,\n\t\tColumn_18 as string,\n\t\tColumn_19 as string,\n\t\tColumn_20 as string,\n\t\tColumn_21 as string,\n\t\tColumn_22 as string,\n\t\tColumn_23 as string,\n\t\tColumn_24 as string,\n\t\tColumn_25 as string,\n\t\tColumn_26 as string,\n\t\tColumn_27 as string,\n\t\tColumn_28 as string,\n\t\tColumn_29 as string,\n\t\tColumn_30 as string,\n\t\tColumn_31 as string\n\t),\n\tallowSchemaDrift: true,\n\tvalidateSchema: false,\n\tpartitionFileNames:['ContactForPartyAccount.csv'],\n\tpartitionBy('hash', 1),\n\tskipDuplicateMapInputs: true,\n\tskipDuplicateMapOutputs: true) ~> ContactForPartyAccount"
                }
            },
            "dependsOn": [
                "[concat(variables('factoryId'), '/datasets/DelimitedTextFiles')]",
                "[concat(variables('factoryId'), '/datasets/DelimitedTextOutput')]"
            ]
        },
        {
            "name": "[concat(parameters('factoryName'), '/DWCompanies')]",
            "type": "Microsoft.DataFactory/factories/dataflows",
            "apiVersion": "2018-06-01",
            "properties": {
                "type": "MappingDataFlow",
                "typeProperties": {
                    "sources": [
                        {
                            "dataset": {
                                "referenceName": "DelimitedTextFiles",
                                "type": "DatasetReference"
                            },
                            "name": "CDSAllCompany"
                        }
                    ],
                    "sinks": [
                        {
                            "dataset": {
                                "referenceName": "DelimitedTextOutput",
                                "type": "DatasetReference"
                            },
                            "name": "sink1"
                        }
                    ],
                    "transformations": [
                        {
                            "name": "isDWEnableCompany"
                        },
                        {
                            "name": "CompanyCode"
                        },
                        {
                            "name": "CompanyFilter"
                        }
                    ],
                    "script": "source(output(\n\t\tcdm_name as string,\n\t\tcdm_companyid as string,\n\t\tcdm_companycode as string,\n\t\tcdm_isenabledfordualwrite as boolean\n\t),\n\tallowSchemaDrift: true,\n\tvalidateSchema: false,\n\tignoreNoFilesFound: false) ~> CDSAllCompany\nCDSAllCompany filter(cdm_isenabledfordualwrite) ~> isDWEnableCompany\nisDWEnableCompany select(mapColumn(\n\t\tcdm_companycode\n\t),\n\tskipDuplicateMapInputs: true,\n\tskipDuplicateMapOutputs: true) ~> CompanyCode\nCompanyCode derive(cdm_companycode = concat(\"dataAreaId eq '\", concat(cdm_companycode,\"'\"))) ~> CompanyFilter\nCompanyFilter sink(input(\n\t\tColumn_1 as string,\n\t\tColumn_2 as string,\n\t\tColumn_3 as string,\n\t\tColumn_4 as string,\n\t\tColumn_5 as string,\n\t\tColumn_6 as string,\n\t\tColumn_7 as string,\n\t\tColumn_8 as string,\n\t\tColumn_9 as string,\n\t\tColumn_10 as string,\n\t\tColumn_11 as string,\n\t\tColumn_12 as string,\n\t\tColumn_13 as string,\n\t\tColumn_14 as string,\n\t\tColumn_15 as string,\n\t\tColumn_16 as string,\n\t\tColumn_17 as string,\n\t\tColumn_18 as string,\n\t\tColumn_19 as string,\n\t\tColumn_20 as string,\n\t\tColumn_21 as string,\n\t\tColumn_22 as string,\n\t\tColumn_23 as string,\n\t\tColumn_24 as string,\n\t\tColumn_25 as string,\n\t\tColumn_26 as string,\n\t\tColumn_27 as string,\n\t\tColumn_28 as string,\n\t\tColumn_29 as string,\n\t\tColumn_30 as string,\n\t\tColumn_31 as string\n\t),\n\tallowSchemaDrift: true,\n\tvalidateSchema: false,\n\tpartitionFileNames:['DWEnabledCompany.csv'],\n\tpartitionBy('hash', 1),\n\tskipDuplicateMapInputs: true,\n\tskipDuplicateMapOutputs: true) ~> sink1"
                }
            },
            "dependsOn": [
                "[concat(variables('factoryId'), '/datasets/DelimitedTextFiles')]",
                "[concat(variables('factoryId'), '/datasets/DelimitedTextOutput')]"
            ]
        },
        {
            "name": "[concat(parameters('factoryName'), '/MergeContactForPartyAccountVendor')]",
            "type": "Microsoft.DataFactory/factories/dataflows",
            "apiVersion": "2018-06-01",
            "properties": {
                "type": "MappingDataFlow",
                "typeProperties": {
                    "sources": [
                        {
                            "dataset": {
                                "referenceName": "DelimitedTextFiles",
                                "type": "DatasetReference"
                            },
                            "name": "ContactForPartyAccount"
                        },
                        {
                            "dataset": {
                                "referenceName": "DelimitedTextFiles",
                                "type": "DatasetReference"
                            },
                            "name": "ContactForPartyVendor"
                        },
                        {
                            "dataset": {
                                "referenceName": "DelimitedTextFiles",
                                "type": "DatasetReference"
                            },
                            "name": "ContactForPartyCustomerContact"
                        },
                        {
                            "dataset": {
                                "referenceName": "DelimitedTextFiles",
                                "type": "DatasetReference"
                            },
                            "name": "CDSSalutation"
                        },
                        {
                            "dataset": {
                                "referenceName": "DelimitedTextFiles",
                                "type": "DatasetReference"
                            },
                            "name": "CDSComplimentaryClosing"
                        },
                        {
                            "dataset": {
                                "referenceName": "DelimitedTextFiles",
                                "type": "DatasetReference"
                            },
                            "name": "CDSLoyaltyLevel"
                        },
                        {
                            "dataset": {
                                "referenceName": "DelimitedTextFiles",
                                "type": "DatasetReference"
                            },
                            "name": "CDSPersonalCharacterType"
                        },
                        {
                            "dataset": {
                                "referenceName": "DelimitedTextFiles",
                                "type": "DatasetReference"
                            },
                            "name": "CDSSalesContactPersonTitle"
                        },
                        {
                            "dataset": {
                                "referenceName": "DelimitedTextFiles",
                                "type": "DatasetReference"
                            },
                            "name": "CDSDecisionMakingRole"
                        },
                        {
                            "dataset": {
                                "referenceName": "DelimitedTextFiles",
                                "type": "DatasetReference"
                            },
                            "name": "CDSWorker"
                        }
                    ],
                    "sinks": [
                        {
                            "dataset": {
                                "referenceName": "DelimitedTextOutput",
                                "type": "DatasetReference"
                            },
                            "name": "ContactForParty"
                        }
                    ],
                    "transformations": [
                        {
                            "name": "MergeContactForPartyVendor"
                        },
                        {
                            "name": "MergeContactForPartyCustomerContact"
                        },
                        {
                            "name": "Saluation"
                        },
                        {
                            "name": "ComplimentaryClosing"
                        },
                        {
                            "name": "LoyaltyLevel"
                        },
                        {
                            "name": "PersonalCharacterType"
                        },
                        {
                            "name": "DecisionMakingRole"
                        },
                        {
                            "name": "CDSContactForParty"
                        },
                        {
                            "name": "EmployeeResponsible"
                        }
                    ],
                    "script": "source(output(\n\t\tmsdyn_contactid as string,\n\t\tmsdyn_contactpartyid as string,\n\t\tmsdyn_associatedaccountid as string,\n\t\tmsdyn_associatedpartyid as string,\n\t\tmsdyn_associatedcompanyid as string,\n\t\tmsdyn_employmentprofession as string,\n\t\tmsdyn_decisionmakingrole as string,\n\t\tmsdyn_notes as string,\n\t\tmsdyn_spousename as string,\n\t\tmsdyn_contactforpartynumber as string,\n\t\tmsdyn_employmentdepartment as string,\n\t\tmsdyn_primarysalutationphrase as string,\n\t\tmsdyn_assistantname as string,\n\t\tmsdyn_assistantphonenumber as string,\n\t\tmsdyn_availablefromtime as integer,\n\t\tmsdyn_availabletotime as integer,\n\t\tmsdyn_employmentcomputernetworkname as string,\n\t\tmsdyn_employmentjobfunctionname as string,\n\t\tmsdyn_governmentidentificationnumber as string,\n\t\tmsdyn_identitycardnumber as string,\n\t\tmsdyn_loyaltylevelphrase as string,\n\t\tmsdyn_microsoftoutlookcategories as string,\n\t\tmsdyn_mileagedistance as string,\n\t\tmsdyn_organizationidentificationnumber as string,\n\t\tmsdyn_personalcharactertypecode as string,\n\t\tmsdyn_employmentofficelocation as boolean,\n\t\tmsdyn_primarycomplimentaryclosingphrase as string,\n\t\tmsdyn_jobtitle as boolean,\n\t\tmsdyn_employeeresponsible as integer,\n\t\tmsdyn_parentcontactforpartyid as string,\n\t\tmsdyn_isreceivingdirectmail as boolean,\n\t\tmsdyn_isvip as boolean,\n\t\tmsdyn_contactactivitysensitivitylevel as integer,\n\t\tmsdyn_hasrequestedinternetaccess as boolean\n\t),\n\tallowSchemaDrift: true,\n\tvalidateSchema: false,\n\tignoreNoFilesFound: false) ~> ContactForPartyAccount\nsource(output(\n\t\tmsdyn_contactid as string,\n\t\tmsdyn_contactpartyid as string,\n\t\tmsdyn_associatedcompanyid as string,\n\t\tmsdyn_associatedvendorid as string,\n\t\tmsdyn_associatedpartyid as string,\n\t\tmsdyn_employmentprofession as string,\n\t\tmsdyn_decisionmakingrole as string,\n\t\tmsdyn_notes as string,\n\t\tmsdyn_spousename as string,\n\t\tmsdyn_contactforpartynumber as string,\n\t\tmsdyn_employmentdepartment as string,\n\t\tmsdyn_primarysalutationphrase as string,\n\t\tmsdyn_assistantname as string,\n\t\tmsdyn_assistantphonenumber as string,\n\t\tmsdyn_availablefromtime as integer,\n\t\tmsdyn_availabletotime as integer,\n\t\tmsdyn_employmentcomputernetworkname as string,\n\t\tmsdyn_employmentjobfunctionname as string,\n\t\tmsdyn_employmentofficelocation as boolean,\n\t\tmsdyn_governmentidentificationnumber as string,\n\t\tmsdyn_identitycardnumber as string,\n\t\tmsdyn_loyaltylevelphrase as string,\n\t\tmsdyn_microsoftoutlookcategories as string,\n\t\tmsdyn_mileagedistance as string,\n\t\tmsdyn_organizationidentificationnumber as string,\n\t\tmsdyn_personalcharactertypecode as string,\n\t\tmsdyn_primarycomplimentaryclosingphrase as string,\n\t\tmsdyn_jobtitle as boolean,\n\t\tmsdyn_employeeresponsible as short,\n\t\tmsdyn_parentcontactforpartyid as string,\n\t\tmsdyn_isreceivingdirectmail as boolean,\n\t\tmsdyn_isvip as boolean,\n\t\tmsdyn_contactactivitysensitivitylevel as integer,\n\t\tmsdyn_hasrequestedinternetaccess as boolean\n\t),\n\tallowSchemaDrift: true,\n\tvalidateSchema: false,\n\tignoreNoFilesFound: false) ~> ContactForPartyVendor\nsource(output(\n\t\tmsdyn_contactid as string,\n\t\tmsdyn_contactpartyid as string,\n\t\tmsdyn_associatedcompanyid as string,\n\t\tmsdyn_associatedcontactid as string,\n\t\tmsdyn_associatedpartyid as string,\n\t\tmsdyn_employmentprofession as string,\n\t\tmsdyn_decisionmakingrole as string,\n\t\tmsdyn_notes as string,\n\t\tmsdyn_spousename as string,\n\t\tmsdyn_contactforpartynumber as string,\n\t\tmsdyn_employmentdepartment as string,\n\t\tmsdyn_primarysalutationphrase as string,\n\t\tmsdyn_assistantname as string,\n\t\tmsdyn_assistantphonenumber as string,\n\t\tmsdyn_availablefromtime as integer,\n\t\tmsdyn_availabletotime as integer,\n\t\tmsdyn_employmentcomputernetworkname as string,\n\t\tmsdyn_employmentjobfunctionname as string,\n\t\tmsdyn_employmentofficelocation as boolean,\n\t\tmsdyn_governmentidentificationnumber as string,\n\t\tmsdyn_identitycardnumber as string,\n\t\tmsdyn_loyaltylevelphrase as string,\n\t\tmsdyn_microsoftoutlookcategories as string,\n\t\tmsdyn_mileagedistance as string,\n\t\tmsdyn_organizationidentificationnumber as string,\n\t\tmsdyn_personalcharactertypecode as string,\n\t\tmsdyn_primarycomplimentaryclosingphrase as string,\n\t\tmsdyn_jobtitle as boolean,\n\t\tmsdyn_employeeresponsible as short,\n\t\tmsdyn_parentcontactforpartyid as string,\n\t\tmsdyn_isreceivingdirectmail as boolean,\n\t\tmsdyn_isvip as boolean,\n\t\tmsdyn_contactactivitysensitivitylevel as integer,\n\t\tmsdyn_hasrequestedinternetaccess as boolean\n\t),\n\tallowSchemaDrift: true,\n\tvalidateSchema: false,\n\tignoreNoFilesFound: false) ~> ContactForPartyCustomerContact\nsource(output(\n\t\tmsdyn_salutationphrase as string,\n\t\tstatecode as boolean,\n\t\tmsdyn_salutationid as string,\n\t\tmsdyn_company as string\n\t),\n\tallowSchemaDrift: true,\n\tvalidateSchema: false,\n\tignoreNoFilesFound: false) ~> CDSSalutation\nsource(output(\n\t\tmsdyn_closingphrase as string,\n\t\tstatecode as boolean,\n\t\tmsdyn_complimentaryclosingid as string,\n\t\tmsdyn_companyid as string\n\t),\n\tallowSchemaDrift: true,\n\tvalidateSchema: false,\n\tignoreNoFilesFound: false) ~> CDSComplimentaryClosing\nsource(output(\n\t\tmsdyn_levelphrase as string,\n\t\tstatecode as boolean,\n\t\tmsdyn_loyaltylevelid as string,\n\t\tmsdyn_company as string\n\t),\n\tallowSchemaDrift: true,\n\tvalidateSchema: false,\n\tignoreNoFilesFound: false) ~> CDSLoyaltyLevel\nsource(output(\n\t\tmsdyn_typename as string,\n\t\tstatecode as boolean,\n\t\tmsdyn_personalcharactertypeid as string,\n\t\tmsdyn_company as string\n\t),\n\tallowSchemaDrift: true,\n\tvalidateSchema: false,\n\tignoreNoFilesFound: false) ~> CDSPersonalCharacterType\nsource(output(\n\t\tmsdyn_company as string,\n\t\tmsdyn_jobtitle as string,\n\t\tmsdyn_jobtitlealias as string,\n\t\tstatecode as boolean,\n\t\tmsdyn_salescontactpersontitleid as string\n\t),\n\tallowSchemaDrift: true,\n\tvalidateSchema: false,\n\tignoreNoFilesFound: false) ~> CDSSalesContactPersonTitle\nsource(output(\n\t\tmsdyn_rolename as string,\n\t\tstatecode as boolean,\n\t\tmsdyn_decisionmakingroleid as string,\n\t\tmsdyn_company as string\n\t),\n\tallowSchemaDrift: true,\n\tvalidateSchema: false,\n\tignoreNoFilesFound: false) ~> CDSDecisionMakingRole\nsource(output(\n\t\tcdm_workernumber as short,\n\t\tstatecode as boolean,\n\t\tcdm_workerid as string\n\t),\n\tallowSchemaDrift: true,\n\tvalidateSchema: false,\n\tignoreNoFilesFound: false) ~> CDSWorker\nContactForPartyAccount, ContactForPartyVendor union(byName: true)~> MergeContactForPartyVendor\nMergeContactForPartyVendor, ContactForPartyCustomerContact union(byName: true)~> MergeContactForPartyCustomerContact\nMergeContactForPartyCustomerContact, CDSSalutation lookup(msdyn_associatedcompanyid == msdyn_company\n\t&& lower(msdyn_primarysalutationphrase) == lower(msdyn_salutationphrase),\n\tmultiple: false,\n\tpickup: 'any',\n\tbroadcast: 'auto')~> Saluation\nSaluation, CDSComplimentaryClosing lookup(msdyn_associatedcompanyid == msdyn_companyid\n\t&& lower(msdyn_primarycomplimentaryclosingphrase) == lower(msdyn_closingphrase),\n\tmultiple: false,\n\tpickup: 'any',\n\tbroadcast: 'auto')~> ComplimentaryClosing\nComplimentaryClosing, CDSLoyaltyLevel lookup(msdyn_associatedcompanyid == CDSLoyaltyLevel@msdyn_company\n\t&& lower(msdyn_loyaltylevelphrase) == lower(msdyn_levelphrase),\n\tmultiple: false,\n\tpickup: 'any',\n\tbroadcast: 'auto')~> LoyaltyLevel\nLoyaltyLevel, CDSPersonalCharacterType lookup(msdyn_associatedcompanyid == CDSPersonalCharacterType@msdyn_company\n\t&& lower(msdyn_personalcharactertypecode) == lower(msdyn_typename),\n\tmultiple: false,\n\tpickup: 'any',\n\tbroadcast: 'auto')~> PersonalCharacterType\nPersonalCharacterType, CDSDecisionMakingRole lookup(msdyn_associatedcompanyid == CDSDecisionMakingRole@msdyn_company\n\t&& lower(msdyn_decisionmakingrole) == lower(msdyn_rolename),\n\tmultiple: false,\n\tpickup: 'any',\n\tbroadcast: 'auto')~> DecisionMakingRole\nEmployeeResponsible select(mapColumn(\n\t\tmsdyn_contactid,\n\t\tmsdyn_contactpartyid,\n\t\tmsdyn_associatedaccountid,\n\t\tmsdyn_associatedpartyid,\n\t\tmsdyn_associatedcompanyid,\n\t\tmsdyn_employmentprofession,\n\t\tmsdyn_decisionmakingrole = msdyn_decisionmakingroleid,\n\t\tmsdyn_notes,\n\t\tmsdyn_spousename,\n\t\tmsdyn_contactforpartynumber,\n\t\tmsdyn_employmentdepartment,\n\t\tmsdyn_primarysalutationphrase = msdyn_salutationid,\n\t\tmsdyn_assistantname,\n\t\tmsdyn_assistantphonenumber,\n\t\tmsdyn_availablefromtime,\n\t\tmsdyn_availabletotime,\n\t\tmsdyn_employmentcomputernetworkname,\n\t\tmsdyn_employmentjobfunctionname,\n\t\tmsdyn_governmentidentificationnumber,\n\t\tmsdyn_identitycardnumber,\n\t\tmsdyn_loyaltylevelphrase = msdyn_loyaltylevelid,\n\t\tmsdyn_microsoftoutlookcategories,\n\t\tmsdyn_mileagedistance,\n\t\tmsdyn_organizationidentificationnumber,\n\t\tmsdyn_personalcharactertypecode = msdyn_personalcharactertypeid,\n\t\tmsdyn_employmentofficelocation,\n\t\tmsdyn_primarycomplimentaryclosingphrase = msdyn_complimentaryclosingid,\n\t\tmsdyn_associatedvendorid,\n\t\tmsdyn_associatedcontactid,\n\t\tmsdyn_isvip,\n\t\tmsdyn_isreceivingdirectmail,\n\t\tmsdyn_contactactivitysensitivitylevel,\n\t\tmsdyn_hasrequestedinternetaccess,\n\t\tmsdyn_parentcontactforpartyid,\n\t\tmsdyn_employeeresponsible = cdm_workerid\n\t),\n\tskipDuplicateMapInputs: true,\n\tskipDuplicateMapOutputs: true) ~> CDSContactForParty\nDecisionMakingRole, CDSWorker join(msdyn_employeeresponsible == cdm_workernumber,\n\tjoinType:'left',\n\tbroadcast: 'auto')~> EmployeeResponsible\nCDSContactForParty sink(input(\n\t\tColumn_1 as string,\n\t\tColumn_2 as string,\n\t\tColumn_3 as string,\n\t\tColumn_4 as string,\n\t\tColumn_5 as string,\n\t\tColumn_6 as string,\n\t\tColumn_7 as string,\n\t\tColumn_8 as string,\n\t\tColumn_9 as string,\n\t\tColumn_10 as string,\n\t\tColumn_11 as string,\n\t\tColumn_12 as string,\n\t\tColumn_13 as string,\n\t\tColumn_14 as string,\n\t\tColumn_15 as string,\n\t\tColumn_16 as string,\n\t\tColumn_17 as string,\n\t\tColumn_18 as string,\n\t\tColumn_19 as string,\n\t\tColumn_20 as string,\n\t\tColumn_21 as string,\n\t\tColumn_22 as string,\n\t\tColumn_23 as string,\n\t\tColumn_24 as string,\n\t\tColumn_25 as string,\n\t\tColumn_26 as string,\n\t\tColumn_27 as string,\n\t\tColumn_28 as string,\n\t\tColumn_29 as string,\n\t\tColumn_30 as string,\n\t\tColumn_31 as string\n\t),\n\tallowSchemaDrift: true,\n\tvalidateSchema: false,\n\tpartitionFileNames:['CDSContactForParty.csv'],\n\tpartitionBy('hash', 1),\n\tskipDuplicateMapInputs: true,\n\tskipDuplicateMapOutputs: true) ~> ContactForParty"
                }
            },
            "dependsOn": [
                "[concat(variables('factoryId'), '/datasets/DelimitedTextFiles')]",
                "[concat(variables('factoryId'), '/datasets/DelimitedTextOutput')]"
            ]
        },
        {
            "name": "[concat(parameters('factoryName'), '/PrepareContactForPartyVendor')]",
            "type": "Microsoft.DataFactory/factories/dataflows",
            "apiVersion": "2018-06-01",
            "properties": {
                "type": "MappingDataFlow",
                "typeProperties": {
                    "sources": [
                        {
                            "dataset": {
                                "referenceName": "DelimitedTextFiles",
                                "type": "DatasetReference"
                            },
                            "name": "VendorParty"
                        },
                        {
                            "dataset": {
                                "referenceName": "DelimitedTextFiles",
                                "type": "DatasetReference"
                            },
                            "name": "FOAllContactPerson"
                        },
                        {
                            "dataset": {
                                "referenceName": "DelimitedTextFiles",
                                "type": "DatasetReference"
                            },
                            "name": "CDSAllContact"
                        },
                        {
                            "dataset": {
                                "referenceName": "DelimitedTextFiles",
                                "type": "DatasetReference"
                            },
                            "name": "CDSParty"
                        }
                    ],
                    "sinks": [
                        {
                            "dataset": {
                                "referenceName": "DelimitedTextOutput",
                                "type": "DatasetReference"
                            },
                            "name": "CDSVendorPartyFile"
                        }
                    ],
                    "transformations": [
                        {
                            "name": "FOCDSVendorContactJoin"
                        },
                        {
                            "name": "FOCDSVendorContact"
                        },
                        {
                            "name": "VendorContactPartyJoin"
                        },
                        {
                            "name": "VendorPartyJoin"
                        },
                        {
                            "name": "CDSVendorParty"
                        },
                        {
                            "name": "ManagerContactForParty"
                        },
                        {
                            "name": "Enum"
                        }
                    ],
                    "script": "source(output(\n\t\tmsdyn_vendorid as string,\n\t\tmsdyn_partyid as string,\n\t\tmsdyn_company as string,\n\t\tmsdyn_vendoraccountnumber as string,\n\t\t{cdm_company1.cdm_companycode} as string,\n\t\tmsdyn_partynumber as string\n\t),\n\tallowSchemaDrift: true,\n\tvalidateSchema: false,\n\tignoreNoFilesFound: false,\n\tpartitionBy('hash', 1)) ~> VendorParty\nsource(output(\n\t\tdataAreaId as string,\n\t\tContactPersonId as string,\n\t\tEmploymentOfficeLocation as string,\n\t\tPrimarySalutationPhrase as string,\n\t\tSpouseName as string,\n\t\tIsVIP as boolean,\n\t\tOrganizationIdentificationNumber as string,\n\t\tAssistantPhoneNumber as string,\n\t\tNotes as string,\n\t\tAvailableToTime as integer,\n\t\tIsReceivingDirectMail as boolean,\n\t\tEmploymentJobFunctionName as string,\n\t\tGovernmentIdentificationNumber as string,\n\t\tEmploymentDepartment as string,\n\t\tMileageDistance as string,\n\t\tContactPersonResponsiblePersonnelNumber as short,\n\t\tMicrosoftOutlookCategories as string,\n\t\tAssociatedPartyNumber as string,\n\t\tAvailableFromTime as integer,\n\t\tEmploymentComputerNetworkName as string,\n\t\tLoyaltyLevelPhrase as string,\n\t\tEmploymentJobTitle as string,\n\t\tContactActivitySensitivityLevel as string,\n\t\tHasRequestedInternetAccess as boolean,\n\t\tManagerContactPersonId as string,\n\t\tIdentityCardNumber as string,\n\t\tAssistantName as string,\n\t\tContactPersonPartyNumber as string,\n\t\tEmploymentProfession as string,\n\t\tPrimaryComplimentaryClosingPhrase as string,\n\t\tPersonalCharacterTypeCode as string,\n\t\tDecisionMakingRoleCode as string\n\t),\n\tallowSchemaDrift: true,\n\tvalidateSchema: false,\n\tignoreNoFilesFound: false) ~> FOAllContactPerson\nsource(output(\n\t\tcontactid as string,\n\t\tmsdyn_language as integer,\n\t\tmsdyn_company as string,\n\t\tmsdyn_isvendor as boolean,\n\t\tmsdyn_sellable as boolean,\n\t\t{cdm_company1.cdm_companycode} as string,\n\t\tmsdyn_partynumber as string,\n\t\tfirstname as string,\n\t\tmsdyn_contactforvendor as boolean,\n\t\tlastname as string,\n\t\tmsdyn_contactpersonid as string,\n\t\tmsdyn_birthmonth as string,\n\t\tmsdyn_anniversarymonth as string,\n\t\tmsdyn_birthyear as boolean,\n\t\tmsdyn_anniversaryyear as boolean,\n\t\tmsdyn_phoneticlastname as string,\n\t\tmsdyn_namealias as string,\n\t\tmsdyn_anniversaryday as boolean,\n\t\tsuffix as string,\n\t\tmsdyn_birthday as boolean,\n\t\tfamilystatuscode as integer,\n\t\tnickname as string,\n\t\tjobtitle as string,\n\t\tmsdyn_linkedvendoraccount as string,\n\t\tmsdyn_lastnameprefix as string,\n\t\tmsdyn_phoneticfirstname as string,\n\t\tmsdyn_phoneticmiddlename as string\n\t),\n\tallowSchemaDrift: true,\n\tvalidateSchema: false,\n\tignoreNoFilesFound: false,\n\tpartitionBy('hash', 1)) ~> CDSAllContact\nsource(output(\n\t\tmsdyn_partyid as string,\n\t\tmsdyn_partytype as integer,\n\t\tmsdyn_partynumber as string\n\t),\n\tallowSchemaDrift: true,\n\tvalidateSchema: false,\n\tignoreNoFilesFound: false,\n\tpartitionBy('hash', 1)) ~> CDSParty\nFOAllContactPerson, CDSAllContact join(lower(dataAreaId) == lower({cdm_company1.cdm_companycode})\n\t&& lower(ContactPersonId) == lower(msdyn_contactpersonid),\n\tjoinType:'inner',\n\tpartitionBy('hash', 1),\n\tbroadcast: 'auto')~> FOCDSVendorContactJoin\nVendorContactPartyJoin select(mapColumn(\n\t\tmsdyn_contactid = contactid,\n\t\tmsdyn_contactpartyid = msdyn_partyid,\n\t\tmsdyn_associatedcompanyid = msdyn_company,\n\t\tAssociatedPartyNumber,\n\t\tmsdyn_employmentprofession = EmploymentProfession,\n\t\tmsdyn_decisionmakingrole = DecisionMakingRoleCode,\n\t\tmsdyn_notes = Notes,\n\t\tmsdyn_spousename = SpouseName,\n\t\tmsdyn_contactforpartynumber = ContactPersonId,\n\t\tmsdyn_employmentdepartment = EmploymentDepartment,\n\t\tmsdyn_primarysalutationphrase = PrimarySalutationPhrase,\n\t\tmsdyn_assistantname = AssistantName,\n\t\tmsdyn_assistantphonenumber = AssistantPhoneNumber,\n\t\tmsdyn_availablefromtime = AvailableFromTime,\n\t\tmsdyn_availabletotime = AvailableToTime,\n\t\tmsdyn_employmentcomputernetworkname = EmploymentComputerNetworkName,\n\t\tmsdyn_employmentjobfunctionname = EmploymentJobFunctionName,\n\t\tmsdyn_employmentofficelocation = EmploymentOfficeLocation,\n\t\tmsdyn_governmentidentificationnumber = GovernmentIdentificationNumber,\n\t\tmsdyn_identitycardnumber = IdentityCardNumber,\n\t\tmsdyn_loyaltylevelphrase = LoyaltyLevelPhrase,\n\t\tmsdyn_microsoftoutlookcategories = MicrosoftOutlookCategories,\n\t\tmsdyn_mileagedistance = MileageDistance,\n\t\tmsdyn_organizationidentificationnumber = OrganizationIdentificationNumber,\n\t\tmsdyn_personalcharactertypecode = PersonalCharacterTypeCode,\n\t\tmsdyn_primarycomplimentaryclosingphrase = PrimaryComplimentaryClosingPhrase,\n\t\tmsdyn_jobtitle = EmploymentJobTitle,\n\t\tmsdyn_employeeresponsible = ContactPersonResponsiblePersonnelNumber,\n\t\tmsdyn_isreceivingdirectmail = IsReceivingDirectMail,\n\t\tmsdyn_isvip = IsVIP,\n\t\tmsdyn_contactactivitysensitivitylevel = ContactActivitySensitivityLevel,\n\t\tmsdyn_hasrequestedinternetaccess = HasRequestedInternetAccess,\n\t\tmsdyn_parentcontactforpartyid = ManagerContactPersonId\n\t),\n\tpartitionBy('hash', 1),\n\tskipDuplicateMapInputs: true,\n\tskipDuplicateMapOutputs: true) ~> FOCDSVendorContact\nFOCDSVendorContactJoin, CDSParty join(lower(ContactPersonPartyNumber) == lower(CDSParty@msdyn_partynumber),\n\tjoinType:'inner',\n\tpartitionBy('hash', 1),\n\tbroadcast: 'auto')~> VendorContactPartyJoin\nFOCDSVendorContact, VendorParty join(lower(AssociatedPartyNumber) == lower(msdyn_partynumber),\n\tjoinType:'inner',\n\tpartitionBy('hash', 1),\n\tbroadcast: 'auto')~> VendorPartyJoin\nManagerContactForParty select(mapColumn(\n\t\tmsdyn_contactid,\n\t\tmsdyn_contactpartyid,\n\t\tmsdyn_associatedcompanyid,\n\t\tmsdyn_associatedvendorid = msdyn_vendorid,\n\t\tmsdyn_associatedpartyid = VendorParty@msdyn_partyid,\n\t\tmsdyn_employmentprofession,\n\t\tmsdyn_decisionmakingrole,\n\t\tmsdyn_notes,\n\t\tmsdyn_spousename,\n\t\tmsdyn_contactforpartynumber,\n\t\tmsdyn_employmentdepartment,\n\t\tmsdyn_primarysalutationphrase,\n\t\tmsdyn_assistantname,\n\t\tmsdyn_assistantphonenumber,\n\t\tmsdyn_availablefromtime,\n\t\tmsdyn_availabletotime,\n\t\tmsdyn_employmentcomputernetworkname,\n\t\tmsdyn_employmentjobfunctionname,\n\t\tmsdyn_employmentofficelocation,\n\t\tmsdyn_governmentidentificationnumber,\n\t\tmsdyn_identitycardnumber,\n\t\tmsdyn_loyaltylevelphrase,\n\t\tmsdyn_microsoftoutlookcategories,\n\t\tmsdyn_mileagedistance,\n\t\tmsdyn_organizationidentificationnumber,\n\t\tmsdyn_personalcharactertypecode,\n\t\tmsdyn_primarycomplimentaryclosingphrase,\n\t\tmsdyn_jobtitle,\n\t\tmsdyn_employeeresponsible,\n\t\tmsdyn_parentcontactforpartyid = CDSParty@msdyn_partyid,\n\t\tmsdyn_isreceivingdirectmail,\n\t\tmsdyn_isvip,\n\t\tmsdyn_contactactivitysensitivitylevel,\n\t\tmsdyn_hasrequestedinternetaccess\n\t),\n\tpartitionBy('hash', 1),\n\tskipDuplicateMapInputs: true,\n\tskipDuplicateMapOutputs: true) ~> CDSVendorParty\nVendorPartyJoin, CDSParty join(lower(msdyn_parentcontactforpartyid) == lower(CDSParty@msdyn_partynumber),\n\tjoinType:'left',\n\tbroadcast: 'auto')~> ManagerContactForParty\nCDSVendorParty derive(msdyn_contactactivitysensitivitylevel = case(lower(msdyn_contactactivitysensitivitylevel)=='normal',192350000,\r\ncase(lower(msdyn_contactactivitysensitivitylevel)=='personal',192350001,\r\ncase(lower(msdyn_contactactivitysensitivitylevel)=='private',192350002,\r\ncase(lower(msdyn_contactactivitysensitivitylevel)=='confidential',192350003\r\n)))),\n\tpartitionBy('hash', 1)) ~> Enum\nEnum sink(input(\n\t\tColumn_1 as string,\n\t\tColumn_2 as string,\n\t\tColumn_3 as string,\n\t\tColumn_4 as string,\n\t\tColumn_5 as string,\n\t\tColumn_6 as string,\n\t\tColumn_7 as string,\n\t\tColumn_8 as string,\n\t\tColumn_9 as string,\n\t\tColumn_10 as string,\n\t\tColumn_11 as string,\n\t\tColumn_12 as string,\n\t\tColumn_13 as string,\n\t\tColumn_14 as string,\n\t\tColumn_15 as string,\n\t\tColumn_16 as string,\n\t\tColumn_17 as string,\n\t\tColumn_18 as string,\n\t\tColumn_19 as string,\n\t\tColumn_20 as string,\n\t\tColumn_21 as string,\n\t\tColumn_22 as string,\n\t\tColumn_23 as string,\n\t\tColumn_24 as string,\n\t\tColumn_25 as string,\n\t\tColumn_26 as string,\n\t\tColumn_27 as string,\n\t\tColumn_28 as string,\n\t\tColumn_29 as string,\n\t\tColumn_30 as string,\n\t\tColumn_31 as string\n\t),\n\tallowSchemaDrift: true,\n\tvalidateSchema: false,\n\tpartitionFileNames:['ContactForPartyVendor.csv'],\n\tpartitionBy('hash', 1),\n\tskipDuplicateMapInputs: true,\n\tskipDuplicateMapOutputs: true) ~> CDSVendorPartyFile"
                }
            },
            "dependsOn": [
                "[concat(variables('factoryId'), '/datasets/DelimitedTextFiles')]",
                "[concat(variables('factoryId'), '/datasets/DelimitedTextOutput')]"
            ]
        },
        {
            "name": "[concat(parameters('factoryName'), '/PrepareContactForPartyCustomerContact')]",
            "type": "Microsoft.DataFactory/factories/dataflows",
            "apiVersion": "2018-06-01",
            "properties": {
                "type": "MappingDataFlow",
                "typeProperties": {
                    "sources": [
                        {
                            "dataset": {
                                "referenceName": "DelimitedTextFiles",
                                "type": "DatasetReference"
                            },
                            "name": "ContactParty"
                        },
                        {
                            "dataset": {
                                "referenceName": "DelimitedTextFiles",
                                "type": "DatasetReference"
                            },
                            "name": "CDSParty"
                        },
                        {
                            "dataset": {
                                "referenceName": "DelimitedTextFiles",
                                "type": "DatasetReference"
                            },
                            "name": "FOAllContactPerson"
                        },
                        {
                            "dataset": {
                                "referenceName": "DelimitedTextFiles",
                                "type": "DatasetReference"
                            },
                            "name": "CDSAllContact"
                        }
                    ],
                    "sinks": [
                        {
                            "dataset": {
                                "referenceName": "DelimitedTextOutput",
                                "type": "DatasetReference"
                            },
                            "name": "ContactForPartyCustomerContact"
                        }
                    ],
                    "transformations": [
                        {
                            "name": "FOCDSContactPersonCustomerContactJoin"
                        },
                        {
                            "name": "ContactPersonPartyJoin"
                        },
                        {
                            "name": "FOCDSCustomerContact"
                        },
                        {
                            "name": "ContactPartyJoin"
                        },
                        {
                            "name": "CDSContactCustomerParty"
                        },
                        {
                            "name": "ManagerContactForParty"
                        },
                        {
                            "name": "Enum"
                        }
                    ],
                    "script": "source(output(\n\t\tcontactid as string,\n\t\tmsdyn_partyid as string,\n\t\tmsdyn_contactpersonid as string,\n\t\tmsdyn_company as string,\n\t\t{cdm_company1.cdm_companycode} as string,\n\t\tmsdyn_partynumber as string\n\t),\n\tallowSchemaDrift: true,\n\tvalidateSchema: false,\n\tignoreNoFilesFound: false,\n\tpartitionBy('hash', 1)) ~> ContactParty\nsource(output(\n\t\tmsdyn_partyid as string,\n\t\tmsdyn_partytype as integer,\n\t\tmsdyn_partynumber as string\n\t),\n\tallowSchemaDrift: true,\n\tvalidateSchema: false,\n\tignoreNoFilesFound: false,\n\tpartitionBy('hash', 1)) ~> CDSParty\nsource(output(\n\t\tdataAreaId as string,\n\t\tContactPersonId as string,\n\t\tEmploymentOfficeLocation as string,\n\t\tPrimarySalutationPhrase as string,\n\t\tSpouseName as string,\n\t\tIsVIP as boolean,\n\t\tOrganizationIdentificationNumber as string,\n\t\tAssistantPhoneNumber as string,\n\t\tNotes as string,\n\t\tAvailableToTime as integer,\n\t\tIsReceivingDirectMail as boolean,\n\t\tEmploymentJobFunctionName as string,\n\t\tGovernmentIdentificationNumber as string,\n\t\tEmploymentDepartment as string,\n\t\tMileageDistance as string,\n\t\tContactPersonResponsiblePersonnelNumber as short,\n\t\tMicrosoftOutlookCategories as string,\n\t\tAssociatedPartyNumber as string,\n\t\tAvailableFromTime as integer,\n\t\tEmploymentComputerNetworkName as string,\n\t\tLoyaltyLevelPhrase as string,\n\t\tEmploymentJobTitle as string,\n\t\tContactActivitySensitivityLevel as string,\n\t\tHasRequestedInternetAccess as boolean,\n\t\tManagerContactPersonId as string,\n\t\tIdentityCardNumber as string,\n\t\tAssistantName as string,\n\t\tContactPersonPartyNumber as string,\n\t\tEmploymentProfession as string,\n\t\tPrimaryComplimentaryClosingPhrase as string,\n\t\tPersonalCharacterTypeCode as string,\n\t\tDecisionMakingRoleCode as string\n\t),\n\tallowSchemaDrift: true,\n\tvalidateSchema: false,\n\tignoreNoFilesFound: false,\n\tpartitionBy('hash', 1)) ~> FOAllContactPerson\nsource(output(\n\t\tcontactid as string,\n\t\tmsdyn_language as integer,\n\t\tmsdyn_company as string,\n\t\tmsdyn_isvendor as boolean,\n\t\tmsdyn_sellable as boolean,\n\t\t{cdm_company1.cdm_companycode} as string,\n\t\tmsdyn_partynumber as string,\n\t\tfirstname as string,\n\t\tmsdyn_contactforvendor as boolean,\n\t\tlastname as string,\n\t\tmsdyn_contactpersonid as string,\n\t\tmsdyn_birthmonth as boolean,\n\t\tmsdyn_anniversarymonth as boolean,\n\t\tmsdyn_birthyear as boolean,\n\t\tmsdyn_anniversaryyear as boolean,\n\t\tmsdyn_phoneticlastname as string,\n\t\tmsdyn_namealias as string,\n\t\tmsdyn_anniversaryday as boolean,\n\t\tsuffix as string,\n\t\tmsdyn_birthday as boolean,\n\t\tfamilystatuscode as integer,\n\t\tnickname as string,\n\t\tjobtitle as string,\n\t\tmsdyn_linkedvendoraccount as string,\n\t\tmsdyn_lastnameprefix as string,\n\t\tmsdyn_phoneticfirstname as string,\n\t\tmsdyn_phoneticmiddlename as string\n\t),\n\tallowSchemaDrift: true,\n\tvalidateSchema: false,\n\tignoreNoFilesFound: false,\n\tpartitionBy('hash', 1)) ~> CDSAllContact\nFOAllContactPerson, CDSAllContact join(lower(dataAreaId) == lower({cdm_company1.cdm_companycode})\n\t&& lower(ContactPersonId) == lower(msdyn_contactpersonid),\n\tjoinType:'inner',\n\tpartitionBy('hash', 1),\n\tbroadcast: 'auto')~> FOCDSContactPersonCustomerContactJoin\nFOCDSContactPersonCustomerContactJoin, CDSParty join(lower(ContactPersonPartyNumber) == lower(CDSParty@msdyn_partynumber),\n\tjoinType:'inner',\n\tpartitionBy('hash', 1),\n\tbroadcast: 'auto')~> ContactPersonPartyJoin\nContactPersonPartyJoin select(mapColumn(\n\t\tcontactid,\n\t\tmsdyn_contactpartyid = msdyn_partyid,\n\t\tmsdyn_associatedcompanyid = msdyn_company,\n\t\tAssociatedPartyNumber,\n\t\tmsdyn_employmentprofession = EmploymentProfession,\n\t\tmsdyn_decisionmakingrole = DecisionMakingRoleCode,\n\t\tmsdyn_notes = Notes,\n\t\tmsdyn_spousename = SpouseName,\n\t\tmsdyn_contactforpartynumber = ContactPersonId,\n\t\tmsdyn_employmentdepartment = EmploymentDepartment,\n\t\tmsdyn_primarysalutationphrase = PrimarySalutationPhrase,\n\t\tmsdyn_assistantname = AssistantName,\n\t\tmsdyn_assistantphonenumber = AssistantPhoneNumber,\n\t\tmsdyn_availablefromtime = AvailableFromTime,\n\t\tmsdyn_availabletotime = AvailableToTime,\n\t\tmsdyn_employmentcomputernetworkname = EmploymentComputerNetworkName,\n\t\tmsdyn_employmentjobfunctionname = EmploymentJobFunctionName,\n\t\tmsdyn_employmentofficelocation = EmploymentOfficeLocation,\n\t\tmsdyn_governmentidentificationnumber = GovernmentIdentificationNumber,\n\t\tmsdyn_identitycardnumber = IdentityCardNumber,\n\t\tmsdyn_loyaltylevelphrase = LoyaltyLevelPhrase,\n\t\tmsdyn_microsoftoutlookcategories = MicrosoftOutlookCategories,\n\t\tmsdyn_mileagedistance = MileageDistance,\n\t\tmsdyn_organizationidentificationnumber = OrganizationIdentificationNumber,\n\t\tmsdyn_personalcharactertypecode = PersonalCharacterTypeCode,\n\t\tmsdyn_primarycomplimentaryclosingphrase = PrimaryComplimentaryClosingPhrase,\n\t\tmsdyn_jobtitle = EmploymentJobTitle,\n\t\tmsdyn_employeeresponsible = ContactPersonResponsiblePersonnelNumber,\n\t\tmsdyn_isreceivingdirectmail = IsReceivingDirectMail,\n\t\tmsdyn_isvip = IsVIP,\n\t\tmsdyn_contactactivitysensitivitylevel = ContactActivitySensitivityLevel,\n\t\tmsdyn_hasrequestedinternetaccess = HasRequestedInternetAccess,\n\t\tmsdyn_parentcontactforpartyid = ManagerContactPersonId\n\t),\n\tpartitionBy('hash', 1),\n\tskipDuplicateMapInputs: true,\n\tskipDuplicateMapOutputs: true) ~> FOCDSCustomerContact\nFOCDSCustomerContact, ContactParty join(lower(AssociatedPartyNumber) == lower(msdyn_partynumber),\n\tjoinType:'inner',\n\tpartitionBy('hash', 1),\n\tbroadcast: 'auto')~> ContactPartyJoin\nManagerContactForParty select(mapColumn(\n\t\tmsdyn_contactid = FOCDSCustomerContact@contactid,\n\t\tmsdyn_contactpartyid,\n\t\tmsdyn_associatedcompanyid,\n\t\tmsdyn_associatedcontactid = ContactParty@contactid,\n\t\tmsdyn_associatedpartyid = ContactParty@msdyn_partyid,\n\t\tmsdyn_employmentprofession,\n\t\tmsdyn_decisionmakingrole,\n\t\tmsdyn_notes,\n\t\tmsdyn_spousename,\n\t\tmsdyn_contactforpartynumber,\n\t\tmsdyn_employmentdepartment,\n\t\tmsdyn_primarysalutationphrase,\n\t\tmsdyn_assistantname,\n\t\tmsdyn_assistantphonenumber,\n\t\tmsdyn_availablefromtime,\n\t\tmsdyn_availabletotime,\n\t\tmsdyn_employmentcomputernetworkname,\n\t\tmsdyn_employmentjobfunctionname,\n\t\tmsdyn_employmentofficelocation,\n\t\tmsdyn_governmentidentificationnumber,\n\t\tmsdyn_identitycardnumber,\n\t\tmsdyn_loyaltylevelphrase,\n\t\tmsdyn_microsoftoutlookcategories,\n\t\tmsdyn_mileagedistance,\n\t\tmsdyn_organizationidentificationnumber,\n\t\tmsdyn_personalcharactertypecode,\n\t\tmsdyn_primarycomplimentaryclosingphrase,\n\t\tmsdyn_jobtitle,\n\t\tmsdyn_employeeresponsible,\n\t\tmsdyn_parentcontactforpartyid = CDSParty@msdyn_partyid,\n\t\tmsdyn_isreceivingdirectmail,\n\t\tmsdyn_isvip,\n\t\tmsdyn_contactactivitysensitivitylevel,\n\t\tmsdyn_hasrequestedinternetaccess\n\t),\n\tpartitionBy('hash', 1),\n\tskipDuplicateMapInputs: true,\n\tskipDuplicateMapOutputs: true) ~> CDSContactCustomerParty\nContactPartyJoin, CDSParty join(lower(msdyn_parentcontactforpartyid) == lower(CDSParty@msdyn_partynumber),\n\tjoinType:'left',\n\tpartitionBy('hash', 1),\n\tbroadcast: 'auto')~> ManagerContactForParty\nCDSContactCustomerParty derive(msdyn_contactactivitysensitivitylevel = case(lower(msdyn_contactactivitysensitivitylevel)=='normal',192350000,\r\ncase(lower(msdyn_contactactivitysensitivitylevel)=='personal',192350001,\r\ncase(lower(msdyn_contactactivitysensitivitylevel)=='private',192350002,\r\ncase(lower(msdyn_contactactivitysensitivitylevel)=='confidential',192350003\r\n)))),\n\tpartitionBy('hash', 1)) ~> Enum\nEnum sink(input(\n\t\tColumn_1 as string,\n\t\tColumn_2 as string,\n\t\tColumn_3 as string,\n\t\tColumn_4 as string,\n\t\tColumn_5 as string,\n\t\tColumn_6 as string,\n\t\tColumn_7 as string,\n\t\tColumn_8 as string,\n\t\tColumn_9 as string,\n\t\tColumn_10 as string,\n\t\tColumn_11 as string,\n\t\tColumn_12 as string,\n\t\tColumn_13 as string,\n\t\tColumn_14 as string,\n\t\tColumn_15 as string,\n\t\tColumn_16 as string,\n\t\tColumn_17 as string,\n\t\tColumn_18 as string,\n\t\tColumn_19 as string,\n\t\tColumn_20 as string,\n\t\tColumn_21 as string,\n\t\tColumn_22 as string,\n\t\tColumn_23 as string,\n\t\tColumn_24 as string,\n\t\tColumn_25 as string,\n\t\tColumn_26 as string,\n\t\tColumn_27 as string,\n\t\tColumn_28 as string,\n\t\tColumn_29 as string,\n\t\tColumn_30 as string,\n\t\tColumn_31 as string\n\t),\n\tallowSchemaDrift: true,\n\tvalidateSchema: false,\n\tpartitionFileNames:['ContactForPartyCustomerContact.csv'],\n\tpartitionBy('hash', 1),\n\tskipDuplicateMapInputs: true,\n\tskipDuplicateMapOutputs: true) ~> ContactForPartyCustomerContact"
                }
            },
            "dependsOn": [
                "[concat(variables('factoryId'), '/datasets/DelimitedTextFiles')]",
                "[concat(variables('factoryId'), '/datasets/DelimitedTextOutput')]"
            ]
        }
    ]
}