{
    "$schema": "http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#",
    "contentVersion": "1.0.0.0",
    "parameters": {
        "factoryName": {
            "type": "string",
            "metadata": "Data Factory name",
            "defaultValue": ""
        },
        "CRMLinkedService_password": {
            "type": "secureString",
            "metadata": "Secure string for 'password' of 'CRMLinkedService'"
        },
        "AzureBlobStorageService_connectionString": {
            "type": "secureString",
            "metadata": "Secure string for 'connectionString' of 'AzureBlobStorageService'"
        },
        "DynamicsAXService_servicePrincipalKey": {
            "type": "secureString",
            "metadata": "Secure string for 'servicePrincipalKey' of 'DynamicsAXService'"
        },
        "CRMLinkedService_properties_typeProperties_username": {
            "type": "string",
            "defaultValue": ""
        },
        "DynamicsAXService_properties_typeProperties_url": {
            "type": "string",
            "defaultValue": ""
        },
        "DynamicsAXService_properties_typeProperties_tenant": {
            "type": "string",
            "defaultValue": ""
        },
        "DynamicsAXService_properties_typeProperties_aadResourceId": {
            "type": "string",
            "defaultValue": ""
        },
        "DynamicsAXService_properties_typeProperties_servicePrincipalId": {
            "type": "string",
            "defaultValue": ""
        }
    },
    "variables": {
        "factoryId": "[concat('Microsoft.DataFactory/factories/', parameters('factoryName'))]"
    },
    "resources": [
        {
            "name": "[concat(parameters('factoryName'), '/CRMLinkedService')]",
            "type": "Microsoft.DataFactory/factories/linkedServices",
            "apiVersion": "2018-06-01",
            "properties": {
                "description": "CRM Linked service to connect CRM environment",
                "annotations": [],
                "type": "DynamicsCrm",
                "typeProperties": {
                    "deploymentType": "Online",
                    "serviceUri": "",
                    "authenticationType": "Office365",
                    "username": "[parameters('CRMLinkedService_properties_typeProperties_username')]",
                    "password": {
                        "type": "SecureString",
                        "value": "[parameters('CRMLinkedService_password')]"
                    }
                }
            },
            "dependsOn": []
        },
        {
            "name": "[concat(parameters('factoryName'), '/AzureBlobStorageService')]",
            "type": "Microsoft.DataFactory/factories/linkedServices",
            "apiVersion": "2018-06-01",
            "properties": {
                "annotations": [],
                "type": "AzureBlobStorage",
                "typeProperties": {
                    "connectionString": "[parameters('AzureBlobStorageService_connectionString')]"
                }
            },
            "dependsOn": []
        },
        {
            "name": "[concat(parameters('factoryName'), '/DynamicsAXService')]",
            "type": "Microsoft.DataFactory/factories/linkedServices",
            "apiVersion": "2018-06-01",
            "properties": {
                "description": "DynamicsAXService",
                "annotations": [],
                "type": "DynamicsAX",
                "typeProperties": {
                    "url": "[parameters('DynamicsAXService_properties_typeProperties_url')]",
                    "tenant": "[parameters('DynamicsAXService_properties_typeProperties_tenant')]",
                    "aadResourceId": "[parameters('DynamicsAXService_properties_typeProperties_aadResourceId')]",
                    "servicePrincipalId": "[parameters('DynamicsAXService_properties_typeProperties_servicePrincipalId')]",
                    "servicePrincipalKey": {
                        "type": "SecureString",
                        "value": "[parameters('DynamicsAXService_servicePrincipalKey')]"
                    }
                }
            },
            "dependsOn": []
        },
        {
            "name": "[concat(parameters('factoryName'), '/CRMConnection')]",
            "type": "Microsoft.DataFactory/factories/datasets",
            "apiVersion": "2018-06-01",
            "properties": {
                "linkedServiceName": {
                    "referenceName": "CRMLinkedService",
                    "type": "LinkedServiceReference"
                },
                "parameters": {
                    "entityname": {
                        "type": "string"
                    }
                },
                "annotations": [],
                "type": "DynamicsCrmEntity",
                "schema": [],
                "typeProperties": {
                    "entityName": {
                        "value": "@dataset().entityname",
                        "type": "Expression"
                    }
                }
            },
            "dependsOn": [
                "[concat(variables('factoryId'), '/linkedServices/CRMLinkedService')]"
            ]
        },
        {
            "name": "[concat(parameters('factoryName'), '/AzureStorageConnection')]",
            "type": "Microsoft.DataFactory/factories/datasets",
            "apiVersion": "2018-06-01",
            "properties": {
                "linkedServiceName": {
                    "referenceName": "AzureBlobStorageService",
                    "type": "LinkedServiceReference"
                },
                "parameters": {
                    "container": {
                        "type": "string"
                    },
                    "foldername": {
                        "type": "string"
                    },
                    "filename": {
                        "type": "string"
                    }
                },
                "annotations": [],
                "type": "DelimitedText",
                "typeProperties": {
                    "location": {
                        "type": "AzureBlobStorageLocation",
                        "fileName": {
                            "value": "@dataset().filename",
                            "type": "Expression"
                        },
                        "folderPath": {
                            "value": "@dataset().foldername",
                            "type": "Expression"
                        },
                        "container": {
                            "value": "@dataset().container",
                            "type": "Expression"
                        }
                    },
                    "columnDelimiter": ",",
                    "escapeChar": "\\",
                    "firstRowAsHeader": true,
                    "quoteChar": "\""
                },
                "schema": []
            },
            "dependsOn": [
                "[concat(variables('factoryId'), '/linkedServices/AzureBlobStorageService')]"
            ]
        },
        {
            "name": "[concat(parameters('factoryName'), '/DelimitedTextOutput')]",
            "type": "Microsoft.DataFactory/factories/datasets",
            "apiVersion": "2018-06-01",
            "properties": {
                "linkedServiceName": {
                    "referenceName": "AzureBlobStorageService",
                    "type": "LinkedServiceReference"
                },
                "annotations": [],
                "type": "DelimitedText",
                "typeProperties": {
                    "location": {
                        "type": "AzureBlobStorageLocation",
                        "folderPath": "input",
                        "container": "electronicaddress"
                    },
                    "columnDelimiter": ",",
                    "escapeChar": "\\",
                    "firstRowAsHeader": true,
                    "quoteChar": "\""
                },
                "schema": [
                    {
                        "name": "accountid",
                        "type": "String"
                    },
                    {
                        "name": "CompanyCode",
                        "type": "String"
                    },
                    {
                        "name": "accountnumber",
                        "type": "String"
                    },
                    {
                        "name": "name",
                        "type": "String"
                    },
                    {
                        "name": "msdyn_partyid",
                        "type": "String"
                    },
                    {
                        "name": "msdyn_partynumber",
                        "type": "String"
                    },
                    {
                        "name": "PartyNumber",
                        "type": "String"
                    },
                    {
                        "name": "telephone1",
                        "type": "String"
                    },
                    {
                        "name": "websiteurl",
                        "type": "String"
                    },
                    {
                        "name": "msdyn_websiteurldescription",
                        "type": "String"
                    },
                    {
                        "name": "msdyn_primaryfacebookdescription",
                        "type": "String"
                    },
                    {
                        "name": "msdyn_telephone1description",
                        "type": "String"
                    },
                    {
                        "name": "msdyn_primarylinkedindescrption",
                        "type": "String"
                    },
                    {
                        "name": "msdyn_primarylinkedinid",
                        "type": "String"
                    },
                    {
                        "name": "primarytwitterid",
                        "type": "String"
                    },
                    {
                        "name": "msdyn_primarytwitteriddescription",
                        "type": "String"
                    },
                    {
                        "name": "msdyn_emailaddress1description",
                        "type": "String"
                    },
                    {
                        "name": "msdyn_primaryfacebookid",
                        "type": "String"
                    },
                    {
                        "name": "msdyn_telephone1extension",
                        "type": "String"
                    },
                    {
                        "name": "emailaddress2",
                        "type": "String"
                    },
                    {
                        "name": "emailaddress3",
                        "type": "String"
                    },
                    {
                        "name": "emailaddress1",
                        "type": "String"
                    },
                    {
                        "name": "telephone3",
                        "type": "String"
                    },
                    {
                        "name": "msdyn_mappedvendoraccount",
                        "type": "String"
                    }
                ]
            },
            "dependsOn": [
                "[concat(variables('factoryId'), '/linkedServices/AzureBlobStorageService')]"
            ]
        },
        {
            "name": "[concat(parameters('factoryName'), '/DynamicsAXConnection')]",
            "type": "Microsoft.DataFactory/factories/datasets",
            "apiVersion": "2018-06-01",
            "properties": {
                "description": "DynamicsAXConnection",
                "linkedServiceName": {
                    "referenceName": "DynamicsAXService",
                    "type": "LinkedServiceReference"
                },
                "parameters": {
                    "entitypath": {
                        "type": "string"
                    }
                },
                "annotations": [],
                "type": "DynamicsAXResource",
                "schema": [],
                "typeProperties": {
                    "path": {
                        "value": "@dataset().entitypath",
                        "type": "Expression"
                    },
                    "retrieveEnumValuesAsString": true
                }
            },
            "dependsOn": [
                "[concat(variables('factoryId'), '/linkedServices/DynamicsAXService')]"
            ]
        },
        {
            "name": "[concat(parameters('factoryName'), '/ElectronicAddress')]",
            "type": "Microsoft.DataFactory/factories/pipelines",
            "apiVersion": "2018-06-01",
            "properties": {
                "description": "Electronic Address",
                "activities": [
                    {
                        "name": "1-1-Retrieve account from Dataverse",
                        "type": "Copy",
                        "dependsOn": [],
                        "policy": {
                            "timeout": "7.00:00:00",
                            "retry": 0,
                            "retryIntervalInSeconds": 30,
                            "secureOutput": false,
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "source": {
                                "type": "DynamicsCrmSource",
                                "query": "<fetch version=\"1.0\" output-format=\"xml-platform\" mapping=\"logical\" distinct=\"false\">\n  <entity name=\"account\">\n    <attribute name=\"msdyn_partyid\" />\n    <attribute name=\"name\" />\n    <attribute name=\"msdyn_partynumber\" />\n    <attribute name=\"accountnumber\" />\n    <attribute name=\"emailaddress3\" />\n    <attribute name=\"emailaddress2\" />\n    <attribute name=\"emailaddress1\" />\n    <attribute name=\"websiteurl\" />\n    <attribute name=\"msdyn_primaryfacebookdescription\" />\n    <attribute name=\"telephone2\" />\n    <attribute name=\"msdyn_primaryfacebookid\" />\n    <attribute name=\"msdyn_primarytwitteriddescription\" />\n    <attribute name=\"telephone3\" />\n    <attribute name=\"msdyn_telephone1description\" />\n    <attribute name=\"msdyn_telephone1extension\" />\n    <attribute name=\"primarytwitterid\" />\n    <attribute name=\"msdyn_websiteurldescription\" />\n    <attribute name=\"msdyn_primarylinkedinid\" />\n    <attribute name=\"msdyn_emailaddress1description\" />\n    <attribute name=\"telephone1\" />\n    <attribute name=\"msdyn_primarylinkedindescrption\" />\n    <attribute name=\"msdyn_vendorcreatedbyworkflowname\" />\n    <attribute name=\"msdyn_mappedvendoraccount\" />\n    <attribute name=\"fax\" />\n    <attribute name=\"msdyn_faxextension\" />\n    <attribute name=\"msdyn_faxdescription\" />\n    <attribute name=\"accountid\" />\n    <link-entity name=\"msdyn_party\" from=\"msdyn_partyid\" to=\"msdyn_partyid\" link-type=\"inner\">\n      <attribute name=\"msdyn_partynumber\" alias=\"PartyNumber\" />\n    </link-entity>\n    <link-entity name=\"cdm_company\" from=\"cdm_companyid\" to=\"msdyn_company\" link-type=\"outer\">\n      <attribute name=\"cdm_companycode\" alias=\"CompanyCode\" />\n    </link-entity>\n  </entity>\n</fetch>"
                            },
                            "sink": {
                                "type": "DelimitedTextSink",
                                "storeSettings": {
                                    "type": "AzureBlobStorageWriteSettings"
                                },
                                "formatSettings": {
                                    "type": "DelimitedTextWriteSettings",
                                    "quoteAllText": true,
                                    "fileExtension": ".txt"
                                }
                            },
                            "enableStaging": false,
                            "translator": {
                                "type": "TabularTranslator",
                                "mappings": [
                                    {
                                        "source": {
                                            "name": "accountid",
                                            "type": "Guid"
                                        },
                                        "sink": {
                                            "name": "accountid",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "CompanyCode",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "CompanyCode",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "accountnumber",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "accountnumber",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "name",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "name",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "msdyn_partyid",
                                            "type": "Guid"
                                        },
                                        "sink": {
                                            "name": "msdyn_partyid",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "msdyn_partynumber",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "msdyn_partynumber",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "PartyNumber",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "PartyNumber",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "telephone1",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "telephone1",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "websiteurl",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "websiteurl",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "msdyn_websiteurldescription",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "msdyn_websiteurldescription",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "msdyn_faxextension",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "msdyn_faxextension",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "msdyn_faxdescription",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "msdyn_faxdescription",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "msdyn_primaryfacebookdescription",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "msdyn_primaryfacebookdescription",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "msdyn_telephone1description",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "msdyn_telephone1description",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "msdyn_primarytwitteriddescription",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "msdyn_primarytwitteriddescription",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "msdyn_primarylinkedindescrption",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "msdyn_primarylinkedindescrption",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "msdyn_primarylinkedinid",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "msdyn_primarylinkedinid",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "primarytwitterid",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "primarytwitterid",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "msdyn_emailaddress1description",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "msdyn_emailaddress1description",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "fax",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "fax",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "msdyn_primaryfacebookid",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "msdyn_primaryfacebookid",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "msdyn_telephone1extension",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "msdyn_telephone1extension",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "emailaddress2",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "emailaddress2",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "emailaddress3",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "emailaddress3",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "emailaddress1",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "emailaddress1",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "telephone2",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "telephone2",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "telephone3",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "telephone3",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "msdyn_mappedvendoraccount",
                                            "type": "Guid"
                                        },
                                        "sink": {
                                            "name": "msdyn_mappedvendoraccount",
                                            "type": "String"
                                        }
                                    }
                                ]
                            }
                        },
                        "inputs": [
                            {
                                "referenceName": "CRMConnection",
                                "type": "DatasetReference",
                                "parameters": {
                                    "entityname": "account"
                                }
                            }
                        ],
                        "outputs": [
                            {
                                "referenceName": "AzureStorageConnection",
                                "type": "DatasetReference",
                                "parameters": {
                                    "container": "electronicaddress",
                                    "foldername": "input",
                                    "filename": "CDSAccount.csv"
                                }
                            }
                        ]
                    },
                    {
                        "name": "1-2-Retrieve contact from Dataverse",
                        "description": "Retrieve contact from Dataverse",
                        "type": "Copy",
                        "dependsOn": [],
                        "policy": {
                            "timeout": "7.00:00:00",
                            "retry": 0,
                            "retryIntervalInSeconds": 30,
                            "secureOutput": false,
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "source": {
                                "type": "DynamicsCrmSource",
                                "query": "<fetch version=\"1.0\" output-format=\"xml-platform\" mapping=\"logical\" distinct=\"false\">\n  <entity name=\"contact\" >\n    <attribute name=\"msdyn_partyid\" />\n    <attribute name=\"msdyn_partynumber\" />\n    <attribute name=\"contactid\" />\n    <attribute name=\"telephone1\" />\n    <attribute name=\"telephone2\" />\n    <attribute name=\"fax\" />\n    <attribute name=\"msdyn_emailaddress1description\" />\n    <attribute name=\"home2\" />\n    <attribute name=\"msdyn_primarytwitterid\" />\n    <attribute name=\"msdyn_faxdescription\" />\n    <attribute name=\"msdyn_telephone1extension\" />\n    <attribute name=\"msdyn_primaryfacebookid\" />\n    <attribute name=\"msdyn_primaryfacebookdescription\" />\n    <attribute name=\"msdyn_faxextension\" />\n    <attribute name=\"telephone3\" />\n    <attribute name=\"msdyn_primaryinkedinid\" />\n    <attribute name=\"msdyn_primarylinkedindescrption\" />\n    <attribute name=\"msdyn_primaryinkedinid\" />\n    <attribute name=\"emailaddress3\" />\n    <attribute name=\"emailaddress2\" />\n    <attribute name=\"emailaddress1\" />\n    <attribute name=\"websiteurl\" />\n    <attribute name=\"msdyn_websiteurldescription\" />\n    <attribute name=\"msdyn_telephone1description\" />\n    <attribute name=\"msdyn_primarytwitteriddescription\" />\n    <attribute name=\"msdyn_contactforvendor\" />\n    <attribute name=\"msdyn_contactfor\" />\n    <attribute name=\"fullname\" />\n    <attribute name=\"msdyn_sellable\" />\n    <attribute name=\"msdyn_linkedvendoraccount\" />\n    <attribute name=\"msdyn_isvendor\" />\n    <attribute name=\"msdyn_contactpersonid\" />\n    <attribute name=\"mobilephone\" />\n    <link-entity name=\"cdm_company\" from=\"cdm_companyid\" to=\"msdyn_company\" link-type=\"outer\" >\n      <attribute name=\"cdm_companycode\" alias=\"CompanyCode\" />\n    </link-entity>\n    <link-entity name=\"msdyn_party\" from=\"msdyn_partyid\" to=\"msdyn_partyid\" link-type=\"inner\" >\n      <attribute name=\"msdyn_partynumber\" alias=\"PartyNumber\" />\n    </link-entity>\n  </entity>\n</fetch>"
                            },
                            "sink": {
                                "type": "DelimitedTextSink",
                                "storeSettings": {
                                    "type": "AzureBlobStorageWriteSettings"
                                },
                                "formatSettings": {
                                    "type": "DelimitedTextWriteSettings",
                                    "quoteAllText": true,
                                    "fileExtension": ".txt"
                                }
                            },
                            "enableStaging": false,
                            "translator": {
                                "type": "TabularTranslator",
                                "mappings": [
                                    {
                                        "source": {
                                            "name": "msdyn_partynumber",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "msdyn_partynumber",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "msdyn_partyid",
                                            "type": "Guid"
                                        },
                                        "sink": {
                                            "name": "msdyn_partyid",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "msdyn_isvendor",
                                            "type": "Boolean"
                                        },
                                        "sink": {
                                            "name": "msdyn_isvendor",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "emailaddress1",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "emailaddress1",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "emailaddress2",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "emailaddress2",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "emailaddress3",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "emailaddress3",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "msdyn_telephone1description",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "msdyn_telephone1description",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "fullname",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "fullname",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "msdyn_sellable",
                                            "type": "Boolean"
                                        },
                                        "sink": {
                                            "name": "msdyn_sellable",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "msdyn_emailaddress1description",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "msdyn_emailaddress1description",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "msdyn_primarytwitteriddescription",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "msdyn_primarytwitteriddescription",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "msdyn_contactforvendor",
                                            "type": "Boolean"
                                        },
                                        "sink": {
                                            "name": "msdyn_contactforvendor",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "websiteurl",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "websiteurl",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "mobilephone",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "mobilephone",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "contactid",
                                            "type": "Guid"
                                        },
                                        "sink": {
                                            "name": "contactid",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "CompanyCode",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "CompanyCode",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "msdyn_linkedvendoraccount",
                                            "type": "Guid"
                                        },
                                        "sink": {
                                            "name": "msdyn_linkedvendoraccount",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "msdyn_websiteurldescription",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "msdyn_websiteurldescription",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "home2",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "home2",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "telephone2",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "telephone2",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "telephone3",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "telephone3",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "msdyn_primarylinkedindescrption",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "msdyn_primarylinkedindescrption",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "telephone1",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "telephone1",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "msdyn_contactpersonid",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "msdyn_contactpersonid",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "msdyn_primaryfacebookid",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "msdyn_primaryfacebookid",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "fax",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "fax",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "msdyn_faxextension",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "msdyn_faxextension",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "PartyNumber",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "PartyNumber",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "msdyn_primaryfacebookdescription",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "msdyn_primaryfacebookdescription",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "msdyn_faxdescription",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "msdyn_faxdescription",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "msdyn_telephone1extension",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "msdyn_telephone1extension",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "msdyn_primarytwitterid",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "msdyn_primarytwitterid",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "msdyn_primaryinkedinid",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "msdyn_primaryinkedinid",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "msdyn_contactfor",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "msdyn_contactfor",
                                            "type": "String"
                                        }
                                    }
                                ]
                            }
                        },
                        "inputs": [
                            {
                                "referenceName": "CRMConnection",
                                "type": "DatasetReference",
                                "parameters": {
                                    "entityname": "contact"
                                }
                            }
                        ],
                        "outputs": [
                            {
                                "referenceName": "AzureStorageConnection",
                                "type": "DatasetReference",
                                "parameters": {
                                    "container": "electronicaddress",
                                    "foldername": "input",
                                    "filename": "CDSContact.csv"
                                }
                            }
                        ]
                    },
                    {
                        "name": "1-3-Retrieve vendor from Dataverse",
                        "description": "Retrieve vendor from Dataverse",
                        "type": "Copy",
                        "dependsOn": [],
                        "policy": {
                            "timeout": "7.00:00:00",
                            "retry": 0,
                            "retryIntervalInSeconds": 30,
                            "secureOutput": false,
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "source": {
                                "type": "DynamicsCrmSource",
                                "query": "<fetch version=\"1.0\" output-format=\"xml-platform\" mapping=\"logical\" distinct=\"false\">\n  <entity name=\"msdyn_vendor\" >\n    <attribute name=\"msdyn_vendorpartynumber\" />\n    <attribute name=\"msdyn_lastname\" />\n    <attribute name=\"msdyn_partyid\" />\n    <attribute name=\"msdyn_vendoraccountnumber\" />\n    <attribute name=\"msdyn_name\" />\n    <attribute name=\"msdyn_vendorid\" />\n    <attribute name=\"msdyn_firstname\" />\n    <attribute name=\"msdyn_primarytwitter\" />\n    <attribute name=\"msdyn_primarylinkedinpurpose\" />\n    <attribute name=\"msdyn_primarytwitterpurpose\" />\n    <attribute name=\"msdyn_primaryfacebookdescription\" />\n    <attribute name=\"msdyn_primaryurlpurpose\" />\n    <attribute name=\"msdyn_primaryemailaddresspurpose\" />\n    <attribute name=\"msdyn_primaryphonenumberpurpose\" />\n    <attribute name=\"msdyn_primaryemailaddress\" />\n    <attribute name=\"msdyn_primarylinkedindescription\" />\n    <attribute name=\"msdyn_primarylinkedin\" />\n    <attribute name=\"msdyn_primaryfaxnumberpurpose\" />\n    <attribute name=\"msdyn_primaryfacebook\" />\n    <attribute name=\"msdyn_primarytelexpurpose\" />\n    <attribute name=\"msdyn_primarytelex\" />\n    <attribute name=\"msdyn_primarytelexdescription\" />\n    <attribute name=\"msdyn_primaryfacebookpurpose\" />\n    <attribute name=\"msdyn_linkedvendorincontactsentity\" />\n    <attribute name=\"msdyn_pimaryphonenumber\" />\n    <attribute name=\"msdyn_primaryfaxnumberextension\" />\n    <attribute name=\"msdyn_primaryurldescription\" />\n    <attribute name=\"msdyn_primaryemailaddressdescription\" />\n    <attribute name=\"msdyn_primaryfaxnumber\" />\n    <attribute name=\"msdyn_primaryfaxnumberdescription\" />\n    <attribute name=\"msdyn_primaryphonenumberextension\" />\n    <attribute name=\"msdyn_primarytwitterdescription\" />\n    <attribute name=\"msdyn_linkedvendorinaccountsentity\" />\n    <attribute name=\"msdyn_primaryphonenumberdescription\" />\n    <link-entity name=\"cdm_company\" from=\"cdm_companyid\" to=\"msdyn_company\" link-type=\"inner\" >\n      <attribute name=\"cdm_companycode\" alias=\"CompanyCode\" />\n    </link-entity>\n    <link-entity name=\"msdyn_party\" from=\"msdyn_partyid\" to=\"msdyn_partyid\" >\n      <attribute name=\"msdyn_partynumber\" alias=\"PartyNumber\" />\n    </link-entity>\n  </entity>\n</fetch>"
                            },
                            "sink": {
                                "type": "DelimitedTextSink",
                                "storeSettings": {
                                    "type": "AzureBlobStorageWriteSettings"
                                },
                                "formatSettings": {
                                    "type": "DelimitedTextWriteSettings",
                                    "quoteAllText": true,
                                    "fileExtension": ".txt"
                                }
                            },
                            "enableStaging": false,
                            "translator": {
                                "type": "TabularTranslator",
                                "mappings": [
                                    {
                                        "source": {
                                            "name": "CompanyCode",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "CompanyCode",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "msdyn_vendorpartynumber",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "msdyn_vendorpartynumber",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "msdyn_partyid",
                                            "type": "Guid"
                                        },
                                        "sink": {
                                            "name": "msdyn_partyid",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "msdyn_vendoraccountnumber",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "msdyn_vendoraccountnumber",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "msdyn_name",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "msdyn_name",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "msdyn_vendorid",
                                            "type": "Guid"
                                        },
                                        "sink": {
                                            "name": "msdyn_vendorid",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "PartyNumber",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "PartyNumber",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "msdyn_primaryurldescription",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "msdyn_primaryurldescription",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "msdyn_primarytwitter",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "msdyn_primarytwitter",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "msdyn_primarytelex",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "msdyn_primarytelex",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "msdyn_primaryphonenumberextension",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "msdyn_primaryphonenumberextension",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "msdyn_primarytwitterdescription",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "msdyn_primarytwitterdescription",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "msdyn_primaryemailaddress",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "msdyn_primaryemailaddress",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "msdyn_primaryfaxnumber",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "msdyn_primaryfaxnumber",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "msdyn_primaryfacebookdescription",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "msdyn_primaryfacebookdescription",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "msdyn_primarylinkedin",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "msdyn_primarylinkedin",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "msdyn_primarylinkedindescription",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "msdyn_primarylinkedindescription",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "msdyn_primaryfacebook",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "msdyn_primaryfacebook",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "msdyn_primaryemailaddressdescription",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "msdyn_primaryemailaddressdescription",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "msdyn_primarytelexdescription",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "msdyn_primarytelexdescription",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "msdyn_primaryfaxnumberdescription",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "msdyn_primaryfaxnumberdescription",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "msdyn_pimaryphonenumber",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "msdyn_pimaryphonenumber",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "msdyn_primaryfaxnumberextension",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "msdyn_primaryfaxnumberextension",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "msdyn_primaryphonenumberdescription",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "msdyn_primaryphonenumberdescription",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "msdyn_firstname",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "msdyn_firstname",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "msdyn_linkedvendorinaccountsentity",
                                            "type": "Guid"
                                        },
                                        "sink": {
                                            "name": "msdyn_linkedvendorinaccountsentity",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "msdyn_lastname",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "msdyn_lastname",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "msdyn_linkedvendorincontactsentity",
                                            "type": "Guid"
                                        },
                                        "sink": {
                                            "name": "msdyn_linkedvendorincontactsentity",
                                            "type": "String"
                                        }
                                    }
                                ]
                            }
                        },
                        "inputs": [
                            {
                                "referenceName": "CRMConnection",
                                "type": "DatasetReference",
                                "parameters": {
                                    "entityname": "msdyn_vendor"
                                }
                            }
                        ],
                        "outputs": [
                            {
                                "referenceName": "AzureStorageConnection",
                                "type": "DatasetReference",
                                "parameters": {
                                    "container": "electronicaddress",
                                    "foldername": "input",
                                    "filename": "CDSVendor.csv"
                                }
                            }
                        ]
                    },
                    {
                        "name": "1-4-Retrieve electronic address from FO",
                        "description": "Retrieve electronic address from FO",
                        "type": "Copy",
                        "dependsOn": [],
                        "policy": {
                            "timeout": "7.00:00:00",
                            "retry": 0,
                            "retryIntervalInSeconds": 30,
                            "secureOutput": false,
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "source": {
                                "type": "DynamicsAXSource",
                                "httpRequestTimeout": "00:05:00"
                            },
                            "sink": {
                                "type": "DelimitedTextSink",
                                "storeSettings": {
                                    "type": "AzureBlobStorageWriteSettings"
                                },
                                "formatSettings": {
                                    "type": "DelimitedTextWriteSettings",
                                    "quoteAllText": true,
                                    "fileExtension": ".txt"
                                }
                            },
                            "enableStaging": false,
                            "translator": {
                                "type": "TabularTranslator",
                                "mappings": [
                                    {
                                        "source": {
                                            "name": "PartyNumber",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "PartyNumber",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "ElectronicAddressId",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "ElectronicAddressId",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "IsInstantMessage",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "IsInstantMessage",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "IsMobilePhone",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "IsMobilePhone",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "CountryRegionCode",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "CountryRegionCode",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "Purpose",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "Purpose",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "Locator",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "Locator",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "LocatorExtension",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "LocatorExtension",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "LocationId",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "LocationId",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "Description",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "Description",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "IsPrimary",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "IsPrimary",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "Type",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "Type",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "IsPrivate",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "IsPrivate",
                                            "type": "String"
                                        }
                                    }
                                ]
                            }
                        },
                        "inputs": [
                            {
                                "referenceName": "DynamicsAXConnection",
                                "type": "DatasetReference",
                                "parameters": {
                                    "entitypath": "PartyContactsV3"
                                }
                            }
                        ],
                        "outputs": [
                            {
                                "referenceName": "AzureStorageConnection",
                                "type": "DatasetReference",
                                "parameters": {
                                    "container": "electronicaddress",
                                    "foldername": "input",
                                    "filename": "FOElectronicAddress.csv"
                                }
                            }
                        ]
                    },
                    {
                        "name": "2-ConsolidateCDSAddress",
                        "description": "Merge account , contact and vendor electronic addresses",
                        "type": "ExecuteDataFlow",
                        "dependsOn": [
                            {
                                "activity": "1-1-Retrieve account from Dataverse",
                                "dependencyConditions": [
                                    "Succeeded"
                                ]
                            },
                            {
                                "activity": "1-2-Retrieve contact from Dataverse",
                                "dependencyConditions": [
                                    "Succeeded"
                                ]
                            },
                            {
                                "activity": "1-3-Retrieve vendor from Dataverse",
                                "dependencyConditions": [
                                    "Succeeded"
                                ]
                            }
                        ],
                        "policy": {
                            "timeout": "1.00:00:00",
                            "retry": 0,
                            "retryIntervalInSeconds": 30,
                            "secureOutput": false,
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "dataflow": {
                                "referenceName": "ConsolidateAddresses",
                                "type": "DataFlowReference",
                                "parameters": {},
                                "datasetParameters": {
                                    "CDSAccount": {
                                        "container": "electronicaddress",
                                        "foldername": "input",
                                        "filename": "CDSAccount.csv"
                                    },
                                    "CDSContact": {
                                        "container": "electronicaddress",
                                        "foldername": "input",
                                        "filename": "CDSContact.csv"
                                    },
                                    "CDSVendor": {
                                        "container": "electronicaddress",
                                        "foldername": "input",
                                        "filename": "CDSVendor.csv"
                                    },
                                    "CEElectronicAddress": {},
                                    "CENonPrimaryAddress": {}
                                }
                            },
                            "staging": {},
                            "compute": {
                                "coreCount": 8,
                                "computeType": "General"
                            },
                            "traceLevel": "Fine"
                        }
                    },
                    {
                        "name": "3-MergePrimaryAddress",
                        "type": "ExecuteDataFlow",
                        "dependsOn": [
                            {
                                "activity": "2-ConsolidateCDSAddress",
                                "dependencyConditions": [
                                    "Succeeded"
                                ]
                            },
                            {
                                "activity": "1-4-Retrieve electronic address from FO",
                                "dependencyConditions": [
                                    "Succeeded"
                                ]
                            }
                        ],
                        "policy": {
                            "timeout": "1.00:00:00",
                            "retry": 0,
                            "retryIntervalInSeconds": 30,
                            "secureOutput": false,
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "dataflow": {
                                "referenceName": "MergePrimaryAddress",
                                "type": "DataFlowReference",
                                "parameters": {
                                    "IsFOSource": {
                                        "value": "@pipeline().globalParameters.IsFOSource",
                                        "type": "Expression"
                                    }
                                },
                                "datasetParameters": {
                                    "CEPrimaryElectronicAddress": {
                                        "container": "electronicaddress",
                                        "foldername": "input",
                                        "filename": "CEPrimaryElectronicAddress.csv"
                                    },
                                    "FOElectronicAddress": {
                                        "container": "electronicaddress",
                                        "foldername": "input",
                                        "filename": "FOElectronicAddress.csv"
                                    },
                                    "FOCEPrimaryAddress": {}
                                }
                            },
                            "staging": {},
                            "compute": {
                                "coreCount": 8,
                                "computeType": "General"
                            },
                            "traceLevel": "Fine"
                        }
                    },
                    {
                        "name": "4-CreateElectronicAddress",
                        "type": "ExecuteDataFlow",
                        "dependsOn": [
                            {
                                "activity": "3-MergePrimaryAddress",
                                "dependencyConditions": [
                                    "Succeeded"
                                ]
                            },
                            {
                                "activity": "1-5-Retrieve parties from Dataverse",
                                "dependencyConditions": [
                                    "Succeeded"
                                ]
                            },
                            {
                                "activity": "1-6-Retrieve electronic address from Dataverse",
                                "dependencyConditions": [
                                    "Succeeded"
                                ]
                            }
                        ],
                        "policy": {
                            "timeout": "1.00:00:00",
                            "retry": 0,
                            "retryIntervalInSeconds": 30,
                            "secureOutput": false,
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "dataflow": {
                                "referenceName": "CreateFoAddress",
                                "type": "DataFlowReference",
                                "parameters": {
                                    "prefix": {
                                        "value": "'@{pipeline().globalParameters.ElectronicAddressIdPrefix}'",
                                        "type": "Expression"
                                    },
                                    "Source": {
                                        "value": "@pipeline().globalParameters.IsFOSource",
                                        "type": "Expression"
                                    }
                                },
                                "datasetParameters": {
                                    "FOElectronicAddress": {
                                        "container": "electronicaddress",
                                        "foldername": "input",
                                        "filename": "FOElectronicAddress.csv"
                                    },
                                    "CENonPrimaryAddress": {
                                        "container": "electronicaddress",
                                        "foldername": "input",
                                        "filename": "CENonPrimaryAddress.csv"
                                    },
                                    "PrimaryAddress": {
                                        "container": "electronicaddress",
                                        "foldername": "input",
                                        "filename": "PrimaryAddress.csv"
                                    },
                                    "CDSParty": {
                                        "container": "electronicaddress",
                                        "foldername": "input",
                                        "filename": "CDSParty.csv"
                                    },
                                    "CEPrimaryElectronicAddress": {
                                        "container": "electronicaddress",
                                        "foldername": "input",
                                        "filename": "CEPrimaryElectronicAddress.csv"
                                    },
                                    "CDSPartyElectronicAddress": {
                                        "container": "electronicaddress",
                                        "foldername": "input",
                                        "filename": "CDSPartyElectronicAddress.csv"
                                    },
                                    "FONewElectronicAddress": {},
                                    "FOCEElectronicAddress": {}
                                }
                            },
                            "staging": {},
                            "compute": {
                                "coreCount": 8,
                                "computeType": "General"
                            },
                            "traceLevel": "Fine"
                        }
                    },
                    {
                        "name": "1-5-Retrieve parties from Dataverse",
                        "description": "Retrieve party from Dataverse",
                        "type": "Copy",
                        "dependsOn": [],
                        "policy": {
                            "timeout": "7.00:00:00",
                            "retry": 0,
                            "retryIntervalInSeconds": 30,
                            "secureOutput": false,
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "source": {
                                "type": "DynamicsCrmSource",
                                "query": "<fetch version=\"1.0\" output-format=\"xml-platform\" mapping=\"logical\" distinct=\"false\">\n  <entity name=\"msdyn_party\" >\n    <attribute name=\"msdyn_partyid\" />\n    <attribute name=\"msdyn_partynumber\" />\n  </entity>\n</fetch>"
                            },
                            "sink": {
                                "type": "DelimitedTextSink",
                                "storeSettings": {
                                    "type": "AzureBlobStorageWriteSettings"
                                },
                                "formatSettings": {
                                    "type": "DelimitedTextWriteSettings",
                                    "quoteAllText": true,
                                    "fileExtension": ".txt"
                                }
                            },
                            "enableStaging": false,
                            "translator": {
                                "type": "TabularTranslator",
                                "mappings": [
                                    {
                                        "source": {
                                            "name": "msdyn_partyid",
                                            "type": "Guid"
                                        },
                                        "sink": {
                                            "name": "msdyn_partyid",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "msdyn_partynumber",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "msdyn_partynumber",
                                            "type": "String"
                                        }
                                    }
                                ]
                            }
                        },
                        "inputs": [
                            {
                                "referenceName": "CRMConnection",
                                "type": "DatasetReference",
                                "parameters": {
                                    "entityname": "msdyn_party"
                                }
                            }
                        ],
                        "outputs": [
                            {
                                "referenceName": "AzureStorageConnection",
                                "type": "DatasetReference",
                                "parameters": {
                                    "container": "electronicaddress",
                                    "foldername": "input",
                                    "filename": "CDSParty.csv"
                                }
                            }
                        ]
                    },
                    {
                        "name": "5-1-Import electronic address in Dataverse",
                        "description": "Import electronic address in Dataverse",
                        "type": "Copy",
                        "dependsOn": [
                            {
                                "activity": "4-CreateElectronicAddress",
                                "dependencyConditions": [
                                    "Succeeded"
                                ]
                            }
                        ],
                        "policy": {
                            "timeout": "7.00:00:00",
                            "retry": 0,
                            "retryIntervalInSeconds": 30,
                            "secureOutput": false,
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "source": {
                                "type": "DelimitedTextSource",
                                "storeSettings": {
                                    "type": "AzureBlobStorageReadSettings",
                                    "recursive": true,
                                    "enablePartitionDiscovery": false
                                },
                                "formatSettings": {
                                    "type": "DelimitedTextReadSettings"
                                }
                            },
                            "sink": {
                                "type": "DynamicsCrmSink",
                                "writeBatchSize": 500,
                                "writeBehavior": "upsert",
                                "ignoreNullValues": false,
                                "alternateKeyName": ""
                            },
                            "enableStaging": false,
                            "enableSkipIncompatibleRow": true,
                            "logSettings": {
                                "enableCopyActivityLog": true,
                                "copyActivityLogSettings": {
                                    "logLevel": "Warning",
                                    "enableReliableLogging": false
                                },
                                "logLocationSettings": {
                                    "linkedServiceName": {
                                        "referenceName": "AzureBlobStorageService",
                                        "type": "LinkedServiceReference"
                                    },
                                    "path": "electronicaddress/output"
                                }
                            },
                            "translator": {
                                "type": "TabularTranslator",
                                "mappings": [
                                    {
                                        "source": {
                                            "name": "msdyn_partyid",
                                            "type": "String",
                                            "physicalType": "String"
                                        },
                                        "sink": {
                                            "name": "msdyn_partyid",
                                            "type": "Guid"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "ElectronicAddressId",
                                            "type": "String",
                                            "physicalType": "String"
                                        },
                                        "sink": {
                                            "name": "msdyn_electronicaddressnumber",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "IsInstantMessage",
                                            "type": "String",
                                            "physicalType": "String"
                                        },
                                        "sink": {
                                            "name": "msdyn_isinstantmessage",
                                            "type": "Boolean"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "IsMobilePhone",
                                            "type": "String",
                                            "physicalType": "String"
                                        },
                                        "sink": {
                                            "name": "msdyn_ismobile",
                                            "type": "Boolean"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "CountryRegionCode",
                                            "type": "String",
                                            "physicalType": "String"
                                        },
                                        "sink": {
                                            "name": "msdyn_internationalcallingcode",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "Purpose",
                                            "type": "String",
                                            "physicalType": "String"
                                        },
                                        "sink": {
                                            "name": "msdyn_purpose",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "Locator",
                                            "type": "String",
                                            "physicalType": "String"
                                        },
                                        "sink": {
                                            "name": "msdyn_locator",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "LocatorExtension",
                                            "type": "String",
                                            "physicalType": "String"
                                        },
                                        "sink": {
                                            "name": "msdyn_locatorextension",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "Description",
                                            "type": "String",
                                            "physicalType": "String"
                                        },
                                        "sink": {
                                            "name": "msdyn_description",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "Type",
                                            "type": "String",
                                            "physicalType": "String"
                                        },
                                        "sink": {
                                            "name": "msdyn_type",
                                            "type": "Int32"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "IsPrivate",
                                            "type": "String",
                                            "physicalType": "String"
                                        },
                                        "sink": {
                                            "name": "msdyn_isprivate",
                                            "type": "Boolean"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "IsPrimary",
                                            "type": "String",
                                            "physicalType": "String"
                                        },
                                        "sink": {
                                            "name": "msdyn_isprimary",
                                            "type": "Boolean"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "msdyn_partyelectronicaddressid",
                                            "type": "String",
                                            "physicalType": "String"
                                        },
                                        "sink": {
                                            "name": "msdyn_partyelectronicaddressid",
                                            "type": "Guid"
                                        }
                                    }
                                ],
                                "typeConversion": true,
                                "typeConversionSettings": {
                                    "allowDataTruncation": true,
                                    "treatBooleanAsNumber": false
                                }
                            }
                        },
                        "inputs": [
                            {
                                "referenceName": "AzureStorageConnection",
                                "type": "DatasetReference",
                                "parameters": {
                                    "container": "electronicaddress",
                                    "foldername": "input",
                                    "filename": "FOCEElectronicAddress.csv"
                                }
                            }
                        ],
                        "outputs": [
                            {
                                "referenceName": "CRMConnection",
                                "type": "DatasetReference",
                                "parameters": {
                                    "entityname": "msdyn_partyelectronicaddress"
                                }
                            }
                        ]
                    },
                    {
                        "name": "5-2-CE Primary address",
                        "description": "Update account primary electronic address",
                        "type": "ExecuteDataFlow",
                        "dependsOn": [
                            {
                                "activity": "4-CreateElectronicAddress",
                                "dependencyConditions": [
                                    "Succeeded"
                                ]
                            }
                        ],
                        "policy": {
                            "timeout": "1.00:00:00",
                            "retry": 0,
                            "retryIntervalInSeconds": 30,
                            "secureOutput": false,
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "dataflow": {
                                "referenceName": "AccountPrimaryAddress",
                                "type": "DataFlowReference",
                                "parameters": {},
                                "datasetParameters": {
                                    "FOCEElectronicAddress": {
                                        "container": "electronicaddress",
                                        "foldername": "input",
                                        "filename": "FOCEElectronicAddress.csv"
                                    },
                                    "CDSAccount": {
                                        "container": "electronicaddress",
                                        "foldername": "input",
                                        "filename": "CDSAccount.csv"
                                    },
                                    "CDSContact": {
                                        "container": "electronicaddress",
                                        "foldername": "input",
                                        "filename": "CDSContact.csv"
                                    },
                                    "AccountPrimaryAddress": {},
                                    "ContactPrimaryAddress": {}
                                }
                            },
                            "staging": {},
                            "compute": {
                                "coreCount": 8,
                                "computeType": "General"
                            },
                            "traceLevel": "Fine"
                        }
                    },
                    {
                        "name": "6-1-Import account primary address",
                        "description": "Import account primary address",
                        "type": "Copy",
                        "dependsOn": [
                            {
                                "activity": "5-2-CE Primary address",
                                "dependencyConditions": [
                                    "Succeeded"
                                ]
                            }
                        ],
                        "policy": {
                            "timeout": "7.00:00:00",
                            "retry": 0,
                            "retryIntervalInSeconds": 30,
                            "secureOutput": false,
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "source": {
                                "type": "DelimitedTextSource",
                                "storeSettings": {
                                    "type": "AzureBlobStorageReadSettings",
                                    "recursive": true,
                                    "enablePartitionDiscovery": false
                                },
                                "formatSettings": {
                                    "type": "DelimitedTextReadSettings"
                                }
                            },
                            "sink": {
                                "type": "DynamicsCrmSink",
                                "writeBatchSize": 10,
                                "writeBehavior": "upsert"
                            },
                            "enableStaging": false,
                            "enableSkipIncompatibleRow": true,
                            "logSettings": {
                                "enableCopyActivityLog": true,
                                "copyActivityLogSettings": {
                                    "logLevel": "Warning",
                                    "enableReliableLogging": false
                                },
                                "logLocationSettings": {
                                    "linkedServiceName": {
                                        "referenceName": "AzureBlobStorageService",
                                        "type": "LinkedServiceReference"
                                    },
                                    "path": "electronicaddress/output"
                                }
                            },
                            "translator": {
                                "type": "TabularTranslator",
                                "mappings": [
                                    {
                                        "source": {
                                            "name": "accountid",
                                            "type": "String",
                                            "physicalType": "String"
                                        },
                                        "sink": {
                                            "name": "accountid",
                                            "type": "Guid"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "emailaddress1",
                                            "type": "String",
                                            "physicalType": "String"
                                        },
                                        "sink": {
                                            "name": "emailaddress1",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "msdyn_emailaddress1description",
                                            "type": "String",
                                            "physicalType": "String"
                                        },
                                        "sink": {
                                            "name": "msdyn_emailaddress1description",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "telephone1",
                                            "type": "String",
                                            "physicalType": "String"
                                        },
                                        "sink": {
                                            "name": "telephone1",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "msdyn_telephone1extension",
                                            "type": "String",
                                            "physicalType": "String"
                                        },
                                        "sink": {
                                            "name": "msdyn_telephone1extension",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "msdyn_telephone1description",
                                            "type": "String",
                                            "physicalType": "String"
                                        },
                                        "sink": {
                                            "name": "msdyn_telephone1description",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "fax",
                                            "type": "String",
                                            "physicalType": "String"
                                        },
                                        "sink": {
                                            "name": "fax",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "msdyn_faxdescription",
                                            "type": "String",
                                            "physicalType": "String"
                                        },
                                        "sink": {
                                            "name": "msdyn_faxdescription",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "msdyn_faxextension",
                                            "type": "String",
                                            "physicalType": "String"
                                        },
                                        "sink": {
                                            "name": "msdyn_faxextension",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "websiteurl",
                                            "type": "String",
                                            "physicalType": "String"
                                        },
                                        "sink": {
                                            "name": "websiteurl",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "msdyn_websiteurldescription",
                                            "type": "String",
                                            "physicalType": "String"
                                        },
                                        "sink": {
                                            "name": "msdyn_websiteurldescription",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "primarytwitterid",
                                            "type": "String",
                                            "physicalType": "String"
                                        },
                                        "sink": {
                                            "name": "primarytwitterid",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "msdyn_primarytwitteriddescription",
                                            "type": "String",
                                            "physicalType": "String"
                                        },
                                        "sink": {
                                            "name": "msdyn_primarytwitteriddescription",
                                            "type": "String"
                                        }
                                    }
                                ],
                                "typeConversion": true,
                                "typeConversionSettings": {
                                    "allowDataTruncation": true,
                                    "treatBooleanAsNumber": false
                                }
                            }
                        },
                        "inputs": [
                            {
                                "referenceName": "AzureStorageConnection",
                                "type": "DatasetReference",
                                "parameters": {
                                    "container": "electronicaddress",
                                    "foldername": "input",
                                    "filename": "AccountPrimaryAddress.csv"
                                }
                            }
                        ],
                        "outputs": [
                            {
                                "referenceName": "CRMConnection",
                                "type": "DatasetReference",
                                "parameters": {
                                    "entityname": "account"
                                }
                            }
                        ]
                    },
                    {
                        "name": "6-2-Import contact primary address",
                        "description": "Import contact primary address",
                        "type": "Copy",
                        "dependsOn": [
                            {
                                "activity": "5-2-CE Primary address",
                                "dependencyConditions": [
                                    "Succeeded"
                                ]
                            }
                        ],
                        "policy": {
                            "timeout": "7.00:00:00",
                            "retry": 0,
                            "retryIntervalInSeconds": 30,
                            "secureOutput": false,
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "source": {
                                "type": "DelimitedTextSource",
                                "storeSettings": {
                                    "type": "AzureBlobStorageReadSettings",
                                    "recursive": true,
                                    "enablePartitionDiscovery": false
                                },
                                "formatSettings": {
                                    "type": "DelimitedTextReadSettings"
                                }
                            },
                            "sink": {
                                "type": "DynamicsCrmSink",
                                "writeBatchSize": 10,
                                "writeBehavior": "upsert"
                            },
                            "enableStaging": false,
                            "enableSkipIncompatibleRow": true,
                            "logSettings": {
                                "enableCopyActivityLog": true,
                                "copyActivityLogSettings": {
                                    "logLevel": "Warning",
                                    "enableReliableLogging": false
                                },
                                "logLocationSettings": {
                                    "linkedServiceName": {
                                        "referenceName": "AzureBlobStorageService",
                                        "type": "LinkedServiceReference"
                                    },
                                    "path": "electronicaddress/output"
                                }
                            },
                            "translator": {
                                "type": "TabularTranslator",
                                "mappings": [
                                    {
                                        "source": {
                                            "name": "contactid",
                                            "type": "String",
                                            "physicalType": "String"
                                        },
                                        "sink": {
                                            "name": "contactid",
                                            "type": "Guid"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "emailaddress1",
                                            "type": "String",
                                            "physicalType": "String"
                                        },
                                        "sink": {
                                            "name": "emailaddress1",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "msdyn_emailaddress1description",
                                            "type": "String",
                                            "physicalType": "String"
                                        },
                                        "sink": {
                                            "name": "msdyn_emailaddress1description",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "telephone1",
                                            "type": "String",
                                            "physicalType": "String"
                                        },
                                        "sink": {
                                            "name": "telephone1",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "msdyn_telephone1description",
                                            "type": "String",
                                            "physicalType": "String"
                                        },
                                        "sink": {
                                            "name": "msdyn_telephone1description",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "msdyn_telephone1extension",
                                            "type": "String",
                                            "physicalType": "String"
                                        },
                                        "sink": {
                                            "name": "msdyn_telephone1extension",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "fax",
                                            "type": "String",
                                            "physicalType": "String"
                                        },
                                        "sink": {
                                            "name": "fax",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "msdyn_faxdescription",
                                            "type": "String",
                                            "physicalType": "String"
                                        },
                                        "sink": {
                                            "name": "msdyn_faxdescription",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "msdyn_faxextension",
                                            "type": "String",
                                            "physicalType": "String"
                                        },
                                        "sink": {
                                            "name": "msdyn_faxextension",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "websiteurl",
                                            "type": "String",
                                            "physicalType": "String"
                                        },
                                        "sink": {
                                            "name": "websiteurl",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "msdyn_websiteurldescription",
                                            "type": "String",
                                            "physicalType": "String"
                                        },
                                        "sink": {
                                            "name": "msdyn_websiteurldescription",
                                            "type": "String"
                                        }
                                    }
                                ],
                                "typeConversion": true,
                                "typeConversionSettings": {
                                    "allowDataTruncation": true,
                                    "treatBooleanAsNumber": false
                                }
                            }
                        },
                        "inputs": [
                            {
                                "referenceName": "AzureStorageConnection",
                                "type": "DatasetReference",
                                "parameters": {
                                    "container": "electronicaddress",
                                    "foldername": "input",
                                    "filename": "ContactPrimaryAddress.csv"
                                }
                            }
                        ],
                        "outputs": [
                            {
                                "referenceName": "CRMConnection",
                                "type": "DatasetReference",
                                "parameters": {
                                    "entityname": "contact"
                                }
                            }
                        ]
                    },
                    {
                        "name": "1-6-Retrieve electronic address from Dataverse",
                        "description": "Retrieve electronic address from Dataverse",
                        "type": "Copy",
                        "dependsOn": [],
                        "policy": {
                            "timeout": "7.00:00:00",
                            "retry": 0,
                            "retryIntervalInSeconds": 30,
                            "secureOutput": false,
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "source": {
                                "type": "DynamicsCrmSource",
                                "query": "<fetch version=\"1.0\" output-format=\"xml-platform\" mapping=\"logical\" distinct=\"false\">\n<entity name=\"msdyn_partyelectronicaddress\">\n<attribute name=\"msdyn_partyelectronicaddressid\"/>\n<attribute name=\"msdyn_electronicaddressnumber\"/>\n<attribute name=\"msdyn_partyid\"/>\n<order attribute=\"msdyn_electronicaddressnumber\" descending=\"false\"/>\n<link-entity name=\"msdyn_party\" from=\"msdyn_partyid\" to=\"msdyn_partyid\" link-type=\"inner\" alias=\"aa\">\n<attribute name=\"msdyn_partynumber\"/>\n</link-entity>\n</entity>\n</fetch>"
                            },
                            "sink": {
                                "type": "DelimitedTextSink",
                                "storeSettings": {
                                    "type": "AzureBlobStorageWriteSettings"
                                },
                                "formatSettings": {
                                    "type": "DelimitedTextWriteSettings",
                                    "quoteAllText": true,
                                    "fileExtension": ".txt"
                                }
                            },
                            "enableStaging": false,
                            "translator": {
                                "type": "TabularTranslator",
                                "mappings": [
                                    {
                                        "source": {
                                            "name": "msdyn_partyelectronicaddressid",
                                            "type": "Guid"
                                        },
                                        "sink": {
                                            "name": "msdyn_partyelectronicaddressid",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "msdyn_electronicaddressnumber",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "msdyn_electronicaddressnumber",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "msdyn_partyid",
                                            "type": "Guid"
                                        },
                                        "sink": {
                                            "name": "msdyn_partyid",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "aa.msdyn_partynumber",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "aa.msdyn_partynumber",
                                            "type": "String"
                                        }
                                    }
                                ]
                            }
                        },
                        "inputs": [
                            {
                                "referenceName": "CRMConnection",
                                "type": "DatasetReference",
                                "parameters": {
                                    "entityname": "msdyn_partyelectronicaddress"
                                }
                            }
                        ],
                        "outputs": [
                            {
                                "referenceName": "AzureStorageConnection",
                                "type": "DatasetReference",
                                "parameters": {
                                    "container": "electronicaddress",
                                    "foldername": "input",
                                    "filename": "CDSPartyElectronicAddress.csv"
                                }
                            }
                        ]
                    }
                ],
                "policy": {
                    "elapsedTimeMetric": {},
                    "cancelAfter": {}
                },
                "annotations": [],
                "lastPublishTime": "2022-04-21T21:23:24Z"
            },
            "dependsOn": [
                "[concat(variables('factoryId'), '/datasets/CRMConnection')]",
                "[concat(variables('factoryId'), '/datasets/AzureStorageConnection')]",
                "[concat(variables('factoryId'), '/datasets/DynamicsAXConnection')]",
                "[concat(variables('factoryId'), '/dataflows/ConsolidateAddresses')]",
                "[concat(variables('factoryId'), '/dataflows/MergePrimaryAddress')]",
                "[concat(variables('factoryId'), '/dataflows/CreateFoAddress')]",
                "[concat(variables('factoryId'), '/dataflows/AccountPrimaryAddress')]",
                "[concat(variables('factoryId'), '/linkedServices/AzureBlobStorageService')]"
            ]
        },
        {
            "name": "[concat(parameters('factoryName'), '/DWMapValidation')]",
            "type": "Microsoft.DataFactory/factories/dataflows",
            "apiVersion": "2018-06-01",
            "properties": {
                "type": "MappingDataFlow",
                "typeProperties": {
                    "sources": [
                        {
                            "dataset": {
                                "referenceName": "AzureStorageConnection",
                                "type": "DatasetReference"
                            },
                            "name": "DWMap"
                        }
                    ],
                    "sinks": [
                        {
                            "dataset": {
                                "referenceName": "AzureStorageConnection",
                                "type": "DatasetReference"
                            },
                            "name": "DWEnabledMaps"
                        }
                    ],
                    "transformations": [
                        {
                            "name": "FilterDWMap"
                        },
                        {
                            "name": "MapEntityName"
                        }
                    ],
                    "scriptLines": [
                        "source(output(",
                        "          statecode as boolean,",
                        "          msdyn_internalentityname as string,",
                        "          msdyn_dualwriteruntimeconfigid as string,",
                        "          msdyn_externalentityname as string,",
                        "          statuscode as boolean,",
                        "          msdyn_name as string",
                        "     ),",
                        "     allowSchemaDrift: true,",
                        "     validateSchema: false,",
                        "     ignoreNoFilesFound: false) ~> DWMap",
                        "DWMap filter(lower(msdyn_internalentityname)==\"msdyn_party\" || lower(msdyn_internalentityname)==\"msdyn_contactforparty\" || lower(msdyn_internalentityname)==\"account\"  ||lower(msdyn_internalentityname)==\"contact\" || lower(msdyn_internalentityname)==\"msdyn_vendor\" ||\r",
                        "lower(msdyn_internalentityname)==\"msdyn_postaladdresscollection\"  || lower(msdyn_internalentityname)==\"msdyn_partypostaladdress\" || lower(msdyn_internalentityname)==\"msdyn_postaladdress\" || lower(msdyn_internalentityname)==\"customeraddress\" ||\r",
                        "lower(msdyn_internalentityname)==\"msdyn_partyelectronicaddress\") ~> FilterDWMap",
                        "FilterDWMap select(mapColumn(",
                        "          msdyn_internalentityname",
                        "     ),",
                        "     skipDuplicateMapInputs: true,",
                        "     skipDuplicateMapOutputs: true) ~> MapEntityName",
                        "MapEntityName sink(allowSchemaDrift: true,",
                        "     validateSchema: false,",
                        "     partitionFileNames:['DWEnabledMaps.csv'],",
                        "     skipDuplicateMapInputs: true,",
                        "     skipDuplicateMapOutputs: true,",
                        "     partitionBy('hash', 1)) ~> DWEnabledMaps"
                    ]
                }
            },
            "dependsOn": [
                "[concat(variables('factoryId'), '/datasets/AzureStorageConnection')]"
            ]
        },
        {
            "name": "[concat(parameters('factoryName'), '/AccountPrimaryAddress')]",
            "type": "Microsoft.DataFactory/factories/dataflows",
            "apiVersion": "2018-06-01",
            "properties": {
                "description": "Update account primary address",
                "type": "MappingDataFlow",
                "typeProperties": {
                    "sources": [
                        {
                            "dataset": {
                                "referenceName": "AzureStorageConnection",
                                "type": "DatasetReference"
                            },
                            "name": "FOCEElectronicAddress"
                        },
                        {
                            "dataset": {
                                "referenceName": "AzureStorageConnection",
                                "type": "DatasetReference"
                            },
                            "name": "CDSAccount"
                        },
                        {
                            "dataset": {
                                "referenceName": "AzureStorageConnection",
                                "type": "DatasetReference"
                            },
                            "name": "CDSContact"
                        }
                    ],
                    "sinks": [
                        {
                            "dataset": {
                                "referenceName": "DelimitedTextOutput",
                                "type": "DatasetReference"
                            },
                            "name": "AccountPrimaryAddress"
                        },
                        {
                            "dataset": {
                                "referenceName": "DelimitedTextOutput",
                                "type": "DatasetReference"
                            },
                            "name": "ContactPrimaryAddress"
                        }
                    ],
                    "transformations": [
                        {
                            "name": "PrimaryElectronicAddress"
                        },
                        {
                            "name": "ElectornicAddressAttribute"
                        },
                        {
                            "name": "PartyEmail"
                        },
                        {
                            "name": "PartyPhone"
                        },
                        {
                            "name": "PartyEmailPhone"
                        },
                        {
                            "name": "PartyEmailAddress1"
                        },
                        {
                            "name": "PartyTelephone1"
                        },
                        {
                            "name": "PartyTwitter"
                        },
                        {
                            "name": "PartyTwitterPrimary"
                        },
                        {
                            "name": "PartyPhonTwitter"
                        },
                        {
                            "name": "PartyFax"
                        },
                        {
                            "name": "PartyFaxPrimary"
                        },
                        {
                            "name": "PartyTwitterFax"
                        },
                        {
                            "name": "PartyURL"
                        },
                        {
                            "name": "PartyURLPrimary"
                        },
                        {
                            "name": "PartyFaxURL"
                        },
                        {
                            "name": "FOCEPrimaryAddress"
                        },
                        {
                            "name": "AccoountPrimaryAddressUpdate"
                        },
                        {
                            "name": "AccontPrimaryAddressFields"
                        },
                        {
                            "name": "ContactPrimaryAddressUpdate"
                        },
                        {
                            "name": "ContactPrimaryAddressFields"
                        }
                    ],
                    "script": "source(output(\n\t\tPartyNumber as string,\n\t\tElectronicAddressId as string,\n\t\tIsInstantMessage as boolean,\n\t\tIsMobilePhone as boolean,\n\t\tCountryRegionCode as string,\n\t\tPurpose as string,\n\t\tLocator as string,\n\t\tLocatorExtension as string,\n\t\tLocationId as string,\n\t\tDescription as string,\n\t\tIsPrimary as boolean,\n\t\tType as string,\n\t\tIsPrivate as boolean,\n\t\tmsdyn_partyid as string,\n\t\tmsdyn_partynumber as string\n\t),\n\tallowSchemaDrift: true,\n\tvalidateSchema: false,\n\tignoreNoFilesFound: false) ~> FOCEElectronicAddress\nsource(output(\n\t\taccountid as string,\n\t\tCompanyCode as string,\n\t\taccountnumber as string,\n\t\tname as string,\n\t\tmsdyn_partyid as string,\n\t\tmsdyn_partynumber as string,\n\t\tPartyNumber as string,\n\t\ttelephone1 as string,\n\t\twebsiteurl as string,\n\t\tmsdyn_websiteurldescription as string,\n\t\tmsdyn_faxextension as string,\n\t\tmsdyn_faxdescription as string,\n\t\tmsdyn_primaryfacebookdescription as string,\n\t\tmsdyn_telephone1description as string,\n\t\tmsdyn_primarytwitteriddescription as string,\n\t\tmsdyn_primarylinkedindescrption as string,\n\t\tmsdyn_primarylinkedinid as string,\n\t\tprimarytwitterid as string,\n\t\tmsdyn_emailaddress1description as string,\n\t\tfax as string,\n\t\tmsdyn_primaryfacebookid as string,\n\t\tmsdyn_telephone1extension as string,\n\t\temailaddress2 as string,\n\t\temailaddress3 as string,\n\t\temailaddress1 as string,\n\t\ttelephone2 as string,\n\t\ttelephone3 as string,\n\t\tmsdyn_mappedvendoraccount as string\n\t),\n\tallowSchemaDrift: true,\n\tvalidateSchema: false,\n\tignoreNoFilesFound: false) ~> CDSAccount\nsource(output(\n\t\tmsdyn_sellable as boolean,\n\t\tfullname as string,\n\t\tcontactid as string,\n\t\tCompanyCode as string,\n\t\tmsdyn_isvendor as boolean,\n\t\tmsdyn_contactpersonid as string,\n\t\tmsdyn_partyid as string,\n\t\tmsdyn_partynumber as string,\n\t\tmsdyn_contactforvendor as boolean,\n\t\tPartyNumber as string,\n\t\temailaddress1 as string,\n\t\temailaddress2 as string,\n\t\temailaddress3 as string,\n\t\tmsdyn_telephone1description as string,\n\t\tmsdyn_emailaddress1description as string,\n\t\tmsdyn_primarytwitteriddescription as string,\n\t\twebsiteurl as string,\n\t\tmsdyn_websiteurldescription as string,\n\t\thome2 as string,\n\t\ttelephone2 as string,\n\t\ttelephone3 as string,\n\t\tmsdyn_primarylinkedindescrption as string,\n\t\ttelephone1 as string,\n\t\tmsdyn_primaryfacebookid as string,\n\t\tfax as string,\n\t\tmsdyn_faxextension as string,\n\t\tmsdyn_primaryfacebookdescription as string,\n\t\tmsdyn_faxdescription as string,\n\t\tmsdyn_telephone1extension as string,\n\t\tmsdyn_primarytwitterid as string,\n\t\tmsdyn_primaryinkedinid as string,\n\t\tmsdyn_contactfor as string,\n\t\tmsdyn_linkedvendoraccount as string\n\t),\n\tallowSchemaDrift: true,\n\tvalidateSchema: false,\n\tignoreNoFilesFound: false) ~> CDSContact\nFOCEElectronicAddress filter(IsPrimary && !isNull(msdyn_partynumber) && msdyn_partynumber!=\"\") ~> PrimaryElectronicAddress\nPrimaryElectronicAddress select(mapColumn(\n\t\tPartyNumber,\n\t\tLocator,\n\t\tLocatorExtension,\n\t\tDescription,\n\t\tmsdyn_partyid,\n\t\tType\n\t),\n\tskipDuplicateMapInputs: true,\n\tskipDuplicateMapOutputs: true) ~> ElectornicAddressAttribute\nElectornicAddressAttribute filter(lower(Type)==\"192350002\") ~> PartyEmail\nElectornicAddressAttribute filter(lower(Type)==\"192350001\") ~> PartyPhone\nPartyEmailAddress1, PartyTelephone1 join(PartyEmailAddress1@PartyNumber == PartyTelephone1@PartyNumber,\n\tjoinType:'outer',\n\tbroadcast: 'auto')~> PartyEmailPhone\nPartyEmail select(mapColumn(\n\t\tPartyNumber,\n\t\temailaddress1 = Locator,\n\t\tmsdyn_emailaddress1description = Description,\n\t\tType\n\t),\n\tskipDuplicateMapInputs: true,\n\tskipDuplicateMapOutputs: true) ~> PartyEmailAddress1\nPartyPhone select(mapColumn(\n\t\tPartyNumber,\n\t\ttelephone1 = Locator,\n\t\tmsdyn_telephone1extension = LocatorExtension,\n\t\tmsdyn_telephone1description = Description\n\t),\n\tskipDuplicateMapInputs: true,\n\tskipDuplicateMapOutputs: true) ~> PartyTelephone1\nElectornicAddressAttribute filter(lower(Type)==\"192350007\") ~> PartyTwitter\nPartyTwitter select(mapColumn(\n\t\tPartyNumber,\n\t\tprimarytwitterid = Locator,\n\t\tmsdyn_primarytwitteriddescription = Description\n\t),\n\tskipDuplicateMapInputs: true,\n\tskipDuplicateMapOutputs: true) ~> PartyTwitterPrimary\nPartyEmailPhone, PartyTwitterPrimary join(PartyEmailAddress1@PartyNumber == PartyTwitterPrimary@PartyNumber,\n\tjoinType:'outer',\n\tbroadcast: 'auto')~> PartyPhonTwitter\nElectornicAddressAttribute filter(lower(Type)==\"192350005\") ~> PartyFax\nPartyFax select(mapColumn(\n\t\tPartyNumber,\n\t\tfax = Locator,\n\t\tmsdyn_faxdescription = Description,\n\t\tmsdyn_faxextension = LocatorExtension\n\t),\n\tskipDuplicateMapInputs: true,\n\tskipDuplicateMapOutputs: true) ~> PartyFaxPrimary\nPartyPhonTwitter, PartyFaxPrimary join(PartyEmailAddress1@PartyNumber == PartyFaxPrimary@PartyNumber,\n\tjoinType:'outer',\n\tbroadcast: 'auto')~> PartyTwitterFax\nElectornicAddressAttribute filter(lower(Type)==\"192350003\") ~> PartyURL\nPartyURL select(mapColumn(\n\t\tPartyNumber,\n\t\twebsiteurl = Locator,\n\t\tmsdyn_websiteurldescription = Description\n\t),\n\tskipDuplicateMapInputs: true,\n\tskipDuplicateMapOutputs: true) ~> PartyURLPrimary\nPartyTwitterFax, PartyURLPrimary join(PartyEmailAddress1@PartyNumber == PartyURLPrimary@PartyNumber,\n\tjoinType:'outer',\n\tbroadcast: 'auto')~> PartyFaxURL\nPartyFaxURL select(mapColumn(\n\t\tPartyNumber = PartyEmailAddress1@PartyNumber,\n\t\temailaddress1,\n\t\tmsdyn_emailaddress1description,\n\t\ttelephone1,\n\t\tmsdyn_telephone1extension,\n\t\tmsdyn_telephone1description,\n\t\tPartyNumber = PartyTwitterPrimary@PartyNumber,\n\t\tprimarytwitterid,\n\t\tmsdyn_primarytwitteriddescription,\n\t\tfax,\n\t\tmsdyn_faxdescription,\n\t\tmsdyn_faxextension,\n\t\twebsiteurl,\n\t\tmsdyn_websiteurldescription\n\t),\n\tskipDuplicateMapInputs: true,\n\tskipDuplicateMapOutputs: true) ~> FOCEPrimaryAddress\nCDSAccount, FOCEPrimaryAddress join(lower(CDSAccount@PartyNumber) == lower(FOCEPrimaryAddress@PartyNumber),\n\tjoinType:'inner',\n\tbroadcast: 'auto')~> AccoountPrimaryAddressUpdate\nAccoountPrimaryAddressUpdate select(mapColumn(\n\t\taccountid,\n\t\temailaddress1 = FOCEPrimaryAddress@emailaddress1,\n\t\tmsdyn_emailaddress1description = FOCEPrimaryAddress@msdyn_emailaddress1description,\n\t\ttelephone1 = FOCEPrimaryAddress@telephone1,\n\t\tmsdyn_telephone1extension = FOCEPrimaryAddress@msdyn_telephone1extension,\n\t\tmsdyn_telephone1description = FOCEPrimaryAddress@msdyn_telephone1description,\n\t\tprimarytwitterid = FOCEPrimaryAddress@primarytwitterid,\n\t\tmsdyn_primarytwitteriddescription = FOCEPrimaryAddress@msdyn_primarytwitteriddescription,\n\t\tfax = FOCEPrimaryAddress@fax,\n\t\tmsdyn_faxdescription = FOCEPrimaryAddress@msdyn_faxdescription,\n\t\tmsdyn_faxextension = FOCEPrimaryAddress@msdyn_faxextension,\n\t\twebsiteurl = FOCEPrimaryAddress@websiteurl,\n\t\tmsdyn_websiteurldescription = FOCEPrimaryAddress@msdyn_websiteurldescription\n\t),\n\tskipDuplicateMapInputs: true,\n\tskipDuplicateMapOutputs: true) ~> AccontPrimaryAddressFields\nCDSContact, FOCEPrimaryAddress join(lower(msdyn_partynumber) == lower(FOCEPrimaryAddress@PartyNumber),\n\tjoinType:'inner',\n\tbroadcast: 'auto')~> ContactPrimaryAddressUpdate\nContactPrimaryAddressUpdate select(mapColumn(\n\t\tcontactid,\n\t\temailaddress1 = FOCEPrimaryAddress@emailaddress1,\n\t\tmsdyn_emailaddress1description = FOCEPrimaryAddress@msdyn_emailaddress1description,\n\t\ttelephone1 = FOCEPrimaryAddress@telephone1,\n\t\tmsdyn_telephone1extension = FOCEPrimaryAddress@msdyn_telephone1extension,\n\t\tmsdyn_telephone1description = FOCEPrimaryAddress@msdyn_telephone1description,\n\t\tfax = FOCEPrimaryAddress@fax,\n\t\tmsdyn_faxdescription = FOCEPrimaryAddress@msdyn_faxdescription,\n\t\tmsdyn_faxextension = FOCEPrimaryAddress@msdyn_faxextension,\n\t\twebsiteurl = FOCEPrimaryAddress@websiteurl,\n\t\tmsdyn_websiteurldescription = FOCEPrimaryAddress@msdyn_websiteurldescription\n\t),\n\tskipDuplicateMapInputs: true,\n\tskipDuplicateMapOutputs: true) ~> ContactPrimaryAddressFields\nAccontPrimaryAddressFields sink(allowSchemaDrift: true,\n\tvalidateSchema: false,\n\tinput(\n\t\taccountid as string,\n\t\tCompanyCode as string,\n\t\taccountnumber as string,\n\t\tname as string,\n\t\tmsdyn_partyid as string,\n\t\tmsdyn_partynumber as string,\n\t\tPartyNumber as string,\n\t\ttelephone1 as string,\n\t\twebsiteurl as string,\n\t\tmsdyn_websiteurldescription as string,\n\t\tmsdyn_primaryfacebookdescription as string,\n\t\tmsdyn_telephone1description as string,\n\t\tmsdyn_primarylinkedindescrption as string,\n\t\tmsdyn_primarylinkedinid as string,\n\t\tprimarytwitterid as string,\n\t\tmsdyn_primarytwitteriddescription as string,\n\t\tmsdyn_emailaddress1description as string,\n\t\tmsdyn_primaryfacebookid as string,\n\t\tmsdyn_telephone1extension as string,\n\t\temailaddress2 as string,\n\t\temailaddress3 as string,\n\t\temailaddress1 as string,\n\t\ttelephone3 as string,\n\t\tmsdyn_mappedvendoraccount as string\n\t),\n\tpartitionFileNames:['AccountPrimaryAddress.csv'],\n\tskipDuplicateMapInputs: true,\n\tskipDuplicateMapOutputs: true,\n\tpartitionBy('hash', 1)) ~> AccountPrimaryAddress\nContactPrimaryAddressFields sink(allowSchemaDrift: true,\n\tvalidateSchema: false,\n\tinput(\n\t\taccountid as string,\n\t\tCompanyCode as string,\n\t\taccountnumber as string,\n\t\tname as string,\n\t\tmsdyn_partyid as string,\n\t\tmsdyn_partynumber as string,\n\t\tPartyNumber as string,\n\t\ttelephone1 as string,\n\t\twebsiteurl as string,\n\t\tmsdyn_websiteurldescription as string,\n\t\tmsdyn_primaryfacebookdescription as string,\n\t\tmsdyn_telephone1description as string,\n\t\tmsdyn_primarylinkedindescrption as string,\n\t\tmsdyn_primarylinkedinid as string,\n\t\tprimarytwitterid as string,\n\t\tmsdyn_primarytwitteriddescription as string,\n\t\tmsdyn_emailaddress1description as string,\n\t\tmsdyn_primaryfacebookid as string,\n\t\tmsdyn_telephone1extension as string,\n\t\temailaddress2 as string,\n\t\temailaddress3 as string,\n\t\temailaddress1 as string,\n\t\ttelephone3 as string,\n\t\tmsdyn_mappedvendoraccount as string\n\t),\n\tpartitionFileNames:['ContactPrimaryAddress.csv'],\n\tskipDuplicateMapInputs: true,\n\tskipDuplicateMapOutputs: true,\n\tpartitionBy('hash', 1)) ~> ContactPrimaryAddress"
                }
            },
            "dependsOn": [
                "[concat(variables('factoryId'), '/datasets/AzureStorageConnection')]",
                "[concat(variables('factoryId'), '/datasets/DelimitedTextOutput')]"
            ]
        },
        {
            "name": "[concat(parameters('factoryName'), '/MergePrimaryAddress')]",
            "type": "Microsoft.DataFactory/factories/dataflows",
            "apiVersion": "2018-06-01",
            "properties": {
                "description": "Merge primary address from FO and CE",
                "type": "MappingDataFlow",
                "typeProperties": {
                    "sources": [
                        {
                            "dataset": {
                                "referenceName": "AzureStorageConnection",
                                "type": "DatasetReference"
                            },
                            "name": "CEPrimaryElectronicAddress"
                        },
                        {
                            "dataset": {
                                "referenceName": "AzureStorageConnection",
                                "type": "DatasetReference"
                            },
                            "name": "FOElectronicAddress"
                        }
                    ],
                    "sinks": [
                        {
                            "dataset": {
                                "referenceName": "DelimitedTextOutput",
                                "type": "DatasetReference"
                            },
                            "name": "FOCEPrimaryAddress"
                        }
                    ],
                    "transformations": [
                        {
                            "name": "PrimaryFOAddress"
                        },
                        {
                            "name": "PrimaryAddress"
                        },
                        {
                            "name": "Source"
                        },
                        {
                            "name": "FOPrimaryAddress"
                        },
                        {
                            "name": "CEPrimaryAddress"
                        },
                        {
                            "name": "CEAddress"
                        },
                        {
                            "name": "PrimaryAddressUnion"
                        }
                    ],
                    "script": "parameters{\n\tIsFOSource as boolean (false())\n}\nsource(output(\n\t\tPartyNumber as string,\n\t\tLocator as string,\n\t\tDescription as string,\n\t\tType as string,\n\t\tLocatorExtension as string\n\t),\n\tallowSchemaDrift: true,\n\tvalidateSchema: false,\n\tignoreNoFilesFound: false) ~> CEPrimaryElectronicAddress\nsource(output(\n\t\tPartyNumber as string,\n\t\tElectronicAddressId as string,\n\t\tIsInstantMessage as boolean,\n\t\tIsMobilePhone as boolean,\n\t\tCountryRegionCode as string,\n\t\tPurpose as string,\n\t\tLocator as string,\n\t\tLocatorExtension as string,\n\t\tLocationId as string,\n\t\tDescription as string,\n\t\tIsPrimary as boolean,\n\t\tType as string,\n\t\tIsPrivate as boolean\n\t),\n\tallowSchemaDrift: true,\n\tvalidateSchema: false,\n\tignoreNoFilesFound: false) ~> FOElectronicAddress\nFOElectronicAddress filter(IsPrimary) ~> PrimaryFOAddress\nCEPrimaryElectronicAddress, PrimaryFOAddress join(lower(CEPrimaryElectronicAddress@PartyNumber) == lpad(lower(FOElectronicAddress@PartyNumber),9,\"0\")\n\t&& lower(CEPrimaryElectronicAddress@Locator) != lower(FOElectronicAddress@Locator)\n\t&& lower(CEPrimaryElectronicAddress@Type) == lower(FOElectronicAddress@Type)\n\t&& lower(iifNull(CEPrimaryElectronicAddress@LocatorExtension, \"\", CEPrimaryElectronicAddress@LocatorExtension)) == lower(iifNull(FOElectronicAddress@LocatorExtension, \"\", FOElectronicAddress@LocatorExtension)),\n\tjoinType:'inner',\n\tbroadcast: 'both')~> PrimaryAddress\nCEAddress split(!$IsFOSource,\n\tdisjoint: false) ~> Source@(CE, FO)\nSource@FO select(mapColumn(\n\t\tPartyNumber,\n\t\tLocator,\n\t\tDescription,\n\t\tType,\n\t\tLocatorExtension,\n\t\tElectronicAddressId,\n\t\tIsPrimary\n\t),\n\tskipDuplicateMapInputs: true,\n\tskipDuplicateMapOutputs: true) ~> FOPrimaryAddress\nSource@CE select(mapColumn(\n\t\tPartyNumber = CEPartyNumber,\n\t\tLocator = CELocator,\n\t\tDescription = CEDescription,\n\t\tType = CEType,\n\t\tLocatorExtension = CELocatorExtension,\n\t\tIsPrimary,\n\t\tElectronicAddressId\n\t),\n\tskipDuplicateMapInputs: true,\n\tskipDuplicateMapOutputs: true) ~> CEPrimaryAddress\nPrimaryAddress select(mapColumn(\n\t\tCEPartyNumber = CEPrimaryElectronicAddress@PartyNumber,\n\t\tCELocator = CEPrimaryElectronicAddress@Locator,\n\t\tCEDescription = CEPrimaryElectronicAddress@Description,\n\t\tCEType = CEPrimaryElectronicAddress@Type,\n\t\tCELocatorExtension = CEPrimaryElectronicAddress@LocatorExtension,\n\t\tPartyNumber = FOElectronicAddress@PartyNumber,\n\t\tElectronicAddressId,\n\t\tIsInstantMessage,\n\t\tIsMobilePhone,\n\t\tCountryRegionCode,\n\t\tPurpose,\n\t\tLocator = FOElectronicAddress@Locator,\n\t\tLocatorExtension = FOElectronicAddress@LocatorExtension,\n\t\tLocationId,\n\t\tDescription = FOElectronicAddress@Description,\n\t\tIsPrimary,\n\t\tType = FOElectronicAddress@Type,\n\t\tIsPrivate\n\t),\n\tskipDuplicateMapInputs: true,\n\tskipDuplicateMapOutputs: true) ~> CEAddress\nCEPrimaryAddress, FOPrimaryAddress union(byName: true)~> PrimaryAddressUnion\nPrimaryAddressUnion sink(allowSchemaDrift: true,\n\tvalidateSchema: false,\n\tinput(\n\t\taccountid as string,\n\t\tCompanyCode as string,\n\t\taccountnumber as string,\n\t\tname as string,\n\t\tmsdyn_partyid as string,\n\t\tmsdyn_partynumber as string,\n\t\tPartyNumber as string,\n\t\ttelephone1 as string,\n\t\twebsiteurl as string,\n\t\tmsdyn_websiteurldescription as string,\n\t\tmsdyn_primaryfacebookdescription as string,\n\t\tmsdyn_telephone1description as string,\n\t\tmsdyn_primarylinkedindescrption as string,\n\t\tmsdyn_primarylinkedinid as string,\n\t\tprimarytwitterid as string,\n\t\tmsdyn_primarytwitteriddescription as string,\n\t\tmsdyn_emailaddress1description as string,\n\t\tmsdyn_primaryfacebookid as string,\n\t\tmsdyn_telephone1extension as string,\n\t\temailaddress2 as string,\n\t\temailaddress3 as string,\n\t\temailaddress1 as string,\n\t\ttelephone3 as string,\n\t\tmsdyn_mappedvendoraccount as string\n\t),\n\tpartitionFileNames:['PrimaryAddress.csv'],\n\tskipDuplicateMapInputs: true,\n\tskipDuplicateMapOutputs: true,\n\tpartitionBy('hash', 1)) ~> FOCEPrimaryAddress"
                }
            },
            "dependsOn": [
                "[concat(variables('factoryId'), '/datasets/AzureStorageConnection')]",
                "[concat(variables('factoryId'), '/datasets/DelimitedTextOutput')]"
            ]
        },
        {
            "name": "[concat(parameters('factoryName'), '/CreateFoAddress')]",
            "type": "Microsoft.DataFactory/factories/dataflows",
            "apiVersion": "2018-06-01",
            "properties": {
                "description": "Create new addresses which does not exists in FO",
                "type": "MappingDataFlow",
                "typeProperties": {
                    "sources": [
                        {
                            "dataset": {
                                "referenceName": "AzureStorageConnection",
                                "type": "DatasetReference"
                            },
                            "name": "FOElectronicAddress"
                        },
                        {
                            "dataset": {
                                "referenceName": "AzureStorageConnection",
                                "type": "DatasetReference"
                            },
                            "name": "CENonPrimaryAddress"
                        },
                        {
                            "dataset": {
                                "referenceName": "AzureStorageConnection",
                                "type": "DatasetReference"
                            },
                            "name": "PrimaryAddress"
                        },
                        {
                            "dataset": {
                                "referenceName": "AzureStorageConnection",
                                "type": "DatasetReference"
                            },
                            "name": "CDSParty"
                        },
                        {
                            "dataset": {
                                "referenceName": "AzureStorageConnection",
                                "type": "DatasetReference"
                            },
                            "name": "CEPrimaryElectronicAddress"
                        },
                        {
                            "dataset": {
                                "referenceName": "AzureStorageConnection",
                                "type": "DatasetReference"
                            },
                            "name": "CDSPartyElectronicAddress"
                        }
                    ],
                    "sinks": [
                        {
                            "dataset": {
                                "referenceName": "DelimitedTextOutput",
                                "type": "DatasetReference"
                            },
                            "name": "FONewElectronicAddress"
                        },
                        {
                            "dataset": {
                                "referenceName": "DelimitedTextOutput",
                                "type": "DatasetReference"
                            },
                            "name": "FOCEElectronicAddress"
                        }
                    ],
                    "transformations": [
                        {
                            "name": "CEAddressNotExistsInFO"
                        },
                        {
                            "name": "GenerateElectronicAddressId"
                        },
                        {
                            "name": "PrefixElectronicAddressId"
                        },
                        {
                            "name": "FilterPrimaryAddress"
                        },
                        {
                            "name": "FOCEAddresssUnion"
                        },
                        {
                            "name": "ElectornicAddressParty"
                        },
                        {
                            "name": "Enum"
                        },
                        {
                            "name": "PrimaryAddressUnion"
                        },
                        {
                            "name": "RemoveFOPrimaryAddress"
                        },
                        {
                            "name": "Source"
                        },
                        {
                            "name": "FOCElectronicAddressUnion"
                        },
                        {
                            "name": "CESource"
                        },
                        {
                            "name": "FOSource"
                        },
                        {
                            "name": "RemovePrimaryAddressFromCE"
                        },
                        {
                            "name": "RemoveFOAddressFromCE"
                        },
                        {
                            "name": "CEPrimaryAddressNotExistsInFO"
                        },
                        {
                            "name": "CEPrimaryAddressNotExistsInFOUnion1"
                        },
                        {
                            "name": "IsPrimaryFlag"
                        },
                        {
                            "name": "IsPrimary"
                        },
                        {
                            "name": "IsMobile"
                        },
                        {
                            "name": "IsMobilePhone"
                        },
                        {
                            "name": "CDSPartyElectronicAddressJoin"
                        },
                        {
                            "name": "SelectElectronicAddress"
                        }
                    ],
                    "script": "parameters{\n\tprefix as string (\"ADF-EA-\"),\n\tSource as boolean (false())\n}\nsource(output(\n\t\tPartyNumber as string,\n\t\tElectronicAddressId as string,\n\t\tIsInstantMessage as boolean,\n\t\tIsMobilePhone as boolean,\n\t\tCountryRegionCode as string,\n\t\tPurpose as string,\n\t\tLocator as string,\n\t\tLocatorExtension as string,\n\t\tLocationId as string,\n\t\tDescription as string,\n\t\tIsPrimary as boolean,\n\t\tType as string,\n\t\tIsPrivate as boolean\n\t),\n\tallowSchemaDrift: true,\n\tvalidateSchema: false,\n\tignoreNoFilesFound: false) ~> FOElectronicAddress\nsource(output(\n\t\tPartyNumber as string,\n\t\tLocator as string,\n\t\tType as string,\n\t\tIsMobile as boolean\n\t),\n\tallowSchemaDrift: true,\n\tvalidateSchema: false,\n\tignoreNoFilesFound: false) ~> CENonPrimaryAddress\nsource(output(\n\t\tPartyNumber as string,\n\t\tLocator as string,\n\t\tDescription as string,\n\t\tType as string,\n\t\tLocatorExtension as string,\n\t\tIsPrimary as boolean,\n\t\tElectronicAddressId as string\n\t),\n\tallowSchemaDrift: true,\n\tvalidateSchema: false,\n\tignoreNoFilesFound: false) ~> PrimaryAddress\nsource(output(\n\t\tmsdyn_partyid as string,\n\t\tmsdyn_partynumber as string\n\t),\n\tallowSchemaDrift: true,\n\tvalidateSchema: false,\n\tignoreNoFilesFound: false) ~> CDSParty\nsource(output(\n\t\tPartyNumber as string,\n\t\tLocator as string,\n\t\tType as string,\n\t\tDescription as string,\n\t\tLocatorExtension as string,\n\t\tfirst as string\n\t),\n\tallowSchemaDrift: true,\n\tvalidateSchema: false,\n\tignoreNoFilesFound: false) ~> CEPrimaryElectronicAddress\nsource(output(\n\t\tmsdyn_partyelectronicaddressid as string,\n\t\tmsdyn_electronicaddressnumber as string,\n\t\tmsdyn_partyid as string,\n\t\t{aa.msdyn_partynumber} as string\n\t),\n\tallowSchemaDrift: true,\n\tvalidateSchema: false,\n\tignoreNoFilesFound: false) ~> CDSPartyElectronicAddress\nCENonPrimaryAddress, FOElectronicAddress exists(CENonPrimaryAddress@PartyNumber == FOElectronicAddress@PartyNumber\n\t&& CENonPrimaryAddress@Locator == FOElectronicAddress@Locator\n\t&& CENonPrimaryAddress@Type == FOElectronicAddress@Type,\n\tnegate:true,\n\tbroadcast: 'auto')~> CEAddressNotExistsInFO\nCEPrimaryAddressNotExistsInFOUnion1 keyGenerate(output(ElectronicAddressId as long),\n\tstartAt: 1L,\n\tstepValue: 1L) ~> GenerateElectronicAddressId\nGenerateElectronicAddressId derive(ElectronicAddressId = concat($prefix, toString(ElectronicAddressId))) ~> PrefixElectronicAddressId\nFOElectronicAddress, PrimaryAddress exists(FOElectronicAddress@ElectronicAddressId == PrimaryAddress@ElectronicAddressId,\n\tnegate:true,\n\tbroadcast: 'auto')~> FilterPrimaryAddress\nIsMobile, PrimaryAddressUnion union(byName: true)~> FOCEAddresssUnion\nIsMobilePhone, CDSParty join(PartyNumber == msdyn_partynumber,\n\tjoinType:'inner',\n\tbroadcast: 'auto')~> ElectornicAddressParty\nElectornicAddressParty derive(Type = case(lower(Type)=='phone',192350001,\r\ncase(lower(Type)=='email',192350002,\r\ncase(lower(Type)=='url',192350003,\r\ncase(lower(Type)=='telex',192350004,\r\ncase(lower(Type)=='fax',192350005,\r\ncase(lower(Type)=='facebook',192350006,\r\ncase(lower(Type)=='twitter',192350007,\r\ncase(lower(Type)=='linkedin',192350008\r\n)))))))),\n\t\tmsdyn_partyelectronicaddressid = \"\") ~> Enum\nPrefixElectronicAddressId, PrimaryAddress union(byName: true)~> PrimaryAddressUnion\nFOSource, PrimaryAddress exists(FOSource@ElectronicAddressId == PrimaryAddress@ElectronicAddressId,\n\tnegate:true,\n\tbroadcast: 'auto')~> RemoveFOPrimaryAddress\nPrimaryAddressUnion split($Source,\n\tdisjoint: false) ~> Source@(FO, CE)\nRemoveFOPrimaryAddress, CESource union(byName: true)~> FOCElectronicAddressUnion\nSource@CE select(mapColumn(\n\t\tPartyNumber,\n\t\tLocator,\n\t\tType,\n\t\tElectronicAddressId,\n\t\tDescription,\n\t\tLocatorExtension,\n\t\tIsPrimary,\n\t\tIsMobile\n\t),\n\tskipDuplicateMapInputs: true,\n\tskipDuplicateMapOutputs: true) ~> CESource\nSource@FO select(mapColumn(\n\t\tPartyNumber,\n\t\tLocator,\n\t\tType,\n\t\tElectronicAddressId,\n\t\tDescription,\n\t\tLocatorExtension,\n\t\tIsPrimary,\n\t\tIsMobile\n\t),\n\tskipDuplicateMapInputs: true,\n\tskipDuplicateMapOutputs: true) ~> FOSource\nCEPrimaryElectronicAddress, PrimaryAddress exists(lower(CEPrimaryElectronicAddress@PartyNumber) == lower(PrimaryAddress@PartyNumber)\n\t&& lower(CEPrimaryElectronicAddress@Locator) == lower(PrimaryAddress@Locator)\n\t&& lower(CEPrimaryElectronicAddress@Type) == lower(PrimaryAddress@Type)\n\t&& lower(iifNull(CEPrimaryElectronicAddress@Description,\"\",CEPrimaryElectronicAddress@Description)) == lower(iifNull(PrimaryAddress@Description,\"\",PrimaryAddress@Description))\n\t&& lower(iifNull(CEPrimaryElectronicAddress@LocatorExtension,\"\",CEPrimaryElectronicAddress@LocatorExtension)) == lower(iifNull(PrimaryAddress@LocatorExtension,\"\",PrimaryAddress@LocatorExtension)),\n\tnegate:true,\n\tbroadcast: 'auto')~> RemovePrimaryAddressFromCE\nRemovePrimaryAddressFromCE, FilterPrimaryAddress exists(lower(CEPrimaryElectronicAddress@PartyNumber) == lower(FOElectronicAddress@PartyNumber)\n\t&& lower(CEPrimaryElectronicAddress@Locator) == lower(FOElectronicAddress@Locator)\n\t&& lower(CEPrimaryElectronicAddress@Type) == lower(FOElectronicAddress@Type),\n\tnegate:true,\n\tbroadcast: 'auto')~> RemoveFOAddressFromCE\nIsPrimary select(mapColumn(\n\t\tPartyNumber,\n\t\tLocator,\n\t\tType,\n\t\tDescription,\n\t\tLocatorExtension,\n\t\tIsPrimary\n\t),\n\tskipDuplicateMapInputs: true,\n\tskipDuplicateMapOutputs: true) ~> CEPrimaryAddressNotExistsInFO\nCEAddressNotExistsInFO, CEPrimaryAddressNotExistsInFO union(byName: true)~> CEPrimaryAddressNotExistsInFOUnion1\nFOCElectronicAddressUnion derive(IsPrimary = case(IsPrimary,1,0)) ~> IsPrimaryFlag\nRemoveFOAddressFromCE derive(IsPrimary = iif((lower(Type)==\"email\" || lower(Type)==\"phone\"), true(), false() )) ~> IsPrimary\nFilterPrimaryAddress select(mapColumn(\n\t\tPartyNumber,\n\t\tElectronicAddressId,\n\t\tIsInstantMessage,\n\t\tIsMobile = IsMobilePhone,\n\t\tCountryRegionCode,\n\t\tPurpose,\n\t\tLocator,\n\t\tLocatorExtension,\n\t\tLocationId,\n\t\tDescription,\n\t\tIsPrimary,\n\t\tType,\n\t\tIsPrivate\n\t),\n\tskipDuplicateMapInputs: true,\n\tskipDuplicateMapOutputs: true) ~> IsMobile\nFOCEAddresssUnion select(mapColumn(\n\t\tPartyNumber,\n\t\tElectronicAddressId,\n\t\tIsInstantMessage,\n\t\tIsMobilePhone = IsMobile,\n\t\tCountryRegionCode,\n\t\tPurpose,\n\t\tLocator,\n\t\tLocatorExtension,\n\t\tLocationId,\n\t\tDescription,\n\t\tIsPrimary,\n\t\tType,\n\t\tIsPrivate\n\t),\n\tskipDuplicateMapInputs: true,\n\tskipDuplicateMapOutputs: true) ~> IsMobilePhone\nEnum, CDSPartyElectronicAddress join(CDSParty@msdyn_partyid == CDSPartyElectronicAddress@msdyn_partyid\n\t&& ElectronicAddressId == msdyn_electronicaddressnumber,\n\tjoinType:'left',\n\tbroadcast: 'auto')~> CDSPartyElectronicAddressJoin\nCDSPartyElectronicAddressJoin select(mapColumn(\n\t\tPartyNumber,\n\t\tElectronicAddressId,\n\t\tIsInstantMessage,\n\t\tIsMobilePhone,\n\t\tCountryRegionCode,\n\t\tPurpose,\n\t\tLocator,\n\t\tLocatorExtension,\n\t\tLocationId,\n\t\tDescription,\n\t\tIsPrimary,\n\t\tType,\n\t\tIsPrivate,\n\t\tmsdyn_partyid = CDSParty@msdyn_partyid,\n\t\tmsdyn_partynumber,\n\t\tmsdyn_partyelectronicaddressid = CDSPartyElectronicAddress@msdyn_partyelectronicaddressid\n\t),\n\tskipDuplicateMapInputs: true,\n\tskipDuplicateMapOutputs: true) ~> SelectElectronicAddress\nIsPrimaryFlag sink(allowSchemaDrift: true,\n\tvalidateSchema: false,\n\tinput(\n\t\taccountid as string,\n\t\tCompanyCode as string,\n\t\taccountnumber as string,\n\t\tname as string,\n\t\tmsdyn_partyid as string,\n\t\tmsdyn_partynumber as string,\n\t\tPartyNumber as string,\n\t\ttelephone1 as string,\n\t\twebsiteurl as string,\n\t\tmsdyn_websiteurldescription as string,\n\t\tmsdyn_primaryfacebookdescription as string,\n\t\tmsdyn_telephone1description as string,\n\t\tmsdyn_primarylinkedindescrption as string,\n\t\tmsdyn_primarylinkedinid as string,\n\t\tprimarytwitterid as string,\n\t\tmsdyn_primarytwitteriddescription as string,\n\t\tmsdyn_emailaddress1description as string,\n\t\tmsdyn_primaryfacebookid as string,\n\t\tmsdyn_telephone1extension as string,\n\t\temailaddress2 as string,\n\t\temailaddress3 as string,\n\t\temailaddress1 as string,\n\t\ttelephone3 as string,\n\t\tmsdyn_mappedvendoraccount as string\n\t),\n\tpartitionFileNames:['ImportFONewElectronicAddress.csv'],\n\tskipDuplicateMapInputs: true,\n\tskipDuplicateMapOutputs: true,\n\tpartitionBy('hash', 1)) ~> FONewElectronicAddress\nSelectElectronicAddress sink(allowSchemaDrift: true,\n\tvalidateSchema: false,\n\tinput(\n\t\taccountid as string,\n\t\tCompanyCode as string,\n\t\taccountnumber as string,\n\t\tname as string,\n\t\tmsdyn_partyid as string,\n\t\tmsdyn_partynumber as string,\n\t\tPartyNumber as string,\n\t\ttelephone1 as string,\n\t\twebsiteurl as string,\n\t\tmsdyn_websiteurldescription as string,\n\t\tmsdyn_primaryfacebookdescription as string,\n\t\tmsdyn_telephone1description as string,\n\t\tmsdyn_primarylinkedindescrption as string,\n\t\tmsdyn_primarylinkedinid as string,\n\t\tprimarytwitterid as string,\n\t\tmsdyn_primarytwitteriddescription as string,\n\t\tmsdyn_emailaddress1description as string,\n\t\tmsdyn_primaryfacebookid as string,\n\t\tmsdyn_telephone1extension as string,\n\t\temailaddress2 as string,\n\t\temailaddress3 as string,\n\t\temailaddress1 as string,\n\t\ttelephone3 as string,\n\t\tmsdyn_mappedvendoraccount as string\n\t),\n\tpartitionFileNames:['FOCEElectronicAddress.csv'],\n\tskipDuplicateMapInputs: true,\n\tskipDuplicateMapOutputs: true,\n\tpartitionBy('hash', 1)) ~> FOCEElectronicAddress"
                }
            },
            "dependsOn": [
                "[concat(variables('factoryId'), '/datasets/AzureStorageConnection')]",
                "[concat(variables('factoryId'), '/datasets/DelimitedTextOutput')]"
            ]
        },
        {
            "name": "[concat(parameters('factoryName'), '/ConsolidateAddresses')]",
            "type": "Microsoft.DataFactory/factories/dataflows",
            "apiVersion": "2018-06-01",
            "properties": {
                "description": "Consolidate CDS Addresses ",
                "type": "MappingDataFlow",
                "typeProperties": {
                    "sources": [
                        {
                            "dataset": {
                                "referenceName": "AzureStorageConnection",
                                "type": "DatasetReference"
                            },
                            "name": "CDSAccount"
                        },
                        {
                            "dataset": {
                                "referenceName": "AzureStorageConnection",
                                "type": "DatasetReference"
                            },
                            "name": "CDSContact"
                        },
                        {
                            "dataset": {
                                "referenceName": "AzureStorageConnection",
                                "type": "DatasetReference"
                            },
                            "name": "CDSVendor"
                        }
                    ],
                    "sinks": [
                        {
                            "dataset": {
                                "referenceName": "DelimitedTextOutput",
                                "type": "DatasetReference"
                            },
                            "name": "CEElectronicAddress"
                        },
                        {
                            "dataset": {
                                "referenceName": "DelimitedTextOutput",
                                "type": "DatasetReference"
                            },
                            "name": "CENonPrimaryAddress"
                        }
                    ],
                    "transformations": [
                        {
                            "name": "AccountEmail"
                        },
                        {
                            "name": "AccountEmailType"
                        },
                        {
                            "name": "RemoveBlankAccountEmail"
                        },
                        {
                            "name": "RemoveBlankAccountTelephone"
                        },
                        {
                            "name": "AccountTelephone"
                        },
                        {
                            "name": "AccountTelephoneLocator"
                        },
                        {
                            "name": "AccoutEmailTelephone"
                        },
                        {
                            "name": "RemoveBlankAccountWebsiteUrl"
                        },
                        {
                            "name": "AccountWebsiteURL"
                        },
                        {
                            "name": "AccountWebsiteURLType"
                        },
                        {
                            "name": "AccountWebsiteURLUnion"
                        },
                        {
                            "name": "RemoveBlankAccountLinkedIn"
                        },
                        {
                            "name": "AccountLinkedIn"
                        },
                        {
                            "name": "AccountLinkedInType"
                        },
                        {
                            "name": "AccountLinkedInUnion"
                        },
                        {
                            "name": "RemoveBlankAccountTwitter"
                        },
                        {
                            "name": "AccountTwitter"
                        },
                        {
                            "name": "AccountTwitterType"
                        },
                        {
                            "name": "AccountTwitterUnion"
                        },
                        {
                            "name": "RemoveBlankAccountFacebook"
                        },
                        {
                            "name": "AccountFacebook"
                        },
                        {
                            "name": "AccountFacebookType"
                        },
                        {
                            "name": "AccountFacebookUnion"
                        },
                        {
                            "name": "RemoveBlankAccountFax"
                        },
                        {
                            "name": "AccountFax"
                        },
                        {
                            "name": "AccountFaxType"
                        },
                        {
                            "name": "AccountFaxUnion"
                        },
                        {
                            "name": "RemoveBlankContactEmail"
                        },
                        {
                            "name": "ConatctEmail"
                        },
                        {
                            "name": "ContactEmailType"
                        },
                        {
                            "name": "ContactEmailUnion"
                        },
                        {
                            "name": "RemoveBlankContactTelephone"
                        },
                        {
                            "name": "ContactTelephone"
                        },
                        {
                            "name": "ContactTelephoneType"
                        },
                        {
                            "name": "ContactTelephoneUnion"
                        },
                        {
                            "name": "RemoveBlankContactFax"
                        },
                        {
                            "name": "ContactFax"
                        },
                        {
                            "name": "ContactFaxType"
                        },
                        {
                            "name": "ContactFaxUnion"
                        },
                        {
                            "name": "RemoveBlankContactFacebook"
                        },
                        {
                            "name": "ContactFacebook"
                        },
                        {
                            "name": "ContactFacebookType"
                        },
                        {
                            "name": "ContactFacebookUnion"
                        },
                        {
                            "name": "RemoveBlankContactTwitter"
                        },
                        {
                            "name": "ContactTwitter"
                        },
                        {
                            "name": "ContactTwitterType"
                        },
                        {
                            "name": "ContactTwitterUnion"
                        },
                        {
                            "name": "RemoveBlankConatctWebsiteURL"
                        },
                        {
                            "name": "ContactWebsiteURL"
                        },
                        {
                            "name": "ContactWebsiteUrlType"
                        },
                        {
                            "name": "ContactWebsiteUrlUnion"
                        },
                        {
                            "name": "RemoveBlankContactLinkedIn"
                        },
                        {
                            "name": "ContactLinkedIn"
                        },
                        {
                            "name": "ContactLinkedInType"
                        },
                        {
                            "name": "ContactLinkedInUnion"
                        },
                        {
                            "name": "RemoveBlankVendorEmail"
                        },
                        {
                            "name": "VendorEmail"
                        },
                        {
                            "name": "VendorEmailType"
                        },
                        {
                            "name": "RemoveBlankVendorFacebook"
                        },
                        {
                            "name": "VendorFacebook"
                        },
                        {
                            "name": "VendorFacebookType"
                        },
                        {
                            "name": "RemoveBlankVendorTwitter"
                        },
                        {
                            "name": "VendorTwitter"
                        },
                        {
                            "name": "VendorTwitterType"
                        },
                        {
                            "name": "RemoveBlankVendorTelephone"
                        },
                        {
                            "name": "VendorPhone"
                        },
                        {
                            "name": "VendorPhoneType"
                        },
                        {
                            "name": "RemoveBlankVendorlinkedIn"
                        },
                        {
                            "name": "VendorLinkedIn"
                        },
                        {
                            "name": "VendorLinkedInType"
                        },
                        {
                            "name": "RemoveBlankVendorFax"
                        },
                        {
                            "name": "VendorFax"
                        },
                        {
                            "name": "VendorFaxType"
                        },
                        {
                            "name": "RemoveBlankTelex"
                        },
                        {
                            "name": "VendorTelex"
                        },
                        {
                            "name": "VendorTelexType"
                        },
                        {
                            "name": "VendorEmailUnion"
                        },
                        {
                            "name": "VendorPhoneUnion"
                        },
                        {
                            "name": "VendorFaxUnion"
                        },
                        {
                            "name": "VendorFacebookUnion"
                        },
                        {
                            "name": "VendorTwitterUnion"
                        },
                        {
                            "name": "VendorLinkedInUnion"
                        },
                        {
                            "name": "VendorTelexUnion"
                        },
                        {
                            "name": "RemoveDuplicate"
                        },
                        {
                            "name": "RemoveBlankContactEmail2"
                        },
                        {
                            "name": "ContactEmail2"
                        },
                        {
                            "name": "ContactEmail2Type"
                        },
                        {
                            "name": "RemoveBlankContactEmail3"
                        },
                        {
                            "name": "ContactEmail3"
                        },
                        {
                            "name": "ContactEmail3Tyoe"
                        },
                        {
                            "name": "RemoveBlankContactTelephone2"
                        },
                        {
                            "name": "ContactTelephone2"
                        },
                        {
                            "name": "ContactTelephone2Type"
                        },
                        {
                            "name": "RemoveBlankContactTelephone3"
                        },
                        {
                            "name": "ContactTelephone3"
                        },
                        {
                            "name": "ContactTelephone3Type"
                        },
                        {
                            "name": "RemoveBlankAccountEmail2"
                        },
                        {
                            "name": "AccountEmail2"
                        },
                        {
                            "name": "AccountEmail2Type"
                        },
                        {
                            "name": "RemoveBlankAccountEmail3"
                        },
                        {
                            "name": "AccountEmail3"
                        },
                        {
                            "name": "AccountEmail3Type"
                        },
                        {
                            "name": "RemoveBlankAccountPhone3"
                        },
                        {
                            "name": "AccountPhone3"
                        },
                        {
                            "name": "AccountPhone3Type"
                        },
                        {
                            "name": "RemoveBlankAccountPhone2"
                        },
                        {
                            "name": "AccountPhone2"
                        },
                        {
                            "name": "AccountPhone2Type"
                        },
                        {
                            "name": "AccountPhonn3TypeUnion"
                        },
                        {
                            "name": "AccountEmail2Union"
                        },
                        {
                            "name": "AccountEmail3Union"
                        },
                        {
                            "name": "ContactPhone2Union"
                        },
                        {
                            "name": "ContactPhone3Union"
                        },
                        {
                            "name": "ContactEmail2Union"
                        },
                        {
                            "name": "ContactEmail3Union"
                        },
                        {
                            "name": "RemoveBlankMobilePhone"
                        },
                        {
                            "name": "ContactMobilePhone"
                        },
                        {
                            "name": "ContactMobilePhoneType"
                        },
                        {
                            "name": "ContactMobilePhoneUnion"
                        }
                    ],
                    "script": "source(output(\n\t\taccountid as string,\n\t\tCompanyCode as string,\n\t\taccountnumber as string,\n\t\tname as string,\n\t\tmsdyn_partyid as string,\n\t\tmsdyn_partynumber as string,\n\t\tPartyNumber as string,\n\t\ttelephone1 as string,\n\t\twebsiteurl as string,\n\t\tmsdyn_websiteurldescription as string,\n\t\tmsdyn_faxextension as string,\n\t\tmsdyn_faxdescription as string,\n\t\tmsdyn_primaryfacebookdescription as string,\n\t\tmsdyn_telephone1description as string,\n\t\tmsdyn_primarytwitteriddescription as string,\n\t\tmsdyn_primarylinkedindescrption as string,\n\t\tmsdyn_primarylinkedinid as string,\n\t\tprimarytwitterid as string,\n\t\tmsdyn_emailaddress1description as string,\n\t\tfax as string,\n\t\tmsdyn_primaryfacebookid as string,\n\t\tmsdyn_telephone1extension as string,\n\t\temailaddress2 as string,\n\t\temailaddress3 as string,\n\t\temailaddress1 as string,\n\t\ttelephone2 as string,\n\t\ttelephone3 as string,\n\t\tmsdyn_mappedvendoraccount as string\n\t),\n\tallowSchemaDrift: true,\n\tvalidateSchema: false,\n\tignoreNoFilesFound: false) ~> CDSAccount\nsource(output(\n\t\tmsdyn_partynumber as string,\n\t\tmsdyn_partyid as string,\n\t\tmsdyn_isvendor as boolean,\n\t\temailaddress1 as string,\n\t\temailaddress2 as string,\n\t\temailaddress3 as string,\n\t\tmsdyn_telephone1description as string,\n\t\tfullname as string,\n\t\tmsdyn_sellable as boolean,\n\t\tmsdyn_emailaddress1description as string,\n\t\tmsdyn_primarytwitteriddescription as string,\n\t\tmsdyn_contactforvendor as boolean,\n\t\twebsiteurl as string,\n\t\tmobilephone as string,\n\t\tcontactid as string,\n\t\tCompanyCode as string,\n\t\tmsdyn_linkedvendoraccount as string,\n\t\tmsdyn_websiteurldescription as string,\n\t\thome2 as string,\n\t\ttelephone2 as string,\n\t\ttelephone3 as string,\n\t\tmsdyn_primarylinkedindescrption as string,\n\t\ttelephone1 as string,\n\t\tmsdyn_contactpersonid as string,\n\t\tmsdyn_primaryfacebookid as string,\n\t\tfax as string,\n\t\tmsdyn_faxextension as string,\n\t\tPartyNumber as string,\n\t\tmsdyn_primaryfacebookdescription as string,\n\t\tmsdyn_faxdescription as string,\n\t\tmsdyn_telephone1extension as string,\n\t\tmsdyn_primarytwitterid as string,\n\t\tmsdyn_primaryinkedinid as string,\n\t\tmsdyn_contactfor as string\n\t),\n\tallowSchemaDrift: true,\n\tvalidateSchema: false,\n\tignoreNoFilesFound: false) ~> CDSContact\nsource(output(\n\t\tCompanyCode as string,\n\t\tmsdyn_vendorpartynumber as string,\n\t\tmsdyn_partyid as string,\n\t\tmsdyn_vendoraccountnumber as string,\n\t\tmsdyn_name as string,\n\t\tmsdyn_vendorid as string,\n\t\tPartyNumber as string,\n\t\tmsdyn_primaryurldescription as string,\n\t\tmsdyn_primarytwitter as string,\n\t\tmsdyn_primarytelex as string,\n\t\tmsdyn_primaryphonenumberextension as string,\n\t\tmsdyn_primarytwitterdescription as string,\n\t\tmsdyn_primaryemailaddress as string,\n\t\tmsdyn_primaryfaxnumber as string,\n\t\tmsdyn_primaryfacebookdescription as string,\n\t\tmsdyn_primarylinkedin as string,\n\t\tmsdyn_primarylinkedindescription as string,\n\t\tmsdyn_primaryfacebook as string,\n\t\tmsdyn_primaryemailaddressdescription as string,\n\t\tmsdyn_primarytelexdescription as string,\n\t\tmsdyn_primaryfaxnumberdescription as string,\n\t\tmsdyn_pimaryphonenumber as string,\n\t\tmsdyn_primaryfaxnumberextension as string,\n\t\tmsdyn_primaryphonenumberdescription as string,\n\t\tmsdyn_firstname as string,\n\t\tmsdyn_linkedvendorinaccountsentity as string,\n\t\tmsdyn_lastname as string,\n\t\tmsdyn_linkedvendorincontactsentity as string\n\t),\n\tallowSchemaDrift: true,\n\tvalidateSchema: false,\n\tignoreNoFilesFound: false) ~> CDSVendor\nRemoveBlankAccountEmail select(mapColumn(\n\t\tPartyNumber,\n\t\tLocator = emailaddress1,\n\t\tDescription = msdyn_emailaddress1description\n\t),\n\tskipDuplicateMapInputs: true,\n\tskipDuplicateMapOutputs: true) ~> AccountEmail\nAccountEmail derive(Type = \"Email\") ~> AccountEmailType\nCDSAccount filter(!isNull(emailaddress1) || emailaddress1==\"\") ~> RemoveBlankAccountEmail\nCDSAccount filter(!isNull(telephone1) || telephone1==\"\") ~> RemoveBlankAccountTelephone\nRemoveBlankAccountTelephone select(mapColumn(\n\t\tPartyNumber,\n\t\tLocator = telephone1,\n\t\tLocatorExtension = msdyn_telephone1extension,\n\t\tDescription = msdyn_telephone1description\n\t),\n\tskipDuplicateMapInputs: true,\n\tskipDuplicateMapOutputs: true) ~> AccountTelephone\nAccountTelephone derive(Type = \"Phone\") ~> AccountTelephoneLocator\nAccountEmailType, AccountTelephoneLocator union(byName: true)~> AccoutEmailTelephone\nCDSAccount filter(!isNull(websiteurl) || websiteurl==\"\") ~> RemoveBlankAccountWebsiteUrl\nRemoveBlankAccountWebsiteUrl select(mapColumn(\n\t\tPartyNumber,\n\t\tLocator = websiteurl,\n\t\tDescription = msdyn_websiteurldescription\n\t),\n\tskipDuplicateMapInputs: true,\n\tskipDuplicateMapOutputs: true) ~> AccountWebsiteURL\nAccountWebsiteURL derive(Type = \"URL\") ~> AccountWebsiteURLType\nAccoutEmailTelephone, AccountWebsiteURLType union(byName: true)~> AccountWebsiteURLUnion\nCDSAccount filter(!isNull(msdyn_primarylinkedinid) || msdyn_primarylinkedinid==\"\") ~> RemoveBlankAccountLinkedIn\nRemoveBlankAccountLinkedIn select(mapColumn(\n\t\tPartyNumber,\n\t\tDescription = msdyn_primarylinkedindescrption,\n\t\tLocator = msdyn_primarylinkedinid\n\t),\n\tskipDuplicateMapInputs: true,\n\tskipDuplicateMapOutputs: true) ~> AccountLinkedIn\nAccountLinkedIn derive(Type = \"LinkedIn\") ~> AccountLinkedInType\nAccountWebsiteURLUnion, AccountLinkedInType union(byName: true)~> AccountLinkedInUnion\nCDSAccount filter(!isNull(primarytwitterid) || primarytwitterid==\"\") ~> RemoveBlankAccountTwitter\nRemoveBlankAccountTwitter select(mapColumn(\n\t\tPartyNumber,\n\t\tLocator = primarytwitterid,\n\t\tDescription = msdyn_primarytwitteriddescription\n\t),\n\tskipDuplicateMapInputs: true,\n\tskipDuplicateMapOutputs: true) ~> AccountTwitter\nAccountTwitter derive(Type = \"Twitter\") ~> AccountTwitterType\nAccountLinkedInUnion, AccountTwitterType union(byName: true)~> AccountTwitterUnion\nCDSAccount filter(!isNull(msdyn_primaryfacebookid)|| msdyn_primaryfacebookid==\"\") ~> RemoveBlankAccountFacebook\nRemoveBlankAccountFacebook select(mapColumn(\n\t\tPartyNumber,\n\t\tDescription = msdyn_primaryfacebookdescription,\n\t\tLocator = msdyn_primaryfacebookid\n\t),\n\tskipDuplicateMapInputs: true,\n\tskipDuplicateMapOutputs: true) ~> AccountFacebook\nAccountFacebook derive(Type = \"Facebook\") ~> AccountFacebookType\nAccountTwitterUnion, AccountFacebookType union(byName: true)~> AccountFacebookUnion\nCDSAccount filter(!isNull(fax) || fax==\"\") ~> RemoveBlankAccountFax\nRemoveBlankAccountFax select(mapColumn(\n\t\tPartyNumber,\n\t\tLocatorExtension = msdyn_faxextension,\n\t\tDescription = msdyn_faxdescription,\n\t\tLocator = fax\n\t),\n\tskipDuplicateMapInputs: true,\n\tskipDuplicateMapOutputs: true) ~> AccountFax\nAccountFax derive(Type = \"Fax\") ~> AccountFaxType\nAccountFacebookUnion, AccountFaxType union(byName: true)~> AccountFaxUnion\nCDSContact filter(!isNull(emailaddress1) || emailaddress1==\"\") ~> RemoveBlankContactEmail\nRemoveBlankContactEmail select(mapColumn(\n\t\tPartyNumber,\n\t\tLocator = emailaddress1,\n\t\tDescription = msdyn_emailaddress1description\n\t),\n\tskipDuplicateMapInputs: true,\n\tskipDuplicateMapOutputs: true) ~> ConatctEmail\nConatctEmail derive(Type = \"Email\") ~> ContactEmailType\nAccountFaxUnion, ContactEmailType union(byName: true)~> ContactEmailUnion\nCDSContact filter(!isNull(telephone1) || telephone1==\"\") ~> RemoveBlankContactTelephone\nRemoveBlankContactTelephone select(mapColumn(\n\t\tPartyNumber,\n\t\tDescription = msdyn_telephone1description,\n\t\tLocator = telephone1,\n\t\tLocatorExtension = msdyn_telephone1extension\n\t),\n\tskipDuplicateMapInputs: true,\n\tskipDuplicateMapOutputs: true) ~> ContactTelephone\nContactTelephone derive(Type = \"Phone\") ~> ContactTelephoneType\nContactEmailUnion, ContactTelephoneType union(byName: true)~> ContactTelephoneUnion\nCDSContact filter(!isNull(fax) || fax==\"\") ~> RemoveBlankContactFax\nRemoveBlankContactFax select(mapColumn(\n\t\tPartyNumber,\n\t\tLocator = fax,\n\t\tLocatorExtension = msdyn_faxextension,\n\t\tDescription = msdyn_faxdescription\n\t),\n\tskipDuplicateMapInputs: true,\n\tskipDuplicateMapOutputs: true) ~> ContactFax\nContactFax derive(Type = \"Fax\") ~> ContactFaxType\nContactTelephoneUnion, ContactFaxType union(byName: true)~> ContactFaxUnion\nCDSContact filter(!isNull(msdyn_primaryfacebookid) || msdyn_primaryfacebookid==\"\") ~> RemoveBlankContactFacebook\nRemoveBlankContactFacebook select(mapColumn(\n\t\tPartyNumber,\n\t\tLocator = msdyn_primaryfacebookid,\n\t\tDescription = msdyn_primaryfacebookdescription\n\t),\n\tskipDuplicateMapInputs: true,\n\tskipDuplicateMapOutputs: true) ~> ContactFacebook\nContactFacebook derive(Type = \"Facebook\") ~> ContactFacebookType\nContactFaxUnion, ContactFacebookType union(byName: true)~> ContactFacebookUnion\nCDSContact filter(!isNull(msdyn_primarytwitterid) || msdyn_primarytwitterid==\"\") ~> RemoveBlankContactTwitter\nRemoveBlankContactTwitter select(mapColumn(\n\t\tDescription = msdyn_primarytwitteriddescription,\n\t\tPartyNumber,\n\t\tLocator = msdyn_primarytwitterid\n\t),\n\tskipDuplicateMapInputs: true,\n\tskipDuplicateMapOutputs: true) ~> ContactTwitter\nContactTwitter derive(Type = \"Twitter\") ~> ContactTwitterType\nContactFacebookUnion, ContactTwitterType union(byName: true)~> ContactTwitterUnion\nCDSContact filter(!isNull(websiteurl) || websiteurl==\"\") ~> RemoveBlankConatctWebsiteURL\nRemoveBlankConatctWebsiteURL select(mapColumn(\n\t\tPartyNumber,\n\t\tLocator = websiteurl,\n\t\tDescription = msdyn_websiteurldescription\n\t),\n\tskipDuplicateMapInputs: true,\n\tskipDuplicateMapOutputs: true) ~> ContactWebsiteURL\nContactWebsiteURL derive(Type = \"URL\") ~> ContactWebsiteUrlType\nContactTwitterUnion, ContactWebsiteUrlType union(byName: true)~> ContactWebsiteUrlUnion\nCDSContact filter(!isNull(msdyn_primaryinkedinid) || msdyn_primaryinkedinid==\"\") ~> RemoveBlankContactLinkedIn\nRemoveBlankContactLinkedIn select(mapColumn(\n\t\tPartyNumber,\n\t\tDescription = msdyn_primarylinkedindescrption,\n\t\tLocator = msdyn_primaryinkedinid\n\t),\n\tskipDuplicateMapInputs: true,\n\tskipDuplicateMapOutputs: true) ~> ContactLinkedIn\nContactLinkedIn derive(Type = \"LinkedIn\") ~> ContactLinkedInType\nContactWebsiteUrlUnion, ContactLinkedInType union(byName: true)~> ContactLinkedInUnion\nCDSVendor filter(!isNull(msdyn_primaryemailaddress) || msdyn_primaryemailaddress==\"\") ~> RemoveBlankVendorEmail\nRemoveBlankVendorEmail select(mapColumn(\n\t\tPartyNumber,\n\t\tLocator = msdyn_primaryemailaddress,\n\t\tDescription = msdyn_primaryemailaddressdescription\n\t),\n\tskipDuplicateMapInputs: true,\n\tskipDuplicateMapOutputs: true) ~> VendorEmail\nVendorEmail derive(Type = \"Email\") ~> VendorEmailType\nCDSVendor filter(!isNull(msdyn_primaryfacebook) || msdyn_primaryfacebook==\"\") ~> RemoveBlankVendorFacebook\nRemoveBlankVendorFacebook select(mapColumn(\n\t\tPartyNumber,\n\t\tDescription = msdyn_primaryfacebookdescription,\n\t\tLocator = msdyn_primaryfacebook\n\t),\n\tskipDuplicateMapInputs: true,\n\tskipDuplicateMapOutputs: true) ~> VendorFacebook\nVendorFacebook derive(Type = \"Facebook\") ~> VendorFacebookType\nCDSVendor filter(!isNull(msdyn_primarytwitter) || msdyn_primarytwitter==\"\") ~> RemoveBlankVendorTwitter\nRemoveBlankVendorTwitter select(mapColumn(\n\t\tPartyNumber,\n\t\tLocator = msdyn_primarytwitter,\n\t\tDescription = msdyn_primarytwitterdescription\n\t),\n\tskipDuplicateMapInputs: true,\n\tskipDuplicateMapOutputs: true) ~> VendorTwitter\nVendorTwitter derive(Type = \"Twitter\") ~> VendorTwitterType\nCDSVendor filter(!isNull(msdyn_pimaryphonenumber) || msdyn_pimaryphonenumber==\"\") ~> RemoveBlankVendorTelephone\nRemoveBlankVendorTelephone select(mapColumn(\n\t\tPartyNumber,\n\t\tLocatorExtension = msdyn_primaryphonenumberextension,\n\t\tDescription = msdyn_primaryphonenumberdescription,\n\t\tLocator = msdyn_pimaryphonenumber\n\t),\n\tskipDuplicateMapInputs: true,\n\tskipDuplicateMapOutputs: true) ~> VendorPhone\nVendorPhone derive(Type = \"Phone\") ~> VendorPhoneType\nCDSVendor filter(!isNull(msdyn_primarylinkedin) || msdyn_primarylinkedin==\"\") ~> RemoveBlankVendorlinkedIn\nRemoveBlankVendorlinkedIn select(mapColumn(\n\t\tPartyNumber,\n\t\tLocator = msdyn_primarylinkedin,\n\t\tDescription = msdyn_primarylinkedindescription\n\t),\n\tskipDuplicateMapInputs: true,\n\tskipDuplicateMapOutputs: true) ~> VendorLinkedIn\nVendorLinkedIn derive(Type = \"LinkedIn\") ~> VendorLinkedInType\nCDSVendor filter(!isNull(msdyn_primaryfaxnumber) || msdyn_primaryfaxnumber==\"\") ~> RemoveBlankVendorFax\nRemoveBlankVendorFax select(mapColumn(\n\t\tPartyNumber,\n\t\tLocator = msdyn_primaryfaxnumber,\n\t\tDescription = msdyn_primaryfaxnumberdescription,\n\t\tLocatorExtension = msdyn_primaryfaxnumberextension\n\t),\n\tskipDuplicateMapInputs: true,\n\tskipDuplicateMapOutputs: true) ~> VendorFax\nVendorFax derive(Type = \"Fax\") ~> VendorFaxType\nCDSVendor filter(!isNull(msdyn_primarytelex) || msdyn_primarytelex==\"\") ~> RemoveBlankTelex\nRemoveBlankTelex select(mapColumn(\n\t\tLocator = msdyn_primarytelex,\n\t\tDescription = msdyn_primarytelexdescription,\n\t\tPartyNumber\n\t),\n\tskipDuplicateMapInputs: true,\n\tskipDuplicateMapOutputs: true) ~> VendorTelex\nVendorTelex derive(Type = \"Telex\") ~> VendorTelexType\nContactLinkedInUnion, VendorEmailType union(byName: true)~> VendorEmailUnion\nVendorEmailUnion, VendorPhoneType union(byName: true)~> VendorPhoneUnion\nVendorPhoneUnion, VendorFaxType union(byName: true)~> VendorFaxUnion\nVendorFaxUnion, VendorFacebookType union(byName: true)~> VendorFacebookUnion\nVendorFacebookUnion, VendorTwitterType union(byName: true)~> VendorTwitterUnion\nVendorTwitterUnion, VendorLinkedInType union(byName: true)~> VendorLinkedInUnion\nVendorLinkedInUnion, VendorTelexType union(byName: true)~> VendorTelexUnion\nVendorTelexUnion aggregate(groupBy(PartyNumber,\n\t\tLocator,\n\t\tType,\n\t\tDescription,\n\t\tLocatorExtension),\n\tfirst = first(PartyNumber)) ~> RemoveDuplicate\nCDSContact filter(!isNull(emailaddress2)||emailaddress2==\"\") ~> RemoveBlankContactEmail2\nRemoveBlankContactEmail2 select(mapColumn(\n\t\tPartyNumber,\n\t\tLocator = emailaddress2\n\t),\n\tskipDuplicateMapInputs: true,\n\tskipDuplicateMapOutputs: true) ~> ContactEmail2\nContactEmail2 derive(Type = \"Email\") ~> ContactEmail2Type\nCDSContact filter(!isNull(emailaddress3)|| emailaddress3==\"\") ~> RemoveBlankContactEmail3\nRemoveBlankContactEmail3 select(mapColumn(\n\t\tPartyNumber,\n\t\tLocator = emailaddress3\n\t),\n\tskipDuplicateMapInputs: true,\n\tskipDuplicateMapOutputs: true) ~> ContactEmail3\nContactEmail3 derive(Type = \"Email\") ~> ContactEmail3Tyoe\nCDSContact filter(!isNull(telephone2)||telephone2==\"\") ~> RemoveBlankContactTelephone2\nRemoveBlankContactTelephone2 select(mapColumn(\n\t\tPartyNumber,\n\t\tLocator = telephone2\n\t),\n\tskipDuplicateMapInputs: true,\n\tskipDuplicateMapOutputs: true) ~> ContactTelephone2\nContactTelephone2 derive(Type = \"Phone\") ~> ContactTelephone2Type\nCDSContact filter(!isNull(telephone3) || telephone3==\"\") ~> RemoveBlankContactTelephone3\nRemoveBlankContactTelephone3 select(mapColumn(\n\t\tPartyNumber,\n\t\tLocator = telephone3\n\t),\n\tskipDuplicateMapInputs: true,\n\tskipDuplicateMapOutputs: true) ~> ContactTelephone3\nContactTelephone3 derive(Type = \"Phone\") ~> ContactTelephone3Type\nCDSAccount filter(!isNull(emailaddress2) || emailaddress2==\"\") ~> RemoveBlankAccountEmail2\nRemoveBlankAccountEmail2 select(mapColumn(\n\t\tPartyNumber,\n\t\tLocator = emailaddress2\n\t),\n\tskipDuplicateMapInputs: true,\n\tskipDuplicateMapOutputs: true) ~> AccountEmail2\nAccountEmail2 derive(Type = \"Email\") ~> AccountEmail2Type\nCDSAccount filter(!isNull(emailaddress3) || emailaddress3==\"\") ~> RemoveBlankAccountEmail3\nRemoveBlankAccountEmail3 select(mapColumn(\n\t\tPartyNumber,\n\t\tLocator = emailaddress3\n\t),\n\tskipDuplicateMapInputs: true,\n\tskipDuplicateMapOutputs: true) ~> AccountEmail3\nAccountEmail3 derive(Type = \"Email\") ~> AccountEmail3Type\nCDSAccount filter(!isNull(telephone3) || telephone3==\"\") ~> RemoveBlankAccountPhone3\nRemoveBlankAccountPhone3 select(mapColumn(\n\t\tPartyNumber,\n\t\tLocator = telephone3\n\t),\n\tskipDuplicateMapInputs: true,\n\tskipDuplicateMapOutputs: true) ~> AccountPhone3\nAccountPhone3 derive(Type = \"Phone\") ~> AccountPhone3Type\nCDSAccount filter(!isNull(telephone2) || telephone2==\"\") ~> RemoveBlankAccountPhone2\nRemoveBlankAccountPhone2 select(mapColumn(\n\t\tPartyNumber,\n\t\tLocator = telephone2\n\t),\n\tskipDuplicateMapInputs: true,\n\tskipDuplicateMapOutputs: true) ~> AccountPhone2\nAccountPhone2 derive(Type = \"Phone\") ~> AccountPhone2Type\nAccountPhone2Type, AccountPhone3Type union(byName: true)~> AccountPhonn3TypeUnion\nAccountPhonn3TypeUnion, AccountEmail2Type union(byName: true)~> AccountEmail2Union\nAccountEmail2Union, AccountEmail3Type union(byName: true)~> AccountEmail3Union\nAccountEmail3Union, ContactTelephone2Type union(byName: true)~> ContactPhone2Union\nContactPhone2Union, ContactTelephone3Type union(byName: true)~> ContactPhone3Union\nContactPhone3Union, ContactEmail2Type union(byName: true)~> ContactEmail2Union\nContactEmail2Union, ContactEmail3Tyoe union(byName: true)~> ContactEmail3Union\nCDSContact filter(!isNull(mobilephone) || mobilephone==\"\") ~> RemoveBlankMobilePhone\nRemoveBlankMobilePhone select(mapColumn(\n\t\tLocator = mobilephone,\n\t\tPartyNumber\n\t),\n\tskipDuplicateMapInputs: true,\n\tskipDuplicateMapOutputs: true) ~> ContactMobilePhone\nContactMobilePhone derive(Type = \"Phone\",\n\t\tIsMobile = true()) ~> ContactMobilePhoneType\nContactEmail3Union, ContactMobilePhoneType union(byName: true)~> ContactMobilePhoneUnion\nRemoveDuplicate sink(allowSchemaDrift: true,\n\tvalidateSchema: false,\n\tinput(\n\t\taccountid as string,\n\t\tCompanyCode as string,\n\t\taccountnumber as string,\n\t\tname as string,\n\t\tmsdyn_partyid as string,\n\t\tmsdyn_partynumber as string,\n\t\tPartyNumber as string,\n\t\ttelephone1 as string,\n\t\twebsiteurl as string,\n\t\tmsdyn_websiteurldescription as string,\n\t\tmsdyn_primaryfacebookdescription as string,\n\t\tmsdyn_telephone1description as string,\n\t\tmsdyn_primarylinkedindescrption as string,\n\t\tmsdyn_primarylinkedinid as string,\n\t\tprimarytwitterid as string,\n\t\tmsdyn_primarytwitteriddescription as string,\n\t\tmsdyn_emailaddress1description as string,\n\t\tmsdyn_primaryfacebookid as string,\n\t\tmsdyn_telephone1extension as string,\n\t\temailaddress2 as string,\n\t\temailaddress3 as string,\n\t\temailaddress1 as string,\n\t\ttelephone3 as string,\n\t\tmsdyn_mappedvendoraccount as string\n\t),\n\tpartitionFileNames:['CEPrimaryElectronicAddress.csv'],\n\tskipDuplicateMapInputs: true,\n\tskipDuplicateMapOutputs: true,\n\tpartitionBy('hash', 1)) ~> CEElectronicAddress\nContactMobilePhoneUnion sink(allowSchemaDrift: true,\n\tvalidateSchema: false,\n\tinput(\n\t\taccountid as string,\n\t\tCompanyCode as string,\n\t\taccountnumber as string,\n\t\tname as string,\n\t\tmsdyn_partyid as string,\n\t\tmsdyn_partynumber as string,\n\t\tPartyNumber as string,\n\t\ttelephone1 as string,\n\t\twebsiteurl as string,\n\t\tmsdyn_websiteurldescription as string,\n\t\tmsdyn_primaryfacebookdescription as string,\n\t\tmsdyn_telephone1description as string,\n\t\tmsdyn_primarylinkedindescrption as string,\n\t\tmsdyn_primarylinkedinid as string,\n\t\tprimarytwitterid as string,\n\t\tmsdyn_primarytwitteriddescription as string,\n\t\tmsdyn_emailaddress1description as string,\n\t\tmsdyn_primaryfacebookid as string,\n\t\tmsdyn_telephone1extension as string,\n\t\temailaddress2 as string,\n\t\temailaddress3 as string,\n\t\temailaddress1 as string,\n\t\ttelephone3 as string,\n\t\tmsdyn_mappedvendoraccount as string\n\t),\n\tpartitionFileNames:['CENonPrimaryAddress.csv'],\n\tskipDuplicateMapInputs: true,\n\tskipDuplicateMapOutputs: true,\n\tpartitionBy('hash', 1)) ~> CENonPrimaryAddress"
                }
            },
            "dependsOn": [
                "[concat(variables('factoryId'), '/datasets/AzureStorageConnection')]",
                "[concat(variables('factoryId'), '/datasets/DelimitedTextOutput')]"
            ]
        }
    ]
}